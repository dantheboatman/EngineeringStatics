{"version":3,"file":"131.ee437eeefadd750d.js","mappings":"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zD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,WAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY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","sources":["webpack://WebComponents/./node_modules/jsuites/dist/jsuites.js","webpack://WebComponents/./node_modules/jexcel/dist/jexcel.js"],"sourcesContent":["\r\n/**\r\n * (c) jSuites Javascript Web Components (v2.8)\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jsuites/\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\n    var obj = {}\n\n    obj.init = function() {\n        // Find root element\n        var app = document.querySelector('.japp');\n\n        // Root element\n        if (app) {\n            obj.el = app;\n        } else {\n            obj.el = document.body;\n        }\n\n        // Loading modules\n        var modules = document.querySelectorAll('[data-autoload]');\n        for (var i = 0; i < modules.length; i++) {\n            var m = modules[i].getAttribute('data-autoload');\n            if (typeof(window[m]) == 'function') {\n                window[m](modules[i]);\n            }\n        }\n    }\n\n    obj.guid = function() {\n        var guid = '';\n        for (var i = 0; i < 32; i++) {\n            guid += Math.floor(Math.random()*0xF).toString(0xF);\n        }\n        return guid;\n    }\n\n    obj.getWindowWidth = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        x = w.innerWidth || e.clientWidth || g.clientWidth;\n        return x;\n    }\n\n    obj.getWindowHeight = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        y = w.innerHeight|| e.clientHeight|| g.clientHeight;\n        return  y;\n    }\n\n    obj.getPosition = function(e) {\n        if (e.changedTouches && e.changedTouches[0]) {\n            var x = e.changedTouches[0].pageX;\n            var y = e.changedTouches[0].pageY;\n        } else {\n            var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\n            var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\n        }\n\n        return [ x, y ];\n    }\n\n    obj.click = function(el) {\n        if (el.click) {\n            el.click();\n        } else {\n            var evt = new MouseEvent('click', {\n                bubbles: true,\n                cancelable: true,\n                view: window\n            });\n            el.dispatchEvent(evt);\n        }\n    }\n\n    obj.getElement = function(element, className) {\n        var foundElement = false;\n\n        function path (element) {\n            if (element.className) {\n                if (element.classList.contains(className)) {\n                    foundElement = element;\n                }\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return foundElement;\n    }\n\n    obj.getLinkElement = function(element) {\n        var targetElement = false;\n\n        function path (element) {\n            if ((element.tagName == 'A' || element.tagName == 'DIV') && element.getAttribute('data-href')) {\n                targetElement = element;\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return targetElement;\n    }\n\n    obj.getFormElements = function(formObject) {\n        var ret = {};\n\n        if (formObject) {\n            var elements = formObject.querySelectorAll(\"input, select, textarea\");\n        } else {\n            var elements = document.querySelectorAll(\"input, select, textarea\");\n        }\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var name = element.name;\n            var value = element.value;\n\n            if (name) {\n                ret[name] = value;\n            }\n        }\n\n        return ret;\n    }\n\n    obj.exists = function(url, __callback) {\n        var http = new XMLHttpRequest();\n        http.open('HEAD', url, false);\n        http.send();\n        if (http.status) {\n            __callback(http.status);\n        }\n    }\n\n    obj.getFiles = function(element) {\n        if (! element) {\n            console.error('No element defined in the arguments of your method');\n        }\n\n        // Get attachments\n        var files = element.querySelectorAll('.jfile');\n\n        if (files.length > 0) {\n            var data = [];\n            for (var i = 0; i < files.length; i++) {\n                var file = {};\n\n                var src = files[i].getAttribute('src');\n\n                if (files[i].classList.contains('jremove')) {\n                    file.remove = 1;\n                } else {\n                    if (src.substr(0,4) == 'data') {\n                        file.content = src.substr(src.indexOf(',') + 1);\n                        file.extension = files[i].getAttribute('data-extension');\n                    } else {\n                        file.file = src;\n                        file.extension = files[i].getAttribute('data-extension');\n                        if (! file.extension) {\n                            file.extension =  src.substr(src.lastIndexOf('.') + 1);\n                        }\n                        if (jSuites.files[file.file]) {\n                            file.content = jSuites.files[file.file];\n                        }\n                    }\n\n                    // Optional file information\n                    if (files[i].getAttribute('data-name')) {\n                        file.name = files[i].getAttribute('data-name');\n                    }\n\n                    if (files[i].getAttribute('data-file')) {\n                        file.file = files[i].getAttribute('data-file');\n                    }\n\n                    if (files[i].getAttribute('data-size')) {\n                        file.size = files[i].getAttribute('data-size');\n                    }\n\n                    if (files[i].getAttribute('data-date')) {\n                        file.date = files[i].getAttribute('data-date');\n                    }\n\n                    if (files[i].getAttribute('data-cover')) {\n                        file.cover = files[i].getAttribute('data-cover');\n                    }\n                }\n\n                // TODO SMALL thumbs?\n\n                data[i] = file;\n            }\n\n            return data;\n        }\n    }\n\n    obj.ajax = function(options) {\n        if (! options.data) {\n            options.data = {};\n        }\n\n        if (options.type) {\n            options.method = options.type;\n        }\n\n        if (options.data) {\n            var data = [];\n            var keys = Object.keys(options.data);\n\n            if (keys.length) {\n                for (var i = 0; i < keys.length; i++) {\n                    if (typeof(options.data[keys[i]]) == 'object') {\n                        var o = options.data[keys[i]];\n                        for (var j = 0; j < o.length; j++) {\n                            if (typeof(o[j]) == 'string') {\n                                data.push(keys[i] + '[' + j + ']=' + encodeURIComponent(o[j]));\n                            } else {\n                                var prop = Object.keys(o[j]);\n                                for (var z = 0; z < prop.length; z++) {\n                                    data.push(keys[i] + '[' + j + '][' + prop[z] + ']=' + encodeURIComponent(o[j][prop[z]]));\n                                }\n                            }\n                        }\n                    } else {\n                        data.push(keys[i] + '=' + encodeURIComponent(options.data[keys[i]]));\n                    }\n                }\n            }\n\n            if (options.method == 'GET' && data.length > 0) {\n                if (options.url.indexOf('?') < 0) {\n                    options.url += '?';\n                }\n                options.url += data.join('&');\n            }\n        }\n\n        var httpRequest = new XMLHttpRequest();\n        httpRequest.open(options.method, options.url, true);\n        httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n        if (options.method == 'POST') {\n            httpRequest.setRequestHeader('Accept', 'application/json');\n            httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n        } else {\n            if (options.dataType == 'json') {\n                httpRequest.setRequestHeader('Content-Type', 'text/json');\n            }\n        }\n\n        // No cache\n        if (options.cache != true) {\n            httpRequest.setRequestHeader('pragma', 'no-cache');\n            httpRequest.setRequestHeader('cache-control', 'no-cache');\n        }\n\n        // Authentication\n        if (options.withCredentials == true) {\n            httpRequest.withCredentials = true\n        }\n\n        // Before send\n        if (typeof(options.beforeSend) == 'function') {\n            options.beforeSend(httpRequest);\n        }\n\n        httpRequest.onload = function() {\n            if (httpRequest.status === 200) {\n                if (options.dataType == 'json') {\n                    try {\n                        var result = JSON.parse(httpRequest.responseText);\n\n                        if (options.success && typeof(options.success) == 'function') {\n                            options.success(result);\n                        }\n                    } catch(err) {\n                        if (options.error && typeof(options.error) == 'function') {\n                            options.error(result);\n                        }\n                    }\n                } else {\n                    var result = httpRequest.responseText;\n\n                    if (options.success && typeof(options.success) == 'function') {\n                        options.success(result);\n                    }\n                }\n            } else {\n                if (options.error && typeof(options.error) == 'function') {\n                    options.error(httpRequest.responseText);\n                }\n            }\n\n            // Global complete method\n            if (obj.ajax.requests && obj.ajax.requests.length) {\n                // Get index of this request in the container\n                var index = obj.ajax.requests.indexOf(httpRequest)\n                // Remove from the ajax requests container\n                obj.ajax.requests.splice(index, 1);\n                // Last one?\n                if (! obj.ajax.requests.length) {\n                    if (options.complete && typeof(options.complete) == 'function') {\n                        options.complete(result);\n                    }\n                }\n            }\n        }\n\n        if (data) {\n            httpRequest.send(data.join('&'));\n        } else {\n            httpRequest.send();\n        }\n\n        obj.ajax.requests.push(httpRequest);\n\n        return httpRequest;\n    }\n\n    obj.ajax.requests = [];\n\n    obj.slideLeft = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-left-in');\n            setTimeout(function() {\n                element.classList.remove('slide-left-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-left-out');\n            setTimeout(function() {\n                element.classList.remove('slide-left-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideRight = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-right-in');\n            setTimeout(function() {\n                element.classList.remove('slide-right-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-right-out');\n            setTimeout(function() {\n                element.classList.remove('slide-right-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideTop = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-top-in');\n            setTimeout(function() {\n                element.classList.remove('slide-top-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-top-out');\n            setTimeout(function() {\n                element.classList.remove('slide-top-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideBottom = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-bottom-in');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-bottom-out');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 100);\n        }\n    }\n\n    obj.fadeIn = function(element, done) {\n        element.classList.add('fade-in');\n        setTimeout(function() {\n            element.classList.remove('fade-in');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 2000);\n    }\n\n    obj.fadeOut = function(element, done) {\n        element.classList.add('fade-out');\n        setTimeout(function() {\n            element.classList.remove('fade-out');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 1000);\n    }\n\n    obj.keyDownControls = function(e) {\n        if (e.which == 27) {\n            var nodes = document.querySelectorAll('.jslider');\n            if (nodes.length > 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                    nodes[i].slider.close();\n                }\n            }\n\n            if (document.querySelector('.jdialog')) {\n                jSuites.dialog.close();\n            }\n        } else if (e.which == 13) {\n            if (document.querySelector('.jdialog')) {\n                if (typeof(jSuites.dialog.options.onconfirm) == 'function') {\n                    jSuites.dialog.options.onconfirm();\n                }\n                jSuites.dialog.close();\n            }\n        }\n\n        // Verify mask\n        if (jSuites.mask) {\n            jSuites.mask.apply(e);\n        }\n    }\n\n    var actionUpControl = function(e) {\n        var element = null;\n        if (element = jSuites.getLinkElement(e.target)) {\n            var link = element.getAttribute('data-href');\n            if (link == '#back') {\n                window.history.back();\n            } else if (link == '#panel') {\n                jSuites.panel();\n            } else {\n                jSuites.pages(link);\n            }\n        }\n    }\n\n    var controlSwipeLeft = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 100,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.prev();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display != 'none') {\n                            jSuites.panel.close();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var controlSwipeRight = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 0,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.next();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display == 'none') {\n                            jSuites.panel();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var actionOverControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip(e);\n        }\n    }\n\n    var actionOutControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip.hide();\n        }\n    }\n\n    // Create page container\n    document.addEventListener('swipeleft', controlSwipeLeft);\n    document.addEventListener('swiperight', controlSwipeRight);\n    document.addEventListener('keydown', obj.keyDownControls);\n\n    if ('ontouchend' in document.documentElement === true) {\n        document.addEventListener('touchend', actionUpControl);\n    } else {\n        document.addEventListener('mouseup', actionUpControl);\n    }\n\n    // Onmouseover\n    document.addEventListener('mouseover', actionOverControl);\n    document.addEventListener('mouseout', actionOutControl);\n    document.addEventListener('DOMContentLoaded', function() {\n        obj.init();\n    });\n\n    // Pop state control\n    window.onpopstate = function(e) {\n        if (e.state && e.state.route) {\n            if (jSuites.pages.get(e.state.route)) {\n                jSuites.pages(e.state.route, { ignoreHistory:true });\n            }\n        }\n    }\n\n    return obj;\n}();\n\njSuites.files = [];\r\n\r\njSuites.calendar = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Global container\n    if (! jSuites.calendar.current) {\n        jSuites.calendar.current = null;\n    }\n\n    // Default configuration\n    var defaults = {\n        // Data\n        data: null,\n        // Inline or not\n        type: null,\n        // Restrictions\n        validRange: null,\n        // Starting weekday - 0 for sunday, 6 for saturday\n        startingDay: null, \n        // Date format\n        format: 'DD/MM/YYYY',\n        // Allow keyboard date entry\n        readonly: true,\n        // Today is default\n        today: false,\n        // Show timepicker\n        time: false,\n        // Show the reset button\n        resetButton: true,\n        // Placeholder\n        placeholder: '',\n        // Translations can be done here\n        months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n        weekdays: ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\n        weekdays_short: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n        // Value\n        value: null,\n        // Events\n        onclose: null,\n        onchange: null,\n        // Fullscreen (this is automatic set for screensize < 800)\n        fullscreen: false,\n        // Internal mode controller\n        mode: null,\n        position: null,\n        // Create the calendar closed as default\n        opened: false,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Value\n    if (! obj.options.value) {\n        if (el.tagName == 'INPUT' && el.value) {\n            obj.options.value = el.value;\n        }\n    }\n\n    // Make sure use upper case in the format\n    obj.options.format = obj.options.format.toUpperCase();\n\n    if (obj.options.value) {\n        var date = obj.options.value.split(' ');\n        var time = date[1];\n        var date = date[0].split('-');\n        var y = parseInt(date[0]);\n        var m = parseInt(date[1]);\n        var d = parseInt(date[2]);\n\n        if (time) {\n            var time = time.split(':');\n            var h = parseInt(time[0]);\n            var i = parseInt(time[1]);\n        } else {\n            var h = 0;\n            var i = 0;\n        }\n    } else {\n        var date = new Date();\n        var y = date.getFullYear();\n        var m = date.getMonth() + 1;\n        var d = date.getDate();\n        var h = date.getHours();\n        var i = date.getMinutes();\n    }\n\n    // Current value\n    obj.date = [ y, m, d, h, i, 0 ];\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    // Calendar elements\n    var calendarReset = document.createElement('div');\n    calendarReset.className = 'jcalendar-reset';\n    calendarReset.innerHTML = 'Reset';\n\n    var calendarConfirm = document.createElement('div');\n    calendarConfirm.className = 'jcalendar-confirm';\n    calendarConfirm.innerHTML = 'Done';\n\n    var calendarControls = document.createElement('div');\n    calendarControls.className = 'jcalendar-controls'\n    if (obj.options.resetButton) {\n        calendarControls.appendChild(calendarReset);\n    }\n    calendarControls.appendChild(calendarConfirm);\n\n    var calendarContainer = document.createElement('div');\n    calendarContainer.className = 'jcalendar-container';\n\n    var calendarContent = document.createElement('div');\n    calendarContent.className = 'jcalendar-content';\n    calendarContent.appendChild(calendarControls);\n    calendarContainer.appendChild(calendarContent);\n\n    // Table container\n    var calendarTableContainer = document.createElement('div');\n    calendarTableContainer.className = 'jcalendar-table';\n    calendarContent.appendChild(calendarTableContainer);\n\n    // Main element\n    if (el.tagName == 'INPUT') {\n        var calendar = document.createElement('div');\n    } else {\n        var calendar = el;\n    }\n    calendar.className = 'jcalendar';\n    calendar.appendChild(calendarContainer);\n\n    // Previous button\n    var calendarHeaderPrev = document.createElement('td');\n    calendarHeaderPrev.setAttribute('colspan', '2');\n    calendarHeaderPrev.className = 'jcalendar-prev';\n\n    // Header with year and month\n    var calendarLabelYear = document.createElement('span');\n    calendarLabelYear.className = 'jcalendar-year';\n\n    var calendarLabelMonth = document.createElement('span');\n    calendarLabelMonth.className = 'jcalendar-month';\n\n    var calendarHeaderTitle = document.createElement('td');\n    calendarHeaderTitle.className = 'jcalendar-header';\n    calendarHeaderTitle.setAttribute('colspan', '3');\n    calendarHeaderTitle.appendChild(calendarLabelMonth);\n    calendarHeaderTitle.appendChild(calendarLabelYear);\n\n    var calendarHeaderNext = document.createElement('td');\n    calendarHeaderNext.setAttribute('colspan', '2');\n    calendarHeaderNext.className = 'jcalendar-next';\n\n    var calendarHeaderRow = document.createElement('tr');\n    calendarHeaderRow.appendChild(calendarHeaderPrev);\n    calendarHeaderRow.appendChild(calendarHeaderTitle);\n    calendarHeaderRow.appendChild(calendarHeaderNext);\n\n    var calendarHeader = document.createElement('thead');\n    calendarHeader.appendChild(calendarHeaderRow);\n\n    var calendarBody = document.createElement('tbody');\n    var calendarFooter = document.createElement('tfoot');\n\n    // Calendar table\n    var calendarTable = document.createElement('table');\n    calendarTable.setAttribute('cellpadding', '0');\n    calendarTable.setAttribute('cellspacing', '0');\n    calendarTable.appendChild(calendarHeader);\n    calendarTable.appendChild(calendarBody);\n    calendarTable.appendChild(calendarFooter);\n    calendarTableContainer.appendChild(calendarTable);\n\n    var calendarSelectHour = document.createElement('select');\n    calendarSelectHour.className = 'jcalendar-select';\n    calendarSelectHour.onchange = function() {\n        obj.date[3] = this.value; \n    }\n\n    for (var i = 0; i < 24; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectHour.appendChild(element);\n    }\n\n    var calendarSelectMin = document.createElement('select');\n    calendarSelectMin.className = 'jcalendar-select';\n    calendarSelectMin.onchange = function() {\n        obj.date[4] = this.value; \n    }\n\n    for (var i = 0; i < 60; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectMin.appendChild(element);\n    }\n\n    // Footer controls\n    var calendarControlsFooter = document.createElement('div');\n    calendarControlsFooter.className = 'jcalendar-controls';\n\n    var calendarControlsTime = document.createElement('div');\n    calendarControlsTime.className = 'jcalendar-time';\n    calendarControlsTime.style.maxWidth = '140px';\n    calendarControlsTime.appendChild(calendarSelectHour);\n    calendarControlsTime.appendChild(calendarSelectMin);\n\n    var calendarControlsUpdateButton = document.createElement('input');\n    calendarControlsUpdateButton.setAttribute('type', 'button');\n    calendarControlsUpdateButton.className = 'jcalendar-update';\n    calendarControlsUpdateButton.value = 'Update';\n\n    var calendarControlsUpdate = document.createElement('div');\n    calendarControlsUpdate.style.flexGrow = '10';\n    calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\n    calendarControlsFooter.appendChild(calendarControlsTime);\n    calendarControlsFooter.appendChild(calendarControlsUpdate);\n    calendarContent.appendChild(calendarControlsFooter);\n\n    var calendarBackdrop = document.createElement('div');\n    calendarBackdrop.className = 'jcalendar-backdrop';\n    calendar.appendChild(calendarBackdrop);\n\n    // Update actions button\n    var updateActions = function() {\n        var currentDay = calendar.querySelector('.jcalendar-selected');\n\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\n            calendarSelectHour.setAttribute('disabled', 'disabled');\n            calendarSelectMin.setAttribute('disabled', 'disabled');\n        } else {\n            calendarControlsUpdateButton.removeAttribute('disabled');\n            calendarSelectHour.removeAttribute('disabled');\n            calendarSelectMin.removeAttribute('disabled');\n        }\n    }\n\n    // Methods\n    obj.open = function (value) {\n        if (! calendar.classList.contains('jcalendar-focus')) {\n            if (jSuites.calendar.current) {\n                jSuites.calendar.current.close();\n            }\n            // Current\n            jSuites.calendar.current = obj;\n            // Show calendar\n            calendar.classList.add('jcalendar-focus');\n            // Get days\n            obj.getDays();\n            // Hour\n            if (obj.options.time) {\n                calendarSelectHour.value = obj.date[3];\n                calendarSelectMin.value = obj.date[4];\n            }\n\n            // Get the position of the corner helper\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\n                // Full\n                calendar.classList.add('jcalendar-fullsize');\n                // Animation\n                jSuites.slideBottom(calendarContent, 1);\n            } else {\n                const rect = el.getBoundingClientRect();\n                const rectContent = calendarContent.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    calendarContainer.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\n                    }\n                    calendarContainer.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.bottom = (1 * rect.height + rectContent.height + 2) + 'px';\n                    } else {\n                        calendarContainer.style.top = 2 + 'px'; \n                    }\n                }\n            }\n        }\n    }\n\n    obj.close = function (ignoreEvents, update) {\n        if (jSuites.calendar.current) {\n            // Current\n            jSuites.calendar.current = null;\n\n            if (update !== false) {\n                var element = calendar.querySelector('.jcalendar-selected');\n\n                if (typeof(update) == 'string') {\n                    var value = update;\n                } else if (element && element.classList.contains('jcalendar-disabled')) {\n                    var value = obj.options.value\n                } else {\n                    var value = obj.getValue();\n                }\n\n                obj.setValue(value);\n            }\n\n            // Events\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n\n            // Hide\n            calendar.classList.remove('jcalendar-focus');\n        }\n\n        return obj.options.value;\n    }\n\n    obj.prev = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = obj.date[0] - 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] < 2) {\n                obj.date[0] = obj.date[0] - 1;\n                obj.date[1] = 12;\n            } else {\n                obj.date[1] = obj.date[1] - 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.next = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = parseInt(obj.date[0]) + 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] > 11) {\n                obj.date[0] = parseInt(obj.date[0]) + 1;\n                obj.date[1] = 1;\n            } else {\n                obj.date[1] = parseInt(obj.date[1]) + 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.setValue = function(val) {\n        if (! val) {\n            val = '' + val;\n        }\n        // Values\n        var newValue = val;\n        var oldValue = obj.options.value;\n        // Set label\n        var value = obj.setLabel(newValue, obj.options.format);\n        var date = newValue.split(' ');\n        if (! date[1]) {\n            date[1] = '00:00:00';\n        }\n        var time = date[1].split(':')\n        var date = date[0].split('-');\n        var y = parseInt(date[0]);\n        var m = parseInt(date[1]);\n        var d = parseInt(date[2]);\n        var h = parseInt(time[0]);\n        var i = parseInt(time[1]);\n        obj.date = [ y, m, d, h, i, 0 ];\n        var val = obj.setLabel(newValue, obj.options.format);\n\n        if (oldValue != newValue) {\n            // Input value\n            if (el.tagName == 'INPUT') {\n                el.value = val;\n            }\n            // New value\n            obj.options.value = newValue;\n            // On change\n            if (typeof(obj.options.onchange) ==  'function') {\n                obj.options.onchange(el, newValue, oldValue);\n            }\n        }\n\n        obj.getDays();\n    }\n\n    obj.getValue = function() {\n        if (obj.date) {\n            if (obj.options.time) {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(obj.date[3]) + ':' + two(obj.date[4]) + ':' + two(0);\n            } else {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(0) + ':' + two(0) + ':' + two(0);\n            }\n        } else {\n            return \"\";\n        }\n    }\n\n    /**\n     *  Calendar\n     */\n    obj.update = function(element) {\n        if (element.classList.contains('jcalendar-disabled')) {\n            // Do nothing\n        } else {\n            obj.date[2] = element.innerText;\n\n            if (! obj.options.time) {\n                obj.close();\n            } else {\n                obj.date[3] = calendarSelectHour.value;\n                obj.date[4] = calendarSelectMin.value;\n            }\n\n            var elements = calendar.querySelector('.jcalendar-selected');\n            if (elements) {\n                elements.classList.remove('jcalendar-selected');\n            }\n            element.classList.add('jcalendar-selected');\n        }\n\n        // Update\n        updateActions();\n    }\n\n    /**\n     * Set to blank\n     */\n    obj.reset = function() {\n        // Close calendar\n        obj.close(false, '');\n    }\n\n    /**\n     * Get calendar days\n     */\n    obj.getDays = function() {\n        // Mode\n        obj.options.mode = 'days';\n\n        // Setting current values in case of NULLs\n        var date = new Date();\n\n        // Current selection\n        var year = obj.date && obj.date[0] ? obj.date[0] : parseInt(date.getFullYear());\n        var month = obj.date && obj.date[1] ? obj.date[1] : parseInt(date.getMonth()) + 1;\n        var day = obj.date && obj.date[2] ? obj.date[2] : parseInt(date.getDay());\n        var hour = obj.date && obj.date[3] ? obj.date[3] : parseInt(date.getHours());\n        var min = obj.date && obj.date[4] ? obj.date[4] : parseInt(date.getMinutes());\n\n        // Selection container\n        obj.date = [year, month, day, hour, min, 0 ];\n\n        // Update title\n        calendarLabelYear.innerHTML = year;\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\n\n        // Current month and Year\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\n        var currentDay = date.getDate();\n\n        // Number of days in the month\n        var date = new Date(year, month, 0, 0, 0);\n        var numberOfDays = date.getDate();\n\n        // First day\n        var date = new Date(year, month-1, 0, 0, 0);\n        var firstDay = date.getDay() + 1;\n\n        // Index value\n        var index = obj.options.startingDay || 0;\n\n        // First of day relative to the starting calendar weekday\n        firstDay = firstDay - index;\n\n        // Reset table\n        calendarBody.innerHTML = '';\n\n        // Weekdays Row\n        var row = document.createElement('tr');\n        row.setAttribute('align', 'center');\n        calendarBody.appendChild(row);\n\n        // Create weekdays row\n        for (var i = 0; i < 7; i++) {\n            var cell = document.createElement('td');\n            cell.classList.add('jcalendar-weekday')\n            cell.innerHTML = obj.options.weekdays_short[index];\n            row.appendChild(cell);\n            // Next week day\n            index++;\n            // Restart index\n            if (index > 6) {\n                index = 0;\n            }\n        }\n\n        // Index of days\n        var index = 0;\n        var d = 0;\n \n        // Calendar table\n        for (var j = 0; j < 5; j++) {\n            // Reset cells container\n            var row = document.createElement('tr');\n            row.setAttribute('align', 'center');\n            // Data control\n            var emptyRow = true;\n            // Create cells\n            for (var i = 0; i < 7; i++) {\n                // Create cell\n                var cell = document.createElement('td');\n                cell.classList.add('jcalendar-set-day');\n\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\n                    // Day cell\n                    d++;\n                    cell.innerHTML = d;\n\n                    // Selected\n                    if (d == day) {\n                        cell.classList.add('jcalendar-selected');\n                    }\n\n                    // Current selection day is today\n                    if (isCurrentMonthAndYear && currentDay == d) {\n                        cell.style.fontWeight = 'bold';\n                    }\n\n                    // Current selection day\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\n\n                    // Available ranges\n                    if (obj.options.validRange) {\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\n                            var test1 = true;\n                        } else {\n                            var test1 = false;\n                        }\n\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\n                            var test2 = true;\n                        } else {\n                            var test2 = false;\n                        }\n\n                        if (! (test1 && test2)) {\n                            cell.classList.add('jcalendar-disabled');\n                        }\n                    }\n\n                    // Control\n                    emptyRow = false;\n                }\n                // Day cell\n                row.appendChild(cell);\n                // Index\n                index++;\n            }\n\n            // Add cell to the calendar body\n            if (emptyRow == false) {\n                calendarBody.appendChild(row);\n            }\n        }\n\n        // Show time controls\n        if (obj.options.time) {\n            calendarControlsTime.style.display = '';\n        } else {\n            calendarControlsTime.style.display = 'none';\n        }\n\n        // Update\n        updateActions();\n    }\n\n    obj.getMonths = function() {\n        // Mode\n        obj.options.mode = 'months';\n\n        // Loading month labels\n        var months = obj.options.months;\n\n        // Update title\n        calendarLabelYear.innerHTML = obj.date[0];\n        calendarLabelMonth.innerHTML = '';\n\n        // Create months table\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 12; i++) {\n            if ((i > 0) && (!(i % 4))) {\n                html += '</tr><tr align=\"center\">';\n            }\n\n            var month = parseInt(i) + 1;\n            html += '<td class=\"jcalendar-set-month\" data-value=\"' + month + '\">' + months[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.getYears = function() { \n        // Mode\n        obj.options.mode = 'years';\n\n        // Array of years\n        var y = [];\n        for (i = 0; i < 25; i++) {\n            y[i] = parseInt(obj.date[0]) + (i - 12);\n        }\n\n        // Assembling the year tables\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 25; i++) {\n            if ((i > 0) && (!(i % 5))) {\n                html += '</tr><tr align=\"center\">';\n            }\n            html += '<td class=\"jcalendar-set-year\">'+ y[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.setLabel = function(value, format) {\n        return jSuites.calendar.getDateString(value, format);\n    }\n\n    obj.fromFormatted = function (value, format) {\n        return jSuites.calendar.extractDateFromString(value, format);\n    }\n\n    var mouseUpControls = function(e) {\n        var action = e.target.className;\n\n        // Object id\n        if (action == 'jcalendar-prev') {\n            obj.prev();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-next') {\n            obj.next();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-month') {\n            obj.getMonths();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-year') {\n            obj.getYears();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-year') {\n            obj.date[0] = e.target.innerText;\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-month') {\n            obj.date[1] = parseInt(e.target.getAttribute('data-value'));\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-close') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-backdrop') {\n            obj.close(false, false);\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-reset') {\n            obj.reset();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (e.target.classList.contains('jcalendar-set-day')) {\n            if (e.target.innerText) {\n                obj.update(e.target);\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n\n    var keyUpControls = function(e) {\n        if (e.target.value && e.target.value.length > 3) {\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\n            if (test) {\n                if (e.target.getAttribute('data-completed') == 'true') {\n                    obj.setValue(test);\n                }\n            }\n        }\n    }\n\n    // Handle events\n    el.addEventListener(\"keyup\", keyUpControls);\n\n    // Add global events\n    calendar.addEventListener(\"swipeleft\", function(e) {\n        jSuites.slideLeft(calendarTable, 0, function() {\n            obj.next();\n            jSuites.slideRight(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    calendar.addEventListener(\"swiperight\", function(e) {\n        jSuites.slideRight(calendarTable, 0, function() {\n            obj.prev();\n            jSuites.slideLeft(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    if ('ontouchend' in document.documentElement === true) {\n        calendar.addEventListener(\"touchend\", mouseUpControls);\n\n        el.addEventListener(\"touchend\", function(e) {\n            obj.open();\n        });\n    } else {\n        calendar.addEventListener(\"mouseup\", mouseUpControls);\n\n        el.addEventListener(\"mouseup\", function(e) {\n            obj.open();\n        });\n    }\n\n    // Append element to the DOM\n    if (el.tagName == 'INPUT') {\n        el.parentNode.insertBefore(calendar, el.nextSibling);\n        // Add properties\n        el.setAttribute('autocomplete', 'off');\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\n\n        if (obj.options.readonly) {\n            el.setAttribute('readonly', 'readonly');\n        }\n        if (obj.options.placeholder) {\n            el.setAttribute('placeholder', obj.options.placeholder);\n        }\n        // Element\n        el.classList.add('jcalendar-input');\n        // Value\n        el.value = obj.setLabel(obj.getValue(), obj.options.format);\n    }\n\n    // Keep object available from the node\n    el.calendar = obj;\n\n    if (obj.options.opened == true) {\n        obj.open();\n    }\n\n    return obj;\n});\n\njSuites.calendar.prettify = function(d, texts) {\n    if (! texts) {\n        var texts = {\n            justNow: 'Just now',\n            xMinutesAgo: '{0}m ago',\n            xHoursAgo: '{0}h ago',\n            xDaysAgo: '{0}d ago',\n            xWeeksAgo: '{0}w ago',\n            xMonthsAgo: '{0} mon ago',\n            xYearsAgo: '{0}y ago',\n        }\n    }\n\n    var d1 = new Date();\n    var d2 = new Date(d);\n    var total = parseInt((d1 - d2) / 1000 / 60);\n\n    String.prototype.format = function(o) {\n        return this.replace('{0}', o);\n    }\n\n    if (total == 0) {\n        var text = texts.justNow;\n    } else if (total < 90) {\n        var text = texts.xMinutesAgo.format(total);\n    } else if (total < 1440) { // One day\n        var text = texts.xHoursAgo.format(Math.round(total/60));\n    } else if (total < 20160) { // 14 days\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\n    } else if (total < 43200) { // 30 days\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\n    } else if (total < 1036800) { // 24 months\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\n    } else { // 24 months+\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\n    }\n\n    return text;\n}\n\njSuites.calendar.prettifyAll = function() {\n    var elements = document.querySelectorAll('.prettydate');\n    for (var i = 0; i < elements.length; i++) {\n        if (elements[i].getAttribute('data-date')) {\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\n        } else {\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\n        }\n    }\n}\n\njSuites.calendar.now = function(date, dateOnly) {\n    if (! date) {\n        var date = new Date();\n    }\n    var y = date.getFullYear();\n    var m = date.getMonth() + 1;\n    var d = date.getDate();\n    var h = date.getHours();\n    var i = date.getMinutes();\n    var s = date.getSeconds();\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    if (dateOnly == true) {\n        return two(y) + '-' + two(m) + '-' + two(d);\n    } else {\n        return two(y) + '-' + two(m) + '-' + two(d) + ' ' + two(h) + ':' + two(i) + ':' + two(s);\n    }\n}\n\n// Helper to extract date from a string\njSuites.calendar.extractDateFromString = function(date, format) {\n    var v1 = '' + date;\n    var v2 = format.replace(/[0-9]/g,'');\n\n    var test = 1;\n\n    // Get year\n    var y = v2.search(\"YYYY\");\n    y = v1.substr(y,4);\n    if (parseInt(y) != y) {\n        test = 0;\n    }\n\n    // Get month\n    var m = v2.search(\"MM\");\n    m = v1.substr(m,2);\n    if (parseInt(m) != m || d > 12) {\n        test = 0;\n    }\n\n    // Get day\n    var d = v2.search(\"DD\");\n    d = v1.substr(d,2);\n    if (parseInt(d) != d  || d > 31) {\n        test = 0;\n    }\n\n    // Get hour\n    var h = v2.search(\"HH\");\n    if (h >= 0) {\n        h = v1.substr(h,2);\n        if (! parseInt(h) || h > 23) {\n            h = '00';\n        }\n    } else {\n        h = '00';\n    }\n    \n    // Get minutes\n    var i = v2.search(\"MI\");\n    if (i >= 0) {\n        i = v1.substr(i,2);\n        if (! parseInt(i) || i > 59) {\n            i = '00';\n        }\n    } else {\n        i = '00';\n    }\n\n    // Get seconds\n    var s = v2.search(\"SS\");\n    if (s >= 0) {\n        s = v1.substr(s,2);\n        if (! parseInt(s) || s > 59) {\n            s = '00';\n        }\n    } else {\n        s = '00';\n    }\n\n    if (test == 1 && date.length == v2.length) {\n        // Update source\n        var data = y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\n\n        return data;\n    }\n\n    return '';\n}\n\n// Helper to convert date into string\njSuites.calendar.getDateString = function(value, format) {\n    // Default calendar\n    if (! format) {\n        var format = 'DD/MM/YYYY';\n    }\n\n    if (value) {\n        var d = ''+value;\n        d = d.split(' ');\n\n        var h = '';\n        var m = '';\n        var s = '';\n\n        if (d[1]) {\n            h = d[1].split(':');\n            m = h[1] ? h[1] : '00';\n            s = h[2] ? h[2] : '00';\n            h = h[0] ? h[0] : '00';\n        } else {\n            h = '00';\n            m = '00';\n            s = '00';\n        }\n\n        d = d[0].split('-');\n\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\n            var calendar = new Date(d[0], d[1]-1, d[2]);\n            var weekday = new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');\n            var months = new Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\n\n            d[1] = (d[1].length < 2 ? '0' : '') + d[1];\n            d[2] = (d[2].length < 2 ? '0' : '') + d[2];\n            h = (h.length < 2 ? '0' : '') + h;\n            m = (m.length < 2 ? '0' : '') + m;\n            s = (s.length < 2 ? '0' : '') + s;\n\n            value = format;\n            value = value.replace('WD', weekday[calendar.getDay()]);\n            value = value.replace('DD', d[2]);\n            value = value.replace('MM', d[1]);\n            value = value.replace('YYYY', d[0]);\n            value = value.replace('YY', d[0].substring(2,4));\n            value = value.replace('MON', months[parseInt(d[1])-1].toUpperCase());\n\n            if (h) {\n                value = value.replace('HH24', h);\n            }\n\n            if (h > 12) {\n                value = value.replace('HH12', h - 12);\n                value = value.replace('HH', h);\n            } else {\n                value = value.replace('HH12', h);\n                value = value.replace('HH', h);\n            }\n\n            value = value.replace('MI', m);\n            value = value.replace('MM', m);\n            value = value.replace('SS', s);\n        } else {\n            value = '';\n        }\n    }\n\n    return value;\n}\n\njSuites.calendar.isOpen = function(e) {\n    if (jSuites.calendar.current) {\n        if (! e.target.className || e.target.className.indexOf('jcalendar') == -1) {\n            jSuites.calendar.current.close(false, false);\n        }\n    }\n}\n\nif ('ontouchstart' in document.documentElement === true) {\n    document.addEventListener(\"touchstart\", jSuites.calendar.isOpen);\n} else {\n    document.addEventListener(\"mousedown\", jSuites.calendar.isOpen);\n}\r\n\r\njSuites.color = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n    obj.values = [];\n\n    // Global container\n    if (! jSuites.color.current) {\n        jSuites.color.current = null;\n    }\n\n    /**\n     * @typedef {Object} defaults\n     * @property {(string|Array)} value - Initial value of the compontent\n     * @property {string} placeholder - The default instruction text on the element\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\n     * @property {requestCallback} onclose - Method to be execute when the element is closed\n     */\n    var defaults = {\n        placeholder: '',\n        value: null,\n        onclose: null,\n        onchange: null,\n        closeOnChange: true,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    var palette = {\n          \"red\": {\n            \"50\": \"#ffebee\",\n            \"100\": \"#ffcdd2\",\n            \"200\": \"#ef9a9a\",\n            \"300\": \"#e57373\",\n            \"400\": \"#ef5350\",\n            \"500\": \"#f44336\",\n            \"600\": \"#e53935\",\n            \"700\": \"#d32f2f\",\n            \"800\": \"#c62828\",\n            \"900\": \"#b71c1c\",\n          },\n          \"pink\": {\n            \"50\": \"#fce4ec\",\n            \"100\": \"#f8bbd0\",\n            \"200\": \"#f48fb1\",\n            \"300\": \"#f06292\",\n            \"400\": \"#ec407a\",\n            \"500\": \"#e91e63\",\n            \"600\": \"#d81b60\",\n            \"700\": \"#c2185b\",\n            \"800\": \"#ad1457\",\n            \"900\": \"#880e4f\",\n          },\n          \"purple\": {\n            \"50\": \"#f3e5f5\",\n            \"100\": \"#e1bee7\",\n            \"200\": \"#ce93d8\",\n            \"300\": \"#ba68c8\",\n            \"400\": \"#ab47bc\",\n            \"500\": \"#9c27b0\",\n            \"600\": \"#8e24aa\",\n            \"700\": \"#7b1fa2\",\n            \"800\": \"#6a1b9a\",\n            \"900\": \"#4a148c\",\n          },\n          \"indigo\": {\n            \"50\": \"#e8eaf6\",\n            \"100\": \"#c5cae9\",\n            \"200\": \"#9fa8da\",\n            \"300\": \"#7986cb\",\n            \"400\": \"#5c6bc0\",\n            \"500\": \"#3f51b5\",\n            \"600\": \"#3949ab\",\n            \"700\": \"#303f9f\",\n            \"800\": \"#283593\",\n            \"900\": \"#1a237e\",\n          },\n          \"blue\": {\n            \"50\": \"#e3f2fd\",\n            \"100\": \"#bbdefb\",\n            \"200\": \"#90caf9\",\n            \"300\": \"#64b5f6\",\n            \"400\": \"#42a5f5\",\n            \"500\": \"#2196f3\",\n            \"600\": \"#1e88e5\",\n            \"700\": \"#1976d2\",\n            \"800\": \"#1565c0\",\n            \"900\": \"#0d47a1\",\n          },\n          \"cyan\": {\n            \"50\": \"#e0f7fa\",\n            \"100\": \"#b2ebf2\",\n            \"200\": \"#80deea\",\n            \"300\": \"#4dd0e1\",\n            \"400\": \"#26c6da\",\n            \"500\": \"#00bcd4\",\n            \"600\": \"#00acc1\",\n            \"700\": \"#0097a7\",\n            \"800\": \"#00838f\",\n            \"900\": \"#006064\",\n          },\n          \"teal\": {\n            \"50\": \"#e0f2f1\",\n            \"100\": \"#b2dfdb\",\n            \"200\": \"#80cbc4\",\n            \"300\": \"#4db6ac\",\n            \"400\": \"#26a69a\",\n            \"500\": \"#009688\",\n            \"600\": \"#00897b\",\n            \"700\": \"#00796b\",\n            \"800\": \"#00695c\",\n            \"900\": \"#004d40\",\n          },\n          \"green\": {\n            \"50\": \"#e8f5e9\",\n            \"100\": \"#c8e6c9\",\n            \"200\": \"#a5d6a7\",\n            \"300\": \"#81c784\",\n            \"400\": \"#66bb6a\",\n            \"500\": \"#4caf50\",\n            \"600\": \"#43a047\",\n            \"700\": \"#388e3c\",\n            \"800\": \"#2e7d32\",\n            \"900\": \"#1b5e20\",\n          },\n          \"lightgreen\": {\n            \"50\": \"#f1f8e9\",\n            \"100\": \"#dcedc8\",\n            \"200\": \"#c5e1a5\",\n            \"300\": \"#aed581\",\n            \"400\": \"#9ccc65\",\n            \"500\": \"#8bc34a\",\n            \"600\": \"#7cb342\",\n            \"700\": \"#689f38\",\n            \"800\": \"#558b2f\",\n            \"900\": \"#33691e\",\n          },\n          \"lime\": {\n            \"50\": \"#f9fbe7\",\n            \"100\": \"#f0f4c3\",\n            \"200\": \"#e6ee9c\",\n            \"300\": \"#dce775\",\n            \"400\": \"#d4e157\",\n            \"500\": \"#cddc39\",\n            \"600\": \"#c0ca33\",\n            \"700\": \"#afb42b\",\n            \"800\": \"#9e9d24\",\n            \"900\": \"#827717\",\n          },\n          \"yellow\": {\n            \"50\": \"#fffde7\",\n            \"100\": \"#fff9c4\",\n            \"200\": \"#fff59d\",\n            \"300\": \"#fff176\",\n            \"400\": \"#ffee58\",\n            \"500\": \"#ffeb3b\",\n            \"600\": \"#fdd835\",\n            \"700\": \"#fbc02d\",\n            \"800\": \"#f9a825\",\n            \"900\": \"#f57f17\",\n          },\n          \"amber\": {\n            \"50\": \"#fff8e1\",\n            \"100\": \"#ffecb3\",\n            \"200\": \"#ffe082\",\n            \"300\": \"#ffd54f\",\n            \"400\": \"#ffca28\",\n            \"500\": \"#ffc107\",\n            \"600\": \"#ffb300\",\n            \"700\": \"#ffa000\",\n            \"800\": \"#ff8f00\",\n            \"900\": \"#ff6f00\",\n          },\n          \"orange\": {\n            \"50\": \"#fff3e0\",\n            \"100\": \"#ffe0b2\",\n            \"200\": \"#ffcc80\",\n            \"300\": \"#ffb74d\",\n            \"400\": \"#ffa726\",\n            \"500\": \"#ff9800\",\n            \"600\": \"#fb8c00\",\n            \"700\": \"#f57c00\",\n            \"800\": \"#ef6c00\",\n            \"900\": \"#e65100\",\n          },\n          \"deeporange\": {\n            \"50\": \"#fbe9e7\",\n            \"100\": \"#ffccbc\",\n            \"200\": \"#ffab91\",\n            \"300\": \"#ff8a65\",\n            \"400\": \"#ff7043\",\n            \"500\": \"#ff5722\",\n            \"600\": \"#f4511e\",\n            \"700\": \"#e64a19\",\n            \"800\": \"#d84315\",\n            \"900\": \"#bf360c\",\n          },\n          \"brown\": {\n            \"50\": \"#efebe9\",\n            \"100\": \"#d7ccc8\",\n            \"200\": \"#bcaaa4\",\n            \"300\": \"#a1887f\",\n            \"400\": \"#8d6e63\",\n            \"500\": \"#795548\",\n            \"600\": \"#6d4c41\",\n            \"700\": \"#5d4037\",\n            \"800\": \"#4e342e\",\n            \"900\": \"#3e2723\"\n          },\n          \"grey\": {\n            \"50\": \"#fafafa\",\n            \"100\": \"#f5f5f5\",\n            \"200\": \"#eeeeee\",\n            \"300\": \"#e0e0e0\",\n            \"400\": \"#bdbdbd\",\n            \"500\": \"#9e9e9e\",\n            \"600\": \"#757575\",\n            \"700\": \"#616161\",\n            \"800\": \"#424242\",\n            \"900\": \"#212121\"\n          },\n          \"bluegrey\": {\n            \"50\": \"#eceff1\",\n            \"100\": \"#cfd8dc\",\n            \"200\": \"#b0bec5\",\n            \"300\": \"#90a4ae\",\n            \"400\": \"#78909c\",\n            \"500\": \"#607d8b\",\n            \"600\": \"#546e7a\",\n            \"700\": \"#455a64\",\n            \"800\": \"#37474f\",\n            \"900\": \"#263238\"\n          }\n    };\n\n    var x = 0;\n    var y = 0;\n    var colors = [];\n\n    var col = Object.keys(palette);\n    var shade = Object.keys(palette[col[0]]);\n\n    for (var i = 0; i < col.length; i++) {\n        for (var j = 0; j < shade.length; j++) {\n            if (! colors[j]) {\n                colors[j] = [];\n            }\n            colors[j][i] = palette[col[i]][shade[j]];\n        }\n    };\n\n    // Value\n    if (obj.options.value) {\n        el.value = obj.options.value;\n    }\n\n    // Table container\n    var container = document.createElement('div');\n    container.className = 'jcolor';\n\n    // Table container\n    var backdrop = document.createElement('div');\n    backdrop.className = 'jcolor-backdrop';\n    container.appendChild(backdrop);\n\n    // Content\n    var content = document.createElement('div');\n    content.className = 'jcolor-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jcolor-close';\n    closeButton.innerHTML = 'Done';\n    closeButton.onclick = function() {\n        obj.close();\n    }\n    content.appendChild(closeButton);\n\n    // Table pallete\n    var table = document.createElement('table');\n    table.setAttribute('cellpadding', '7');\n    table.setAttribute('cellspacing', '0');\n\n    for (var i = 0; i < colors.length; i++) {\n        var tr = document.createElement('tr');\n        for (var j = 0; j < colors[i].length; j++) {\n            var td = document.createElement('td');\n            td.style.backgroundColor = colors[i][j];\n            td.setAttribute('data-value', colors[i][j]);\n            td.innerHTML = '';\n            tr.appendChild(td);\n\n            // Selected color\n            if (obj.options.value == colors[i][j]) {\n                td.classList.add('jcolor-selected');\n            }\n\n            // Possible values\n            obj.values[colors[i][j]] = td;\n        }\n        table.appendChild(tr);\n    }\n\n    /**\n     * Open color pallete\n     */\n    obj.open = function() {\n        if (jSuites.color.current) {\n            if (jSuites.color.current != obj) {\n                jSuites.color.current.close();\n            }\n        }\n\n        if (! jSuites.color.current) {\n            // Persist element\n            jSuites.color.current = obj;\n            // Show colorpicker\n            container.classList.add('jcolor-focus');\n\n            const rectContent = content.getBoundingClientRect();\n\n            if (jSuites.getWindowWidth() < 800) {\n                content.style.top = '';\n                content.classList.add('jcolor-fullscreen');\n                jSuites.slideBottom(content, 1);\n                backdrop.style.display = 'block';\n            } else {\n                if (content.classList.contains('jcolor-fullscreen')) {\n                    content.classList.remove('jcolor-fullscreen');\n                    backdrop.style.display = '';\n                }\n\n                const rect = el.getBoundingClientRect();\n\n                if (window.innerHeight < rect.bottom + rectContent.height) {\n                    content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\n                } else {\n                    content.style.top = '2px';\n                }\n            }\n\n            container.focus();\n        }\n    }\n\n    /**\n     * Close color pallete\n     */\n    obj.close = function(ignoreEvents) {\n        if (jSuites.color.current) {\n            jSuites.color.current = null;\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            container.classList.remove('jcolor-focus');\n        }\n\n        // Make sure backdrop is hidden\n        backdrop.style.display = '';\n\n        return obj.options.value;\n    }\n\n    /**\n     * Set value\n     */\n    obj.setValue = function(color) {\n        if (color) {\n            el.value = color;\n            obj.options.value = color;\n        }\n\n        // Remove current selecded mark\n        var selected = container.querySelector('.jcolor-selected');\n        if (selected) {\n            selected.classList.remove('jcolor-selected');\n        }\n\n        // Mark cell as selected\n        obj.values[color].classList.add('jcolor-selected');\n\n        // Onchange\n        if (typeof(obj.options.onchange) == 'function') {\n            obj.options.onchange(el, color);\n        }\n\r\n        if (obj.options.closeOnChange == true) {\r\n            obj.close();\r\n        }\n    }\n\n    /**\n     * Get value\n     */\n    obj.getValue = function() {\n        return obj.options.value;\n    }\n\n    /**\n     * If element is focus open the picker\n     */\n    el.addEventListener(\"focus\", function(e) {\n        obj.open();\n    });\n\n    el.addEventListener(\"mousedown\", function(e) {\n        if (! jSuites.color.current) {\r\n            setTimeout(function() {\r\n        obj.open();\n                e.preventDefault();\r\n            }, 200);\r\n        }\n    });\n\n    // Select color\n    container.addEventListener(\"mouseup\", function(e) {\n        if (e.target.tagName == 'TD') {\n            jSuites.color.current.setValue(e.target.getAttribute('data-value'));\n\r\n            if (jSuites.color.current) {\n                jSuites.color.current.close();\n            }\n        }\n    });\n\n    // Close controller\n    document.addEventListener(\"mousedown\", function(e) {\n        if (jSuites.color.current) {\n            var element = jSuites.getElement(e.target, 'jcolor');\n            if (! element) {\n                jSuites.color.current.close();\n            }\n        }\n    });\n\n    // Possible to focus the container\n    container.setAttribute('tabindex', '900');\n\n    // Placeholder\n    if (obj.options.placeholder) {\n        el.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append to the table\n    content.appendChild(table);\n    container.appendChild(content);\n\n    // Insert picker after the element\n    if (el.tagName == 'INPUT') {\n        el.parentNode.insertBefore(container, el.nextSibling);\n    } else {\n        el.appendChild(container);\n    }\n\n    // Keep object available from the node\n    el.color = obj;\n\n    return obj;\n});\n\r\n\r\njSuites.contextmenu = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        items: null,\n        onclick: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Class definition\n    el.classList.add('jcontextmenu');\n    // Focusable\n    el.setAttribute('tabindex', '900');\n\n    /**\n     * Open contextmenu\n     */\n    obj.open = function(e, items) {\n        if (items) {\n            // Update content\n            obj.options.items = items;\n            // Create items\n            obj.create(items);\n        }\n        // Coordinates\n        if (e.target) {\n            var x = e.clientX;\n            var y = e.clientY;\n        } else {\n            var x = e.x;\n            var y = e.y;\n        }\n\n        el.classList.add('jcontextmenu-focus');\n        el.focus();\n\n        const rect = el.getBoundingClientRect();\n\n        if (window.innerHeight < y + rect.height) {\n            el.style.top = (y - rect.height) + 'px';\n        } else {\n            el.style.top = y + 'px';\n        }\n\n        if (window.innerWidth < x + rect.width) {\n            if (x - rect.width > 0) {\n                el.style.left = (x - rect.width) + 'px';\n            } else {\n                el.style.left = '10px';\n            }\n        } else {\n            el.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Close menu\n     */\n    obj.close = function() {\n        if (el.classList.contains('jcontextmenu-focus')) {\n            el.classList.remove('jcontextmenu-focus');\n        }\n    }\n\n    /**\n     * Create items based on the declared objectd\n     * @param {object} items - List of object\n     */\n    obj.create = function(items) {\n        // Update content\n        el.innerHTML = '';\n\n        // Append items\n        for (var i = 0; i < items.length; i++) {\n            if (items[i].type && items[i].type == 'line') {\n                var itemContainer = document.createElement('hr');\n            } else {\n                var itemContainer = document.createElement('div');\n                var itemText = document.createElement('a');\n                itemText.innerHTML = items[i].title;\n\n                if (items[i].disabled) {\n                    itemContainer.className = 'jcontextmenu-disabled';\n                } else if (items[i].onclick) {\n                    itemContainer.method = items[i].onclick;\n                    itemContainer.addEventListener(\"mouseup\", function() {\n                        // Execute method\n                        this.method(this);\n                    });\n                }\n                itemContainer.appendChild(itemText);\n\n                if (items[i].shortcut) {\n                    var itemShortCut = document.createElement('span');\n                    itemShortCut.innerHTML = items[i].shortcut;\n                    itemContainer.appendChild(itemShortCut);\n                }\n            }\n\n            el.appendChild(itemContainer);\n        }\n    }\n\n    if (typeof(obj.options.onclick) == 'function') {\n        el.addEventListener('click', function(e) {\n            obj.options.onclick(obj);\n        });\n    }\n\n    el.addEventListener('blur', function(e) {\n        setTimeout(function() {\n            obj.close();\n        }, 120);\n    });\n\n    window.addEventListener(\"mousewheel\", function() {\n        obj.close();\n    });\n\n    // Create items\n    if (obj.options.items) {\n        obj.create(obj.options.items);\n    }\n\n    el.contextmenu = obj;\n\n    return obj;\n});\n\njSuites.contextmenu.getElement = function(element) {\n    var foundId = 0;\n\n    function path (element) {\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\n            foundId = element.getAttribute('aria-contextmenu-id')\n        } else {\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n    }\n\n    path(element);\n\n    return foundId;\n}\n\ndocument.addEventListener(\"contextmenu\", function(e) {\n    var id = jSuites.contextmenu.getElement(e.target);\n    if (id) {\n        var element = document.querySelector('#' + id);\n        if (! element) {\n            console.error('JSUITES: Contextmenu id not found');\n        } else {\n            element.contextmenu.open(e);\n            e.preventDefault();\n        }\n    }\n});\r\n\r\n/**\n * Dialog v1.0.1\n * Author: paul.hodel@gmail.com\n * https://github.com/paulhodel/jtools\n */\n \njSuites.dialog = (function() {\n    var obj = {};\n    obj.options = {};\n\n    var dialog = document.createElement('div');\n    dialog.setAttribute('tabindex', '901');\n    dialog.className = 'jdialog';\n    dialog.id = 'dialog';\n\n    var dialogHeader = document.createElement('div');\n    dialogHeader.className = 'jdialog-header';\n\n    var dialogTitle = document.createElement('div');\n    dialogTitle.className = 'jdialog-title';\n    dialogHeader.appendChild(dialogTitle);\n\n    var dialogMessage = document.createElement('div');\n    dialogMessage.className = 'jdialog-message';\n    dialogHeader.appendChild(dialogMessage);\n\n    var dialogFooter = document.createElement('div');\n    dialogFooter.className = 'jdialog-footer';\n\n    var dialogContainer = document.createElement('div');\n    dialogContainer.className = 'jdialog-container';\n    dialogContainer.appendChild(dialogHeader);\n    dialogContainer.appendChild(dialogFooter);\n\n    // Confirm\n    var dialogConfirm = document.createElement('div');\n    var dialogConfirmButton = document.createElement('input');\n    dialogConfirmButton.value = obj.options.confirmLabel;\n    dialogConfirmButton.type = 'button';\n    dialogConfirmButton.onclick = function() {\n        if (typeof(obj.options.onconfirm) == 'function') {\n            obj.options.onconfirm();\n        }\n        obj.close();\n    };\n    dialogConfirm.appendChild(dialogConfirmButton);\n    dialogFooter.appendChild(dialogConfirm);\n\n    // Cancel\n    var dialogCancel = document.createElement('div');\n    var dialogCancelButton = document.createElement('input');\n    dialogCancelButton.value = obj.options.cancelLabel;\n    dialogCancelButton.type = 'button';\n    dialogCancelButton.onclick = function() {\n        if (typeof(obj.options.oncancel) == 'function') {\n            obj.options.oncancel();\n        }\n        obj.close();\n    }\n    dialogCancel.appendChild(dialogCancelButton);\n    dialogFooter.appendChild(dialogCancel);\n\n    // Dialog\n    dialog.appendChild(dialogContainer);\n\n    obj.open = function(options) {\n        obj.options = options;\n\n        if (obj.options.title) {\n            dialogTitle.innerHTML = obj.options.title;\n        }\n\n        if (obj.options.message) {\n            dialogMessage.innerHTML = obj.options.message;\n        }\n\n        if (! obj.options.confirmLabel) {\n            obj.options.confirmLabel = 'OK';\n        }\n        dialogConfirmButton.value = obj.options.confirmLabel;\n\n        if (! obj.options.cancelLabel) {\n            obj.options.cancelLabel = 'Cancel';\n        }\n        dialogCancelButton.value = obj.options.cancelLabel;\n\n        if (obj.options.type == 'confirm') {\n            dialogCancelButton.parentNode.style.display = '';\n        } else {\n            dialogCancelButton.parentNode.style.display = 'none';\n        }\n\n        // Append element to the app\n        dialog.style.opacity = 100;\n\n        // Append to the page\n        if (jSuites.el) {\n            jSuites.el.appendChild(dialog);\n        } else {\n            document.body.appendChild(dialog);\n        }\n\n        // Focus\n        dialog.focus();\n\n        // Show\n        setTimeout(function() {\n            dialogContainer.style.opacity = 100;\n        }, 0);\n    };\n\n    obj.close = function() {\n        dialog.style.opacity = 0;\n        dialogContainer.style.opacity = 0;\n        setTimeout(function() {\n            dialog.remove();\n        }, 100);\n    };\n\n    return obj;\n})();\n\njSuites.confirm = (function(message, onconfirm) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            type: 'confirm',\n            message: message,\n            title: 'Confirmation',\n            onconfirm: onconfirm,\n        });\n    } else {\n        if (confirm(message)) {\n            onconfirm();\n        }\n    }\n});\n\njSuites.alert = function(message) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            title:'Alert',\n            message:message,\n        });\n    } else {\n        alert(message);\n    }\n}\n\r\n\r\njSuites.dropdown = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // If the element is a SELECT tag, create a configuration object\n    if (el.tagName == 'SELECT') {\n        var ret = jSuites.dropdown.extractFromDom(el, options);\n        el = ret.el;\n        options = ret.options;\n    }\n\n    // Default configuration\n    var defaults = {\n        url: null,\n        data: [],\n        multiple: false,\n        autocomplete: false,\n        type: null,\n        width: null,\n        opened: false,\n        value: null,\n        placeholder: '',\n        position: false,\n        onchange: null,\n        onload: null,\n        onopen: null,\n        onclose: null,\n        onblur: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global container\n    if (! jSuites.dropdown.current) {\n        jSuites.dropdown.current = null;\n    }\n\n    // Containers\n    obj.items = [];\n    obj.groups = [];\n    obj.selected = [];\n\n    // Create dropdown\n    el.classList.add('jdropdown');\n \n    if (obj.options.type == 'searchbar') {\n        el.classList.add('jdropdown-searchbar');\n    } else if (obj.options.type == 'list') {\n        el.classList.add('jdropdown-list');\n    } else if (obj.options.type == 'picker') {\n        el.classList.add('jdropdown-picker');\n    } else {\n        if (jSuites.getWindowWidth() < 800) {\n            el.classList.add('jdropdown-picker');\n            obj.options.type = 'picker';\n        } else {\n            if (obj.options.width) {\n                el.style.width = obj.options.width;\n                el.style.minWidth = obj.options.width;\n            }\n            el.classList.add('jdropdown-default');\n            obj.options.type = 'default';\n        }\n    }\n\n    // Header container\n    var containerHeader = document.createElement('div');\n    containerHeader.className = 'jdropdown-container-header';\n\n    // Header\n    var header = document.createElement('input');\n    header.className = 'jdropdown-header';\n    if (typeof(obj.options.onblur) == 'function') {\n        header.onblur = function() {\n            obj.options.onblur(el);\n        }\n    }\n\n    // Container\n    var container = document.createElement('div');\n    container.className = 'jdropdown-container';\n\n    // Dropdown content\n    var content = document.createElement('div');\n    content.className = 'jdropdown-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jdropdown-close';\n    closeButton.innerHTML = 'Done';\n\n    // Create backdrop\n    var backdrop  = document.createElement('div');\n    backdrop.className = 'jdropdown-backdrop';\n\n    // Autocomplete\n    if (obj.options.autocomplete == true) {\n        el.setAttribute('data-autocomplete', true);\n\n        // Handler\n        var keyTimer = null;\n        header.addEventListener('keyup', function(e) {\n            if (keyTimer) {\n                clearTimeout(keyTimer);\n            }\n            keyTimer = setTimeout(function() {\n                obj.find(header.value);\n                keyTimer = null;\n            }, 500);\n\n            if (! el.classList.contains('jdropdown-focus')) {\n                if (e.which > 65) {\n                    obj.open();\n                }\n            }\n        });\n    } else {\n        header.setAttribute('readonly', 'readonly');\n    }\n\n    // Place holder\n    if (! obj.options.placeholder && el.getAttribute('placeholder')) {\n        obj.options.placeholder = el.getAttribute('placeholder');\n    }\n\n    if (obj.options.placeholder) {\n        header.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append elements\n    containerHeader.appendChild(header);\n    if (obj.options.type == 'searchbar') {\n        containerHeader.appendChild(closeButton);\n    } else {\n        container.appendChild(closeButton);\n    }\n    container.appendChild(content);\n    el.appendChild(containerHeader);\n    el.appendChild(container);\n    el.appendChild(backdrop);\n\n    /**\n     * Init dropdown\n     */\n    obj.init = function() {\n        if (obj.options.url) {\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(data) {\n                    if (data) {\n                        // Set data\n                        obj.setData(data);\n                        // Set value\n                        if (obj.options.value != null) {\n                            obj.setValue(obj.options.value);\n                        }\n                        // Onload method\n                        if (typeof(obj.options.onload) == 'function') {\n                            obj.options.onload(el, obj, data);\n                        }\n                    }\n                }\n            });\n        } else {\n            // Set data\n            obj.setData();\n            // Set value\n            if (obj.options.value != null) {\n                obj.setValue(obj.options.value);\n            }\n            // Onload\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj, data);\n            }\n        }\n\n        // Open dropdown\n        if (obj.options.opened == true) {\n            obj.open();\n        }\n    }\n\n    obj.getUrl = function() {\n        return obj.options.url;\n    }\n\n    obj.setUrl = function(url) {\n        obj.options.url = url;\n\n        jSuites.ajax({\n            url: obj.options.url,\n            method: 'GET',\n            dataType: 'json',\n            success: function(data) {\n                obj.setData(data);\n            }\n        });\n    }\n\n    /**\n     * Create a new item\n     */\n    obj.createItem = function(data) {\n        // Create item\n        var item = {};\n        item.element = document.createElement('div');\n        item.element.className = 'jdropdown-item';\n        item.value = data.id;\n        item.text = data.name;\n        item.textLowerCase = '' + data.name.toLowerCase();\n\n        // Image\n        if (data.image) {\n            var image = document.createElement('img');\n            image.className = 'jdropdown-image';\n            image.src = data.image;\n            if (! data.title) {\n               image.classList.add('jdropdown-image-small');\n            }\n            item.element.appendChild(image);\n        }\n\n        // Set content\n        var node = document.createElement('div');\n        node.className = 'jdropdown-description';\n        node.innerHTML = data.name;\n\n        // Title\n        if (data.title) {\n            var title = document.createElement('div');\n            title.className = 'jdropdown-title';\n            title.innerHTML = data.title;\n            node.appendChild(title);\n        }\n\n        // Add node to item\n        item.element.appendChild(node);\n\n        return item;\n    }\n\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            obj.options.data = data;\n        }\n\n        // Data\n        var data = obj.options.data;\n\n        // Remove content from the DOM\n        container.removeChild(content);\n\n        // Make sure the content container is blank\n        content.innerHTML = '';\n\n        // Reset\n        obj.reset();\n\n        // Reset items\n        obj.items = [];\n\n        // Helpers\n        var items = [];\n        var groups = [];\n\n        // Create elements\n        if (data.length) {\n            // Prepare data\n            for (var i = 0; i < data.length; i++) {\n                // Compatibility\n                if (typeof(data[i]) != 'object') {\n                    // Correct format\n                    obj.options.data[i] = data[i] = { id: data[i], name: data[i] };\n                }\n\n                // Process groups\n                if (data[i].group) {\n                    if (! groups[data[i].group]) {\n                        groups[data[i].group] = [];\n                    }\n                    groups[data[i].group].push(i);\n                } else {\n                    items.push(i);\n                }\n            }\n\n            // Groups\n            var groupNames = Object.keys(groups);\n\n            // Append groups in case exists\n            if (groupNames.length > 0) {\n                for (var i = 0; i < groupNames.length; i++) {\n                    // Group container\n                    var group = document.createElement('div');\n                    group.className = 'jdropdown-group';\n                    // Group name\n                    var groupName = document.createElement('div');\n                    groupName.className = 'jdropdown-group-name';\n                    groupName.innerHTML = groupNames[i];\n                    // Group arrow\n                    var groupArrow = document.createElement('i');\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\n                    groupName.appendChild(groupArrow);\n                    // Group items\n                    var groupContent = document.createElement('div');\n                    groupContent.className = 'jdropdown-group-items';\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\n                        var item = obj.createItem(data[groups[groupNames[i]][j]]);\n                        groupContent.appendChild(item.element);\n                        // Items\n                        obj.items.push(item);\n                    }\n                    // Group itens\n                    group.appendChild(groupName);\n                    group.appendChild(groupArrow);\n                    group.appendChild(groupContent);\n                    content.appendChild(group);\n                }\n            }\n\n            if (items.length) {\n                for (var i = 0; i < items.length; i++) {\n                    var item = obj.createItem(data[items[i]]);\n                    obj.items.push(item);\n                    content.appendChild(item.element);\n                }\n            }\n\n            // Create the Indexes\n            for (var i = 0; i < obj.items.length; i++) {\n                obj.items[i].element.setAttribute('data-index', i);\n            }\n        }\n\n        // Re-insert the content to the container\n        container.appendChild(content);\n    }\n\n    obj.getText = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].text);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join('; ');\n        }\n    }\n\n    obj.getValue = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].value);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join(';');\n        }\n    }\n\n    obj.setValue = function(value) {\n        // Remove values\n        for (var i = 0; i < obj.selected.length; i++) {\n            obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected')\n        } \n\n        // Reset selected\n        obj.selected = [];\n\n        // Set values\n        if (value != null) {\n            if (Array.isArray(value)) {\n                for (var i = 0; i < obj.items.length; i++) {\n                    for (var j = 0; j < value.length; j++) {\n                        if (obj.items[i].value == value[j]) {\n                            // Keep index of the selected item\n                            obj.selected.push(i);\n                            // Visual selection\n                            obj.items[i].element.classList.add('jdropdown-selected');\n                        }\n                    }\n                }\n            } else {\n                for (var i = 0; i < obj.items.length; i++) {\n                    if (obj.items[i].value == value) {\n                        // Keep index of the selected item\n                        obj.selected.push(i);\n                        // Visual selection\n                        obj.items[i].element.classList.add('jdropdown-selected');\n                    }\n                }\n            }\n        }\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    obj.selectIndex = function(index) {\n        // Only select those existing elements\n        if (obj.items && obj.items[index]) {\n            var index = index = parseInt(index);\n            // Current selection\n            var oldValue = obj.getValue();\n            var oldLabel = obj.getText();\n\n            // Remove cursor style\n            if (obj.currentIndex != null) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Set cursor style\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update cursor position\n            obj.currentIndex = index;\n\n            // Focus behaviour\n            if (! obj.options.multiple) {\n                // Unselect option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    // Reset selected\n                    obj.resetSelected();\n                } else {\n                    // Reset selected\n                    obj.resetSelected();\n                    // Update selected item\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                    // Close\n                    obj.close();\n                }\n            } else {\n                // Toggle option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    obj.items[index].element.classList.remove('jdropdown-selected');\n                    // Remove from selected list\n                    var indexToRemove = obj.selected.indexOf(index);\n                    // Remove select\n                    obj.selected.splice(indexToRemove, 1);\n                } else {\n                    // Select element\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                }\n\n                // Update labels for multiple dropdown\n                if (! obj.options.autocomplete) {\n                    obj.updateLabel();\n                }\n            }\n\n            // Current selection\n            var newValue = obj.getValue();\n            var newLabel = obj.getText();\n\n            // Events\n            if (typeof(obj.options.onchange) == 'function') {\n                obj.options.onchange(el, index, oldValue, newValue, oldLabel, newLabel);\n            }\n        }\n    }\n\n    obj.selectItem = function(item) {\n        if (jSuites.dropdown.current) {\n            var index = item.getAttribute('data-index');\n            if (index != null) {\n                obj.selectIndex(index);\n            }\n        }\n    }\n\n    obj.find = function(str) {\n        // Force lowercase\n        var str = str ? str.toLowerCase() : null;\n\n        // Append options\n        for (var i = 0; i < obj.items.length; i++) {\n            if (str == null || obj.items[i].textLowerCase.indexOf(str) != -1) {\n                obj.items[i].element.style.display = '';\n            } else {\n                if (obj.selected.indexOf(i) == -1) {\n                    obj.items[i].element.style.display = 'none';\n                } else {\n                    obj.items[i].element.style.display = '';\n                }\n            }\n        }\n\n        var numVisibleItems = function(items) {\n            var visible = 0;\n            for (var j = 0; j < items.length; j++) {\n                if (items[j].style.display != 'none') {\n                    visible++;\n                }\n            }\n            return visible;\n        }\n\n        // Hide groups\n        /*for (var i = 0; i < obj.groups.length; i++) {\n            if (numVisibleItems(obj.groups[i].querySelectorAll('.jdropdown-item'))) {\n                obj.groups[i].children[0].style.display = '';\n            } else {\n                obj.groups[i].children[0].style.display = 'none';\n            }\n        }*/\n    }\n\n    obj.updateLabel = function() {\n        // Update label\n        header.value = obj.getText();\n    }\n\n    obj.open = function() {\n        if (jSuites.dropdown.current != el) {\n            if (jSuites.dropdown.current) {\n                jSuites.dropdown.current.dropdown.close();\n            }\n            jSuites.dropdown.current = el;\n        }\n\n        // Focus\n        if (! el.classList.contains('jdropdown-focus')) {\n            // Add focus\n            el.classList.add('jdropdown-focus');\n\n            // Animation\n            if (jSuites.getWindowWidth() < 800) {\n                if (obj.options.type == null || obj.options.type == 'picker') {\n                    jSuites.slideBottom(container, 1);\n                }\n            }\n\n            // Filter\n            if (obj.options.autocomplete == true) {\n                // Redo search\n                obj.find();\n                // Clear search field\n                header.value = '';\n                header.focus();\n            }\n\n            // Set cursor for the first or first selected element\n            var cursor = (obj.selected && obj.selected[0]) ? obj.selected[0] : 0;\n            obj.updateCursor(cursor);\n\n            // Container Size\n            if (! obj.options.type || obj.options.type == 'default') {\n                const rect = el.getBoundingClientRect();\n                const rectContainer = container.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    container.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.top = '';\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\n                    } else {\n                        container.style.top = rect.bottom + 'px';\n                        container.style.bottom = '';\n                    }\n                    container.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.top = '';\n                        container.style.bottom = rect.height + 1 + 'px';\n                    } else {\n                        container.style.top = '';\n                        container.style.bottom = '';\n                    }\n                }\n\n                container.style.minWidth = rect.width + 'px';\n            }\n        }\n\n        // Events\n        if (typeof(obj.options.onopen) == 'function') {\n            obj.options.onopen(el);\n        }\n    }\n\n    obj.close = function(ignoreEvents) {\n        if (jSuites.dropdown.current) {\n            // Remove controller\n            jSuites.dropdown.current = null\n            // Remove cursor\n            obj.resetCursor();\n            // Update labels\n            obj.updateLabel();\n            // Events\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            // Blur\n            if (header.blur) {\n                header.blur();\n            }\n            // Remove focus\n            el.classList.remove('jdropdown-focus');\n        }\n\n        return obj.getValue();\n    }\n\n    /**\n     * Update position cursor\n     */\n    obj.updateCursor = function(index) {\n        // Set new cursor\n        if (obj.items && obj.items[index] && obj.items[index].element) {\n            // Reset cursor\n            obj.resetCursor();\n\n            // Set new cursor\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update position\n            obj.currentIndex = parseInt(index);\n    \n            // Update scroll to the cursor element\n            var container = content.scrollTop;\n            var element = obj.items[obj.currentIndex].element;\n            content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetCursor = function() {\n        // Remove current cursor\n        if (obj.currentIndex != null) {\n            // Remove visual cursor\n            if (obj.items && obj.items[obj.currentIndex]) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Reset cursor\n            obj.currentIndex = null;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetSelected = function() {\n        // Unselected all\n        if (obj.selected) {\n            // Remove visual selection\n            for (var i = 0; i < obj.selected.length; i++) {\n                if (obj.items[obj.selected[i]]) {\n                    obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected');\n                }\n            }\n            // Reset current selected items\n            obj.selected = [];\n        }\n    }\n\n    /**\n     * Reset cursor and selected items\n     */\n    obj.reset = function() {\n        // Reset cursor\n        obj.resetCursor();\n\n        // Reset selected\n        obj.resetSelected();\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    /**\n     * First visible item\n     */\n    obj.firstVisible = function() {\n        var newIndex = null;\n        for (var i = 0; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    /**\n     * Navigation\n     */\n    obj.first = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.last = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.next = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.prev = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    if (! jSuites.dropdown.hasEvents) {\n        if ('ontouchsend' in document.documentElement === true) {\n            document.addEventListener('touchsend', jSuites.dropdown.mouseup);\n        } else {\n            document.addEventListener('mouseup', jSuites.dropdown.mouseup);\n        }\n        document.addEventListener('keydown', jSuites.dropdown.onkeydown);\n\n        jSuites.dropdown.hasEvents = true;\n    }\n\n    // Start dropdown\n    obj.init();\n\n    // Keep object available from the node\n    el.dropdown = obj;\n\n    return obj;\n});\n\njSuites.dropdown.hasEvents = false;\n\njSuites.dropdown.mouseup = function(e) {\n    var element = jSuites.getElement(e.target, 'jdropdown');\n    if (element) {\n        var dropdown = element.dropdown;\n        if (e.target.classList.contains('jdropdown-header')) {\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\n                dropdown.close();\n            } else {\n                dropdown.open();\n            }\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\n            var items = e.target.nextSibling.children;\n            if (e.target.nextSibling.style.display != 'none') {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].style.display != 'none') {\n                        dropdown.selectItem(items[i]);\n                    }\n                }\n            }\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\n                e.target.classList.remove('jdropdown-group-arrow-down');\n                e.target.classList.add('jdropdown-group-arrow-up');\n                e.target.parentNode.nextSibling.style.display = 'none';\n            } else {\n                e.target.classList.remove('jdropdown-group-arrow-up');\n                e.target.classList.add('jdropdown-group-arrow-down');\n                e.target.parentNode.nextSibling.style.display = '';\n            }\n        } else if (e.target.classList.contains('jdropdown-item')) {\n            dropdown.selectItem(e.target);\n        } else if (e.target.classList.contains('jdropdown-image')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-description')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-title')) {\n            dropdown.selectIndex(e.target.parentNode.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\n            // Close\n            dropdown.close();\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n    } else {\n        if (jSuites.dropdown.current) {\n            jSuites.dropdown.current.dropdown.close();\n        }\n    }\n}\n\n\n// Keydown controls\njSuites.dropdown.onkeydown = function(e) {\n    if (jSuites.dropdown.current) {\n        // Element\n        var element = jSuites.dropdown.current.dropdown;\n        // Index\n        var index = element.currentIndex;\n\n        if (e.shiftKey) {\n\n        } else {\n            if (e.which == 13 || e.which == 27 || e.which == 35 || e.which == 36 || e.which == 38 || e.which == 40) {\n                // Move cursor\n                if (e.which == 13) {\n                    element.selectIndex(index)\n                } else if (e.which == 38) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index > 0) {\n                        element.prev();\n                    }\n                } else if (e.which == 40) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index + 1 < element.options.data.length) {\n                        element.next();\n                    }\n                } else if (e.which == 36) {\n                    element.first();\n                } else if (e.which == 35) {\n                    element.last();\n                } else if (e.which == 27) {\n                    element.close();\n                }\n\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n}\n\njSuites.dropdown.extractFromDom = function(el, options) {\n    // Keep reference\n    var select = el;\n    if (! options) {\n        options = {};\n    }\n    // Prepare configuration\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\n        options.multiple = true;\n    }\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\n        options.placeholder = el.getAttribute('placeholder');\n    }\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\n        options.autocomplete = true;\n    }\n    if (! options || options.width == undefined) {\n        options.width = el.offsetWidth;\n    }\n    if (el.value && (! options || options.value == undefined)) {\n        options.value = el.value;\n    }\n    if (! options || options.data == undefined) {\n        options.data = [];\n        for (var j = 0; j < el.children.length; j++) {\n            if (el.children[j].tagName == 'OPTGROUP') {\n                for (var i = 0; i < el.children[j].children.length; i++) {\n                    options.data.push({\n                        id: el.children[j].children[i].value,\n                        name: el.children[j].children[i].innerHTML,\n                        group: el.children[j].getAttribute('label'),\n                    });\n                }\n            } else {\n                options.data.push({\n                    id: el.children[j].value,\n                    name: el.children[j].innerHTML,\n                });\n            }\n        }\n    }\n    if (! options || options.onchange == undefined) {\n        options.onchange = function(a,b,c,d) {\n            if (options.multiple == true) {\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\n                    select.options[b].setAttribute('selected', 'selected');\n                } else {\n                    select.options[b].removeAttribute('selected');\n                }\n            } else {\n                select.value = d;\n            }\n        }\n    }\n    // Create DIV\n    var div = document.createElement('div');\n    el.parentNode.insertBefore(div, el);\n    el.style.display = 'none';\n    el = div;\n\n    return { el:el, options:options };\n}\r\n\r\n/**\n * (c) jTools Text Editor\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Inline richtext editor\n */\n\njSuites.editor = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        // Initial HTML content\n        value: null,\n        // Initial snippet\n        snippet: null,\n        // Add toolbar\n        toolbar: null,\n        // Max height\n        maxHeight: null,\n        // Website parser is to read websites and images from cross domain\n        remoteParser: null,\n        // Key from youtube to read properties from URL\n        youtubeKey: null,\n        // User list\n        userSearch: null,\n        // Parse URL\n        parseURL: false,\n        // Accept drop files\n        dropZone: true,\n        dropAsAttachment: false,\n        acceptImages: true,\n        acceptFiles: false,\n        maxFileSize: 5000000, \n        // Border\n        border: true,\n        padding: true,\n        focus: false,\n        // Events\n        onclick: null,\n        onfocus: null,\n        onblur: null,\n        onload: null,\n        onenter: null,\n        onkeyup: null,\n        onkeydown: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Private controllers\n    var imageResize = 0;\n    var editorTimer = null;\n    var editorAction = null;\n\n    // Make sure element is empty\n    el.innerHTML = '';\n\n    // Prepare container\n    el.classList.add('jeditor-container');\n\n    // Padding\n    if (obj.options.padding == true) {\n        el.classList.add('jeditor-padding');\n    }\n\n    // Border\n    if (obj.options.border == false) {\n        el.style.border = '0px';\n    }\n\n    // Snippet\n    var snippet = document.createElement('div');\n    snippet.className = 'snippet';\n    snippet.setAttribute('contenteditable', false);\n\n    // Toolbar\n    var toolbar = document.createElement('div');\n    toolbar.className = 'jeditor-toolbar';\n\n    // Create editor\n    var editor = document.createElement('div');\n    editor.setAttribute('contenteditable', true);\n    editor.setAttribute('spellcheck', false);\n    editor.className = 'jeditor';\n\n    // Max height\n    if (obj.options.maxHeight) {\n        editor.style.overflowY = 'auto';\n        editor.style.maxHeight = obj.options.maxHeight;\n    }\n\n    // Set editor initial value\n    if (obj.options.value) {\n        var value = obj.options.value;\n    } else {\n        var value = el.innerHTML ? el.innerHTML : ''; \n    }\n\n    if (! value) {\n        var value = '<br>';\n    }\n\n    /**\n     * Extract images from a HTML string\n     */\n    var extractImageFromHtml = function(html) {\n        // Create temp element\n        var div = document.createElement('div');\n        div.innerHTML = html;\n\n        // Extract images\n        var img = div.querySelectorAll('img');\n\n        if (img.length) {\n            for (var i = 0; i < img.length; i++) {\n                obj.addImage(img[i].src);\n            }\n        }\n    }\n\n    /**\n     * Insert node at caret\n     */\n    var insertNodeAtCaret = function(newNode) {\n        var sel, range;\n\n        if (window.getSelection) {\n            sel = window.getSelection();\n            if (sel.rangeCount) {\n                range = sel.getRangeAt(0);\n                var selectedText = range.toString();\n                range.deleteContents();\n                range.insertNode(newNode); \n                // move the cursor after element\n                range.setStartAfter(newNode);\n                range.setEndAfter(newNode); \n                sel.removeAllRanges();\n                sel.addRange(range);\n            }\n        }\n    }\n\n    /**\n     * Append snippet or thumbs in the editor\n     * @Param object data\n     */\n    var appendElement = function(data) {\n        // Reset snippet\n        snippet.innerHTML = '';\n\n        if (data.image) {\n            var div = document.createElement('div');\n            div.className = 'snippet-image';\n            div.setAttribute('data-k', 'image');\n            snippet.appendChild(div);\n\n            var image = document.createElement('img');\n            image.src = data.image;\n            div.appendChild(image);\n        }\n\n        var div = document.createElement('div');\n        div.className = 'snippet-title';\n        div.setAttribute('data-k', 'title');\n        div.innerHTML = data.title;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-description';\n        div.setAttribute('data-k', 'description');\n        div.innerHTML = data.description;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-host';\n        div.setAttribute('data-k', 'host');\n        div.innerHTML = data.host;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-url';\n        div.setAttribute('data-k', 'url');\n        div.innerHTML = data.url;\n        snippet.appendChild(div);\n\n        editor.appendChild(snippet);\n    }\n\n    var verifyEditor = function() {\n        clearTimeout(editorTimer);\n        editorTimer = setTimeout(function() {\n            var snippet = editor.querySelector('.snippet');\n            var thumbsContainer = el.querySelector('.jeditor-thumbs-container');\n\n            if (! snippet && ! thumbsContainer) {\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\n                var container = document.createElement('div');\n                container.innerHTML = html;\n                var thumbsContainer = container.querySelector('.jeditor-thumbs-container');\n                if (thumbsContainer) {\n                    thumbsContainer.remove();\n                }\n                var text = container.innerText; \n                var url = jSuites.editor.detectUrl(text);\n\n                if (url) {\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\n                        if (jSuites.editor.getDomain(url[0]) == window.location.hostname) {\n                            obj.importImage(url[0], '');\n                        } else {\n                            obj.importImage(obj.options.remoteParser + url[0], '');\n                        }\n                    } else {\n                        var id = jSuites.editor.youtubeParser(url[0]);\n\n                        if (id) {\n                            obj.getYoutube(id);\n                        } else {\n                            obj.getWebsite(url[0]);\n                        }\n                    }\n                }\n            }\n        }, 1000);\n    }\n\n    obj.parseContent = function() {\n        verifyEditor();\n    }\n\n    /**\n     * Get metadata from a youtube video\n     */\n    obj.getYoutube = function(id) {\n        if (! obj.options.youtubeKey) {\n            console.error('The youtubeKey is not defined');\n        } else {\n            jSuites.ajax({\n                url: 'https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&key=' + obj.options.youtubeKey + '&id=' + id,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Only valid elements to be appended\n                    if (result.items && result.items[0]) {\n                        var p = {\n                            title: '',\n                            description: '',\n                            image: '',\n                            host: 'www.youtube.com',\n                            url: 'https://www.youtube.com?watch=' + id,\n                        }\n                        if (result.items[0].snippet.title) {\n                            p.title = result.items[0].snippet.title;\n                        }\n                        if (result.items[0].snippet.description) {\n                            p.description = result.items[0].snippet.description;\n\n                            if (p.description.length > 150) {\n                                p.description = p.description.substr(0, 150) + '...';\n                            }\n                        }\n                        if (result.items[0].snippet.thumbnails.medium.url) {\n                            p.image = result.items[0].snippet.thumbnails.medium.url;\n                        }\n\n                        appendElement(p);\n                    }\n                }\n            });\n        }\n    }\n\n    /**\n     * Get meta information from a website\n     */\n    obj.getWebsite = function(url) {\n        if (! obj.options.remoteParser) {\n            console.log('The remoteParser is not defined');\n        } else {\n            jSuites.ajax({\n                url: obj.options.remoteParser + encodeURI(url.trim()),\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    var p = {\n                        title: '',\n                        description: '',\n                        image: '',\n                        host: url,\n                        url: url,\n                    }\n\n                    if (result.title) {\n                        p.title = result.title;\n                    }\n                    if (result.description) {\n                        p.description = result.description;\n                    }\n                    if (result.image) {\n                        p.image = result.image;\n                    } else if (result['og:image']) {\n                        p.image = result['og:image'];\n                    }\n                    if (result.host) {\n                        p.host = result.host;\n                    }\n                    if (result.url) {\n                        p.url = result.url;\n                    }\n\n                    appendElement(p);\n                }\n            });\n        }\n    }\n\n    /**\n     * Set editor value\n     */\n    obj.setData = function(html) {\n        editor.innerHTML = html;\n        cursor();\n    }\n\n    /**\n     * Get editor data\n     */\n    obj.getData = function(json) {\n        if (! json) {\n            var data = editor.innerHTML;\n        } else {\n            var data = {\n                content : '',\n            }\n\n            // Get tag users\n            var tagged = editor.querySelectorAll('.post-tag');\n            if (tagged.length) {\n                data.users = [];\n                for (var i = 0; i < tagged.length; i++) {\n                    var userId = tagged[i].getAttribute('data-user');\n                    if (userId) {\n                        data.users.push(userId);\n                    }\n                }\n                data.users = data.users.join(',');\n            }\n\n            if (snippet.innerHTML) {\n                var index = 0;\n                data.snippet = {};\n                for (var i = 0; i < snippet.children.length; i++) {\n                    // Get key from element\n                    var key = snippet.children[i].getAttribute('data-k');\n                    if (key) {\n                        if (key == 'image') {\n                            data.snippet.image = snippet.children[i].children[0].getAttribute('src');\n                        } else {\n                            data.snippet[key] = snippet.children[i].innerHTML;\n                        }\n                    }\n                }\n\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n\n            var text = editor.innerHTML;\n            text = text.replace(/<br>/g, \"\\n\");\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\n            data.content = text.trim();\n            data = JSON.stringify(data);\n        }\n\n        return data;\n    }\n\n    // Reset\n    obj.reset = function() {\n        editor.innerHTML = '';\n    }\n\n    obj.addPdf = function(data) {\n        if (data.result.substr(0,4) != 'data') {\n            console.error('Invalid source');\n        } else {\n            var canvas = document.createElement('canvas');\n            canvas.width = 60;\n            canvas.height = 60;\n\n            var img = new Image();\n            var ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n            canvas.toBlob(function(blob) {\n                var newImage = document.createElement('img');\n                newImage.src = window.URL.createObjectURL(blob);\n                newImage.setAttribute('data-extension', 'pdf');\n                if (data.name) {\n                    newImage.setAttribute('data-name', data.name);\n                }\n                if (data.size) {\n                    newImage.setAttribute('data-size', data.size);\n                }\n                if (data.date) {\n                    newImage.setAttribute('data-date', data.date);\n                }\n                newImage.className = 'jfile pdf';\n\n                insertNodeAtCaret(newImage);\n                jSuites.files[newImage.src] = data.result.substr(data.result.indexOf(',') + 1);\n            });\n        }\n    }\n\n    obj.addImage = function(src, name, size, date) {\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\n            console.error('remoteParser not defined in your initialization');\n        } else {\n            // This is to process cross domain images\n            if (src.substr(0,4) == 'data') {\n                var extension = src.split(';')\n                extension = extension[0].split('/');\n                extension = extension[1];\n            } else {\n                var extension = src.substr(src.lastIndexOf('.') + 1);\n                // Work for cross browsers\n                src = obj.options.remoteParser + src;\n            }\n\n            var img = new Image();\n\n            img.onload = function onload() {\n                var canvas = document.createElement('canvas');\n                canvas.width = img.width;\n                canvas.height = img.height;\n\n                var ctx = canvas.getContext('2d');\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n                canvas.toBlob(function(blob) {\n                    var newImage = document.createElement('img');\n                    newImage.src = window.URL.createObjectURL(blob);\n                    newImage.setAttribute('tabindex', '900');\n                    newImage.setAttribute('data-extension', extension);\n                    if (name) {\n                        newImage.setAttribute('data-name', name);\n                    }\n                    if (size) {\n                        newImage.setAttribute('data-size', size);\n                    }\n                    if (date) {\n                        newImage.setAttribute('data-date', date);\n                    }\n                    newImage.className = 'jfile';\n                    var content = canvas.toDataURL();\n                    insertNodeAtCaret(newImage);\n\n                    jSuites.files[newImage.src] = content.substr(content.indexOf(',') + 1);\n                });\n            };\n\n            img.src = src;\n        }\n    }\n\n    obj.addFile = function(files) {\n        var reader = [];\n\n        for (var i = 0; i < files.length; i++) {\n            if (files[i].size > obj.options.maxFileSize) {\n                alert('The file is too big');\n            } else {\n                // Only PDF or Images\n                var type = files[i].type.split('/');\n\n                if (type[0] == 'image') {\n                    type = 1;\n                } else if (type[1] == 'pdf') {\n                    type = 2;\n                } else {\n                    type = 0;\n                }\n\n                if (type) {\n                    // Create file\n                    reader[i] = new FileReader();\n                    reader[i].index = i;\n                    reader[i].type = type;\n                    reader[i].name = files[i].name;\n                    reader[i].date = files[i].lastModified;\n                    reader[i].size = files[i].size;\n                    reader[i].addEventListener(\"load\", function (data) {\n                        // Get result\n                        if (data.target.type == 2) {\n                            if (obj.options.acceptFiles == true) {\n                                obj.addPdf(data.target);\n                            }\n                        } else {\n                            obj.addImage(data.target.result, data.target.name, data.total, data.target.lastModified);\n                        }\n                    }, false);\n\n                    reader[i].readAsDataURL(files[i])\n                } else {\n                    alert('The extension is not allowed');\n                }\n            }\n        }\n    }\n\n    // Destroy\n    obj.destroy = function() {\n        editor.removeEventListener('mouseup', editorMouseUp);\n        editor.removeEventListener('mousedown', editorMouseDown);\n        editor.removeEventListener('mousemove', editorMouseMove);\n        editor.removeEventListener('keyup', editorKeyUp);\n        editor.removeEventListener('keydown', editorKeyDown);\n        editor.removeEventListener('dragstart', editorDragStart);\n        editor.removeEventListener('dragenter', editorDragEnter);\n        editor.removeEventListener('dragover', editorDragOver);\n        editor.removeEventListener('drop', editorDrop);\n        editor.removeEventListener('paste', editorPaste);\n\n        if (typeof(obj.options.onblur) == 'function') {\n            editor.removeEventListener('blur', editorBlur);\n        }\n        if (typeof(obj.options.onfocus) == 'function') {\n            editor.removeEventListener('focus', editorFocus);\n        }\n\n        el.editor = null;\n        el.classList.remove('jeditor-container');\n\n        toolbar.remove();\n        snippet.remove();\n        editor.remove();\n    }\n\n    var isLetter = function (str) {\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\n        return str.match(regex) ? 1 : 0;\n    }\n\n    // Event handlers\n    var editorMouseUp = function(e) {\n        editorAction = false;\n    }\n\n    var editorMouseDown = function(e) {\n        var close = function(snippet) {\n            var rect = snippet.getBoundingClientRect();\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n        }\n\n        if (e.target.tagName == 'IMG') {\n            if (e.target.style.cursor) {\n                var rect = e.target.getBoundingClientRect();\n                editorAction = {\n                    e: e.target,\n                    x: e.clientX,\n                    y: e.clientY,\n                    w: rect.width,\n                    h: rect.height,\n                    d: e.target.style.cursor,\n                }\n\n                if (! e.target.style.width) {\n                    e.target.style.width = rect.width + 'px';\n                }\n\n                if (! e.target.style.height) {\n                    e.target.style.height = rect.height + 'px';\n                }\n\n                var s = window.getSelection();\n                if (s.rangeCount) {\n                    for (var i = 0; i < s.rangeCount; i++) {\n                        s.removeRange(s.getRangeAt(i));\n                    }\n                }\n            } else {\n                editorAction = true;\n            }\n        } else { \n            if (e.target.classList.contains('snippet')) {\n                close(e.target);\n            } else if (e.target.parentNode.classList.contains('snippet')) {\n                close(e.target.parentNode);\n            }\n\n            editorAction = true;\n        }\n    }\n\n    var editorMouseMove = function(e) {\n        if (e.target.tagName == 'IMG') {\n            if (e.target.getAttribute('tabindex')) {\n                var rect = e.target.getBoundingClientRect();\n                if (e.clientY - rect.top < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'ne-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'nw-resize';\n                    } else {\n                        e.target.style.cursor = 'n-resize';\n                    }\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'se-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'sw-resize';\n                    } else {\n                        e.target.style.cursor = 's-resize';\n                    }\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\n                    e.target.style.cursor = 'e-resize';\n                } else if (e.clientX - rect.left < 5) {\n                    e.target.style.cursor = 'w-resize';\n                } else {\n                    e.target.style.cursor = '';\n                }\n            }\n        }\n\n        // Move\n        if (e.which == 1 && editorAction && editorAction.d) {\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\n                editorAction.e.style.width = (editorAction.w + (e.clientX - editorAction.x)) + 'px';\n\n                if (e.shiftKey) {\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\n                    editorAction.e.style.height = editorAction.h + newHeight + 'px';\n                } else {\n                    var newHeight =  null;\n                }\n            }\n\n            if (! newHeight) {\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\n                    if (! e.shiftKey) {\n                        editorAction.e.style.height = editorAction.h + (e.clientY - editorAction.y);\n                    }\n                }\n            }\n        }\n    }\n\n    var editorKeyUp = function(e) {\n        if (! editor.innerHTML) {\n            editor.innerHTML = '<div><br></div>';\n        }\n\n        if (typeof(obj.options.onkeyup) == 'function') { \n            obj.options.onkeyup(e, el);\n        }\n    }\n\n\n    var editorKeyDown = function(e) {\n        // Check for URL\n        if (obj.options.parseURL == true) {\n            verifyEditor();\n        }\n\n        // Closable\n        if (typeof(obj.options.onenter) == 'function' && e.which == 13) {\n            var data = obj.getData();\n            obj.options.onenter(obj, el, data, e);\n        }\n\n        if (typeof(obj.options.onkeydown) == 'function') { \n            obj.options.onkeydown(e, el);\n        }\n    }\n\n    var editorPaste = function(e) {\n        if (e.clipboardData || e.originalEvent.clipboardData) {\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\n            var file = (e.originalEvent || e).clipboardData.files\n        } else if (window.clipboardData) {\n            var html = window.clipboardData.getData('Html');\n            var text = window.clipboardData.getData('Text');\n            var file = window.clipboardData.files\n        }\n\n        if (file.length) {\n            // Paste a image from the clipboard\n            obj.addFile(file);\n        } else {\n            // Paste text\n            text = text.split('\\r\\n');\n            var str = '';\n            if (e.target.nodeName == 'DIV' && ! e.target.classList.contains('jeditor')) {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += text[i] + \"<br>\\r\\n\";\n                    }\n                }\n            } else {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += '<div>' + text[i] + '</div>';\n                    } else {\n                        str += '<div><br></div>';\n                    }\n                }\n            }\n            // Insert text\n            document.execCommand('insertHtml', false, str);\n\n            // Extra images from the paste\n            if (obj.options.acceptImages == true) {\n                extractImageFromHtml(html);\n            }\n        }\n\n        e.preventDefault();\n    }\n\n    var editorDragStart = function(e) {\n        if (editorAction && editorAction.e) {\n            e.preventDefault();\n        }\n    }\n\n    var editorDragEnter = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            el.classList.add('jeditor-dragging');\n        }\n    }\n\n    var editorDragOver = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            if (editorTimer) {\n                clearTimeout(editorTimer);\n            }\n\n            editorTimer = setTimeout(function() {\n                el.classList.remove('jeditor-dragging');\n            }, 100);\n        }\n    }\n\n    var editorDrop = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            // Position caret on the drop\n            var range = null;\n            if (document.caretRangeFromPoint) {\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\n            } else if (e.rangeParent) {\n                range=document.createRange();\n                range.setStart(e.rangeParent,e.rangeOffset);\n            }\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n            sel.anchorNode.parentNode.focus();\n\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\n            var file = (e.originalEvent || e).dataTransfer.files;\n    \n            if (file.length) {\n                obj.addFile(file);\n            } else if (text) {\n                extractImageFromHtml(html);\n            }\n\n            el.classList.remove('jeditor-dragging');\n            e.preventDefault();\n        }\n    }\n\n    var editorBlur = function() {\n        obj.options.onblur(obj, el, obj.getData());\n    }\n\n    var editorFocus = function() {\n        obj.options.onfocus(obj, el, obj.getData());\n    }\n\n    editor.addEventListener('mouseup', editorMouseUp);\n    editor.addEventListener('mousedown', editorMouseDown);\n    editor.addEventListener('mousemove', editorMouseMove);\n    editor.addEventListener('keyup', editorKeyUp);\n    editor.addEventListener('keydown', editorKeyDown);\n    editor.addEventListener('dragstart', editorDragStart);\n    editor.addEventListener('dragenter', editorDragEnter);\n    editor.addEventListener('dragover', editorDragOver);\n    editor.addEventListener('drop', editorDrop);\n    editor.addEventListener('paste', editorPaste);\n\n    // Blur\n    if (typeof(obj.options.onblur) == 'function') {\n        editor.addEventListener('blur', editorBlur);\n    }\n\n    // Focus\n    if (typeof(obj.options.onfocus) == 'function') {\n        editor.addEventListener('focus', editorFocus);\n    }\n\n    // Onload\n    if (typeof(obj.options.onload) == 'function') {\n        obj.options.onload(el, editor);\n    }\n\n    // Set value to the editor\n    editor.innerHTML = value;\n\n    // Append editor to the containre\n    el.appendChild(editor);\n\n    // Snippet\n    if (obj.options.snippet) {\n        appendElement(obj.options.snippet);\n    }\n\n    // Default toolbar\n    if (obj.options.toolbar == null) {\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\n    }\n\n    // Add toolbar\n    if (obj.options.toolbar) {\n        for (var i = 0; i < obj.options.toolbar.length; i++) {\n            if (obj.options.toolbar[i].icon) {\n                var item = document.createElement('div');\n                item.style.userSelect = 'none';\n                var itemIcon = document.createElement('i');\n                itemIcon.className = 'material-icons';\n                itemIcon.innerHTML = obj.options.toolbar[i].icon;\n                itemIcon.onclick = (function (a) {\n                    var b = a;\n                    return function () {\n                        obj.options.toolbar[b].onclick(el, obj, this)\n                    };\n                })(i);\n                item.appendChild(itemIcon);\n                toolbar.appendChild(item);\n            } else {\n                if (obj.options.toolbar[i].type == 'divisor') {\n                    var item = document.createElement('div');\n                    item.className = 'jeditor-toolbar-divisor';\n                    toolbar.appendChild(item);\n                } else if (obj.options.toolbar[i].type == 'button') {\n                    var item = document.createElement('div');\n                    item.classList.add('jeditor-toolbar-button');\n                    item.innerHTML = obj.options.toolbar[i].value;\n                    toolbar.appendChild(item);\n                }\n            }\n        }\n\n        el.appendChild(toolbar);\n    }\n\n    // Focus to the editor\n    if (obj.options.focus) {\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\n    }\n\n    el.editor = obj;\n\n    return obj;\n});\n\njSuites.editor.setCursor = function(element, first) {\n    element.focus();\n    document.execCommand('selectAll');\n    var sel = window.getSelection();\n    var range = sel.getRangeAt(0);\n    if (first == true) {\n        var node = range.startContainer;\n        var size = 0;\n    } else {\n        var node = range.endContainer;\n        var size = node.length;\n    }\n    range.setStart(node, size);\n    range.setEnd(node, size);\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\njSuites.editor.getDomain = function(url) {\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\n}\n\njSuites.editor.detectUrl = function(text) {\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\n    var links = text.match(expression);\n\n    if (links) {\n        if (links[0].substr(0,3) == 'www') {\n            links[0] = 'http://' + links[0];\n        }\n    }\n\n    return links;\n}\n\njSuites.editor.youtubeParser = function(url) {\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\n    var match = url.match(regExp);\n\n    return (match && match[7].length == 11) ? match[7] : false;\n}\n\njSuites.editor.getDefaultToolbar = function() { \n    return [\n        {\n            icon:'undo',\n            onclick: function() {\n                document.execCommand('undo');\n            }\n        },\n        {\n            icon:'redo',\n            onclick: function() {\n                document.execCommand('redo');\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_bold',\n            onclick: function(a,b,c) {\n                document.execCommand('bold');\n\n                if (document.queryCommandState(\"bold\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_italic',\n            onclick: function(a,b,c) {\n                document.execCommand('italic');\n\n                if (document.queryCommandState(\"italic\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_underline',\n            onclick: function(a,b,c) {\n                document.execCommand('underline');\n\n                if (document.queryCommandState(\"underline\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function(a,b,c) {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_numbered',\n            onclick: function(a,b,c) {\n                document.execCommand('insertOrderedList');\n\n                if (document.queryCommandState(\"insertOrderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_increase',\n            onclick: function(a,b,c) {\n                document.execCommand('indent', true, null);\n\n                if (document.queryCommandState(\"indent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_decrease',\n            onclick: function(a,b,c) {\n                document.execCommand('outdent');\n\n                if (document.queryCommandState(\"outdent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        }\n        /*{\n            type:'select',\n            items: ['Verdana','Arial','Courier New'],\n            onchange: function() {\n            }\n        },\n        {\n            type:'select',\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\n            onchange: function() {\n            }\n        },\n        {\n            icon:'format_align_left',\n            onclick: function() {\n                document.execCommand('JustifyLeft');\n\n                if (document.queryCommandState(\"JustifyLeft\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_center',\n            onclick: function() {\n                document.execCommand('justifyCenter');\n\n                if (document.queryCommandState(\"justifyCenter\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_right',\n            onclick: function() {\n                document.execCommand('justifyRight');\n\n                if (document.queryCommandState(\"justifyRight\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_justify',\n            onclick: function() {\n                document.execCommand('justifyFull');\n\n                if (document.queryCommandState(\"justifyFull\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function() {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        }*/\n    ];\n}\n\r\n\r\njSuites.image = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        minWidth: false,\r\n        onchange: null,\r\n        singleFile: true,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n            imageTooSmall:'The resolution is too low, try a image with a better resolution. width > 800px',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    // Add image\r\n    obj.addImage = function(file) {\r\n        if (! file.date) {\r\n            file.date = '';\r\n        }\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-date', file.lastmodified ? file.lastmodified : file.date);\r\n        img.setAttribute('data-name', file.name);\r\n        img.setAttribute('data-size', file.size);\r\n        img.setAttribute('data-small', file.small ? file.small : '');\r\n        img.setAttribute('data-cover', file.cover ? 1 : 0);\r\n        img.setAttribute('data-extension', file.extension);\r\n        img.setAttribute('src', file.file);\r\n        img.className = 'jfile';\r\n        img.style.width = '100%';\r\n\r\n        return img;\r\n    }\r\n\r\n    // Add image\r\n    obj.addImages = function(files) {\r\n        if (obj.options.singleFile == true) {\r\n            el.innerHTML = '';\r\n        }\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            el.appendChild(obj.addImage(files[i]));\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == 'image') {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            var imageFile = new FileReader();\r\n            imageFile.addEventListener(\"load\", function (v) {\r\n\r\n                var img = new Image();\r\n\r\n                img.onload = function onload() {\r\n                    var canvas = document.createElement('canvas');\r\n                    canvas.width = img.width;\r\n                    canvas.height = img.height;\r\n\r\n                    var ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                    var data = {\r\n                        file: canvas.toDataURL(),\r\n                        extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                        name: file.name,\r\n                        size: file.size,\r\n                        lastmodified: file.lastModified,\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                };\r\n\r\n                img.src = v.srcElement.result;\r\n            });\r\n\r\n            imageFile.readAsDataURL(file);\r\n        } else {\r\n            alert(text.extentionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var data = {\r\n                        file: window.URL.createObjectURL(blob),\r\n                        extension: extension\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Keep base64 ready to go\r\n                    var content = canvas.toDataURL();\r\n                    jSuites.files[data.file] = content.substr(content.indexOf(',') + 1);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    var attachmentInput = document.createElement('input');\r\n    attachmentInput.type = 'file';\r\n    attachmentInput.setAttribute('accept', 'image/*');\r\n    attachmentInput.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(attachmentInput);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jLoading\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Page loading spin\n */\n\njSuites.loading = (function() {\n    var obj = {};\n\n    var loading = document.createElement('div');\n    loading.className = 'jloading';\n\n    obj.show = function() {\n        document.body.appendChild(loading);\n    };\n\n    obj.hide = function() {\n        document.body.removeChild(loading);\n    };\n\n    return obj;\n})();\r\n\r\n/**\n * (c) jLogin\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Login helper\n */\n\njSuites.login = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        url: window.location.href,\n        prepareRequest: null,\n        accessToken: null,\n        deviceToken: null,\n        facebookUrl: null,\n        facebookAuthentication: null,\n        maxHeight: null,\n        onload: null,\n        onsuccess: null,\n        onerror: null,\n        message: null,\n        logo: null,\n        newProfile: false,\n        newProfileUrl: false,\n        newProfileLogin: false,\n        fullscreen: false,\n        newPasswordValidation: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Message console container\n    if (! obj.options.message) {\n        var messageElement = document.querySelector('.message');\n        if (messageElement) {\n            obj.options.message = messageElement;\n        }\n    }\n\n    // Action\n    var action = null;\n\n    // Container\n    var container = document.createElement('form');\n    el.appendChild(container);\n\n    // Logo\n    var divLogo = document.createElement('div');\n    divLogo.className = 'jlogin-logo'\n    container.appendChild(divLogo);\n\n    if (obj.options.logo) {\n        var logo = document.createElement('img');\n        logo.src = obj.options.logo;\n        divLogo.appendChild(logo);\n    }\n\n    // Code\n    var labelCode = document.createElement('label');\n    labelCode.innerHTML = 'Please enter here the code received';\n    var inputCode = document.createElement('input');\n    inputCode.type = 'number';\n    inputCode.id = 'code';\n    inputCode.setAttribute('maxlength', 6);\n    var divCode = document.createElement('div');\n    divCode.appendChild(labelCode);\n    divCode.appendChild(inputCode);\n\n    // Hash\n    var inputHash = document.createElement('input');\n    inputHash.type = 'hidden';\n    inputHash.name = 'h';\n    var divHash = document.createElement('div');\n    divHash.appendChild(inputHash);\n\n    // Recovery\n    var inputRecovery = document.createElement('input');\n    inputRecovery.type = 'hidden';\n    inputRecovery.name = 'recovery';\n    inputRecovery.value = '1';\n    var divRecovery = document.createElement('div');\n    divRecovery.appendChild(inputRecovery);\n\n    // Login\n    var labelLogin = document.createElement('label');\n    labelLogin.innerHTML = 'Login';\n    var inputLogin = document.createElement('input');\n    inputLogin.type = 'text';\n    inputLogin.name = 'login';\n    inputLogin.setAttribute('autocomplete', 'off');\n    inputLogin.onkeyup = function() {\n        this.value = this.value.toLowerCase().replace(/[^a-zA-Z0-9_+]+/gi, '');\n    } \n    var divLogin = document.createElement('div');\n    divLogin.appendChild(labelLogin);\n    divLogin.appendChild(inputLogin);\n\n    // Name\n    var labelName = document.createElement('label');\n    labelName.innerHTML = 'Name';\n    var inputName = document.createElement('input');\n    inputName.type = 'text';\n    inputName.name = 'name';\n    var divName = document.createElement('div');\n    divName.appendChild(labelName);\n    divName.appendChild(inputName);\n\n    // Email\n    var labelUsername = document.createElement('label');\n    labelUsername.innerHTML = 'E-mail';\n    var inputUsername = document.createElement('input');\n    inputUsername.type = 'text';\n    inputUsername.name = 'username';\n    inputUsername.setAttribute('autocomplete', 'new-username');\n    var divUsername = document.createElement('div');\n    divUsername.appendChild(labelUsername);\n    divUsername.appendChild(inputUsername);\n\n    // Password\n    var labelPassword = document.createElement('label');\n    labelPassword.innerHTML = 'New password';\n    var inputPassword = document.createElement('input');\n    inputPassword.type = 'password';\n    inputPassword.name = 'password';\n    inputPassword.setAttribute('autocomplete', 'new-password');\n    var divPassword = document.createElement('div');\n    divPassword.appendChild(labelPassword);\n    divPassword.appendChild(inputPassword);\n    divPassword.onkeydown = function(e) {\n        if (e.keyCode == 13) {\n            obj.execute();\n        }\n    }\n\n    // Repeat password\n    var labelRepeatPassword = document.createElement('label');\n    labelRepeatPassword.innerHTML = 'Repeat the new password';\n    var inputRepeatPassword = document.createElement('input');\n    inputRepeatPassword.type = 'password';\n    inputRepeatPassword.name = 'password';\n    var divRepeatPassword = document.createElement('div');\n    divRepeatPassword.appendChild(labelRepeatPassword);\n    divRepeatPassword.appendChild(inputRepeatPassword);\n\n    // Remember checkbox\n    var labelRemember = document.createElement('label');\n    labelRemember.innerHTML = 'Remember me on this device';\n    var inputRemember = document.createElement('input');\n    inputRemember.type = 'checkbox';\n    inputRemember.name = 'remember';\n    inputRemember.value = '1';\n    labelRemember.appendChild(inputRemember);\n    var divRememberButton = document.createElement('div');\n    divRememberButton.className = 'rememberButton';\n    divRememberButton.appendChild(labelRemember);\n\n    // Login button\n    var actionButton = document.createElement('input');\n    actionButton.type = 'button';\n    actionButton.value = 'Log In';\n    actionButton.onclick = function() {\n        obj.execute();\n    }\n    var divActionButton = document.createElement('div');\n    divActionButton.appendChild(actionButton);\n\n    // Cancel button\n    var cancelButton = document.createElement('div');\n    cancelButton.innerHTML = 'Cancel';\n    cancelButton.className = 'cancelButton';\n    cancelButton.onclick = function() {\n        obj.requestAccess();\n    }\n    var divCancelButton = document.createElement('div');\n    divCancelButton.appendChild(cancelButton);\n\n    // Captcha\n    var labelCaptcha = document.createElement('label');\n    labelCaptcha.innerHTML = 'Please type here the code below';\n    var inputCaptcha = document.createElement('input');\n    inputCaptcha.type = 'text';\n    inputCaptcha.name = 'captcha';\n    var imageCaptcha = document.createElement('img');\n    var divCaptcha = document.createElement('div');\n    divCaptcha.className = 'jlogin-captcha';\n    divCaptcha.appendChild(labelCaptcha);\n    divCaptcha.appendChild(inputCaptcha);\n    divCaptcha.appendChild(imageCaptcha);\n\n    // Facebook\n    var facebookButton = document.createElement('div');\n    facebookButton.innerHTML = 'Login with Facebook';\n    facebookButton.className = 'facebookButton';\n    var divFacebookButton = document.createElement('div');\n    divFacebookButton.appendChild(facebookButton);\n    divFacebookButton.onclick = function() {\n        obj.requestLoginViaFacebook();\n    }\n    // Forgot password\n    var inputRequest = document.createElement('span');\n    inputRequest.innerHTML = 'Request a new password';\n    var divRequestButton = document.createElement('div');\n    divRequestButton.className = 'requestButton';\n    divRequestButton.appendChild(inputRequest);\n    divRequestButton.onclick = function() {\n        obj.requestNewPassword();\n    }\n    // Create a new Profile\n    var inputNewProfile = document.createElement('span');\n    inputNewProfile.innerHTML = 'Create a new profile';\n    var divNewProfileButton = document.createElement('div');\n    divNewProfileButton.className = 'newProfileButton';\n    divNewProfileButton.appendChild(inputNewProfile);\n    divNewProfileButton.onclick = function() {\n        obj.newProfile();\n    }\n\n    el.className = 'jlogin';\n\n    if (obj.options.fullscreen == true) {\n        el.classList.add('jlogin-fullscreen');\n    }\n\n    /** \n     * Show message\n     */\n    obj.showMessage = function(data) {\n        var message = (typeof(data) == 'object') ? data.message : data;\n\n        if (typeof(obj.options.showMessage) == 'function') {\n            obj.options.showMessage(data);\n        } else {\n            jSuites.alert(data);\n        }\n    }\n\n    /**\n     * New profile\n     */\n    obj.newProfile = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        if (obj.options.newProfileLogin) {\n            container.appendChild(divLogin);\n        }\n        container.appendChild(divName);\n        container.appendChild(divUsername);\n        container.appendChild(divActionButton);\n        if (obj.options.facebookAuthentication == true) {\n            container.appendChild(divFacebookButton);\n        }\n        container.appendChild(divCancelButton);\n\n        // Reset inputs\n        inputLogin.value = '';\n        inputUsername.value = '';\n        inputPassword.value = '';\n\n        // Button\n        actionButton.value = 'Create new profile';\n\n        // Action\n        action = 'newProfile';\n    }\n\n    /**\n     * Request the email with the recovery instructions\n     */\n    obj.requestNewPassword = function() {\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            var captcha = true;\n        }\n\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divRecovery);\n        container.appendChild(divUsername);\n        if (captcha) {\n            container.appendChild(divCaptcha);\n        }\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Request a new password';\n        inputRecovery.value = 1;\n\n        // Action\n        action = 'requestNewPassword';\n    }\n\n    /**\n     * Confirm recovery code\n     */\n    obj.codeConfirmation = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divCode);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Confirm code';\n        inputRecovery.value = 2;\n\n        // Action\n        action = 'codeConfirmation';\n    }\n\n    /**\n     * Update my password\n     */\n    obj.changeMyPassword = function(hash) {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divPassword);\n        container.appendChild(divRepeatPassword);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Change my password';\n        inputHash.value = hash;\n\n        // Action\n        action = 'changeMyPassword';\n    }\n\n    /**\n     * Request access default method\n     */\n    obj.requestAccess = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divUsername);\n        container.appendChild(divPassword);\n        container.appendChild(divActionButton);\n        if (obj.options.facebookAuthentication == true) {\n            container.appendChild(divFacebookButton);\n        }\n        container.appendChild(divRequestButton);\n        container.appendChild(divRememberButton);\n        container.appendChild(divRequestButton);\n        if (obj.options.newProfile == true) {\n            container.appendChild(divNewProfileButton);\n        }\n\n        // Button\n        actionButton.value = 'Login';\n\n        // Password\n        inputPassword.value = '';\n\n        // Email persistence\n        if (window.localStorage.getItem('username')) {\n            inputUsername.value = window.localStorage.getItem('username');\n            inputPassword.focus();\n        } else {\n            inputUsername.focus();\n        }\n\n        // Action\n        action = 'requestAccess';\n    }\n\n    /**\n     * Request login via facebook\n     */\n    obj.requestLoginViaFacebook = function() {\n        if (typeof(deviceNotificationToken) == 'undefined') {\n            FB.getLoginStatus(function(response) {\n                if (! response.status || response.status != 'connected') {\n                    FB.login(function(response) {\n                        if (response.authResponse) {\n                            obj.execute({ f:response.authResponse.accessToken });\n                        } else {\n                            obj.showMessage('Not authorized by facebook');\n                        }\n                    }, {scope: 'public_profile,email'});\n                } else {\n                    obj.execute({ f:response.authResponse.accessToken });\n                }\n            }, true);\n        } else {\n            jDestroy = function() {\n                fbLogin.removeEventListener('loadstart', jStart);\n                fbLogin.removeEventListener('loaderror', jError);\n                fbLogin.removeEventListener('exit', jExit);\n                fbLogin.close();\n                fbLogin = null;\n            }\n\n            jStart = function(event) {\n                var url = event.url;\n                if (url.indexOf(\"access_token\") >= 0) {\n                    setTimeout(function(){\n                        var u = url.match(/=(.*?)&/);\n                        if (u[1].length > 32) {\n                            obj.execute({ f:u[1] });\n                        }\n                        jDestroy();\n                   },500);\n                }\n\n                if (url.indexOf(\"error=access_denied\") >= 0) {\n                   setTimeout(jDestroy ,500);\n                   // Not authorized by facebook\n                   obj.showMessage('Not authorized by facebook');\n                }\n            }\n\n            jError = function(event) {\n                jDestroy();\n            }\n        \n            jExit = function(event) {\n                jDestroy();\n            }\n\n            fbLogin = window.open(obj.options.facebookUrl, \"_blank\", \"location=no,closebuttoncaption=Exit,disallowoverscroll=yes,toolbar=no\");\n            fbLogin.addEventListener('loadstart', jStart);\n            fbLogin.addEventListener('loaderror', jError);\n            fbLogin.addEventListener('exit', jExit);\n        }\n\n        // Action\n        action = 'requestLoginViaFacebook';\n    }\n\n    // Perform request\n    obj.execute = function(data) {\n        // New profile\n        if (action == 'newProfile') {\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\n            if (! inputUsername.value || ! pattern.test(inputUsername.value)) {\n                var message = 'Invalid e-mail address'; \n            }\n\n            var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\n            if (! inputLogin.value || ! pattern.test(inputLogin.value)) {\n                var message = 'Invalid username, please use only characters and numbers';\n            }\n\n            if (message) {\n                obj.showMessage(message);\n                return false;\n            }\n        } else if (action == 'changeMyPassword') {\r\n            if (inputPassword.value.length < 3) {\r\n                var message = 'Password is too short';\r\n            } else  if (inputPassword.value != inputRepeatPassword.value) {\r\n                var message = 'Password should match';\r\n            } else {\r\n                if (typeof(obj.options.newPasswordValidation) == 'function') {\r\n                    var val = obj.options.newPasswordValidation(obj, inputPassword.value, inputPassword.value);\r\n                    if (val != undefined) {\r\n                        message = val;\r\n                    }\r\n                }\r\n            }\n\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        }\n\n        // Keep email\n        if (inputUsername.value != '') {\n            window.localStorage.setItem('username', inputUsername.value);\n        }\n\n        // Captcha\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            if (inputCaptcha.value == '') {\n                obj.showMessage('Please enter the captch code below');\n                return false;\n            }\n        }\n\n        // Url\n        var url = obj.options.url;\n\n        // Device token\n        if (obj.options.deviceToken) {\n            url += '?token=' + obj.options.deviceToken;\n        }\n\n        // Callback\n        var onsuccess = function(result) {\n            if (result) {\n                // Successfully response\n                if (result.success == 1) {\n                    // Recovery process\n                    if (action == 'requestNewPassword') {\n                        obj.codeConfirmation();\n                    } else if (action == 'codeConfirmation') {\n                        obj.requestAccess();\n                    } else if (action == 'newProfile') {\n                        obj.requestAccess();\n                        // New profile\n                        result.newProfile = true;\n                    }\n\n                    // Token\n                    if (result.token) {\n                        // Set token\n                        obj.options.accessToken = result.token;\n                        // Save token\n                        window.localStorage.setItem('Access-Token', result.token);\n                    }\n                }\n\n                // Show message\n                if (result.message) {\n                    // Show message\n                    obj.showMessage(result.message)\n                }\n\n                // Request captcha code\n                if (! result.data) {\n                    if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n                        divCaptcha.remove();\n                    }\n                } else {\n                    container.insertBefore(divCaptcha, divActionButton);\n                    imageCaptcha.setAttribute('src', 'data:image/png;base64,' + result.data);\n                }\n\n                // Give time to user see the message\n                if (result.hash) {\n                    // Change password\n                    obj.changeMyPassword(result.hash);\n                } else if (result.url) {\n                    // App initialization\n                    if (result.success == 1) {\n                        if (typeof(obj.options.onsuccess) == 'function') {\n                            obj.options.onsuccess(result);\n                        } else {\n                            if (result.message) {\n                                setTimeout(function() { window.location.href = result.url; }, 2000);\n                            } else {\n                                window.location.href = result.url;\n                            }\n                        }\n                    } else {\n                        if (typeof(obj.options.onerror) == 'function') {\n                            obj.options.onerror(result);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Password\n        if (! data) {\n            var data = jSuites.getFormElements(el);\n            // Encode passworfd\n            if (data.password) {\n                data.password = jSuites.login.sha512(data.password);\n            }\n            // Recovery code\n            if (Array.prototype.indexOf.call(container.children, divCode) >= 0 && inputCode.value) {\n                data.h = jSuites.login.sha512(inputCode.value);\n            }\n        }\n\n        // Loading\n        el.classList.add('jlogin-loading');\n\n        // Url\n        var url = (action == 'newProfile' && obj.options.newProfileUrl) ? obj.options.newProfileUrl : obj.options.url;\n\n        // Remote call\n        jSuites.ajax({\n            url: url,\n            method: 'POST',\n            dataType: 'json',\n            data: data,\n            success: function(result) {\n                // Remove loading\n                el.classList.remove('jlogin-loading');\n                // Callback\n                onsuccess(result);\n            },\n            error: function(result) {\n                // Error\n                el.classList.remove('jlogin-loading');\n\n                if (typeof(obj.options.onerror) == 'function') {\n                    obj.options.onerror(result);\n                }\n            }\n        });\n    }\n\n    var queryString = window.location.href.split('?');\r\n    if (queryString[1] && queryString[1].length == 130 && queryString[1].substr(0,2) == 'h=') {\r\n        obj.changeMyPassword(queryString[1].substr(2));\r\n    } else {\n        obj.requestAccess();\n    }\n\n    return obj;\n});\n\njSuites.login.sha512 = (function(str) {\n    function int64(msint_32, lsint_32) {\n        this.highOrder = msint_32;\n        this.lowOrder = lsint_32;\n    }\n\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\n\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\n\n    var W = new Array(64);\n    var a, b, c, d, e, f, g, h, i, j;\n    var T1, T2;\n    var charsize = 8;\n\n    function utf8_encode(str) {\n        return unescape(encodeURIComponent(str));\n    }\n\n    function str2binb(str) {\n        var bin = [];\n        var mask = (1 << charsize) - 1;\n        var len = str.length * charsize;\n    \n        for (var i = 0; i < len; i += charsize) {\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\n        }\n    \n        return bin;\n    }\n\n    function binb2hex(binarray) {\n        var hex_tab = \"0123456789abcdef\";\n        var str = \"\";\n        var length = binarray.length * 4;\n        var srcByte;\n\n        for (var i = 0; i < length; i += 1) {\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\n        }\n\n        return str;\n    }\n\n    function safe_add_2(x, y) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_4(a, b, c, d) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_5(a, b, c, d, e) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function maj(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\n        );\n    }\n\n    function ch(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\n        );\n    }\n\n    function rotr(x, n) {\n        if (n <= 32) {\n            return new int64(\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\n            );\n        }\n    }\n\n    function sigma0(x) {\n        var rotr28 = rotr(x, 28);\n        var rotr34 = rotr(x, 34);\n        var rotr39 = rotr(x, 39);\n\n        return new int64(\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\n        );\n    }\n\n    function sigma1(x) {\n        var rotr14 = rotr(x, 14);\n        var rotr18 = rotr(x, 18);\n        var rotr41 = rotr(x, 41);\n\n        return new int64(\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\n        );\n    }\n\n    function gamma0(x) {\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\n\n        return new int64(\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\n        );\n    }\n\n    function gamma1(x) {\n        var rotr19 = rotr(x, 19);\n        var rotr61 = rotr(x, 61);\n        var shr6 = shr(x, 6);\n\n        return new int64(\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\n        );\n    }\n\n    function shr(x, n) {\n        if (n <= 32) {\n            return new int64(\n                x.highOrder >>> n,\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n                0,\n                x.highOrder << (32 - n)\n            );\n        }\n    }\n\n    var str = utf8_encode(str);\n    var strlen = str.length*charsize;\n    str = str2binb(str);\n\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\n\n    for (var i = 0; i < str.length; i += 32) {\n        a = H[0];\n        b = H[1];\n        c = H[2];\n        d = H[3];\n        e = H[4];\n        f = H[5];\n        g = H[6];\n        h = H[7];\n\n        for (var j = 0; j < 80; j++) {\n            if (j < 16) {\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\n            } else {\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\n            }\n\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\n            h = g;\n            g = f;\n            f = e;\n            e = safe_add_2(d, T1);\n            d = c;\n            c = b;\n            b = a;\n            a = safe_add_2(T1, T2);\n        }\n\n        H[0] = safe_add_2(a, H[0]);\n        H[1] = safe_add_2(b, H[1]);\n        H[2] = safe_add_2(c, H[2]);\n        H[3] = safe_add_2(d, H[3]);\n        H[4] = safe_add_2(e, H[4]);\n        H[5] = safe_add_2(f, H[5]);\n        H[6] = safe_add_2(g, H[6]);\n        H[7] = safe_add_2(h, H[7]);\n    }\n\n    var binarray = [];\n    for (var i = 0; i < H.length; i++) {\n        binarray.push(H[i].highOrder);\n        binarray.push(H[i].lowOrder);\n    }\n\n    return binb2hex(binarray);\n});\r\n\r\n/**\r\n * (c) jTools Input Mask\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Input mask\r\n */\r\n\r\njSuites.mask = (function() {\r\n    var obj = {};\r\n    var index = 0;\r\n    var values = []\r\n    var pieces = [];\r\n\r\n    obj.run = function(value, mask, decimal) {\r\n        if (value && mask) {\r\n            if (! decimal) {\r\n                decimal = '.';\r\n            }\r\n            if (value == Number(value)) {\r\n                var number = (''+value).split('.');\r\n                var value = number[0];\r\n                var valueDecimal = number[1];\r\n            } else {\r\n                value = '' + value;\r\n            }\r\n            index = 0;\r\n            values = [];\r\n            // Create mask token\r\n            obj.prepare(mask);\r\n            // Current value\r\n            var currentValue = value;\r\n            if (currentValue) {\r\n                // Checking current value\r\n                for (var i = 0; i < currentValue.length; i++) {\r\n                    if (currentValue[i] != null) {\r\n                        obj.process(currentValue[i]);\r\n                    }\r\n                }\r\n            }\r\n            if (valueDecimal) {\r\n                obj.process(decimal);\r\n                var currentValue = valueDecimal;\r\n                if (currentValue) {\r\n                    // Checking current value\r\n                    for (var i = 0; i < currentValue.length; i++) {\r\n                        if (currentValue[i] != null) {\r\n                            obj.process(currentValue[i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Formatted value\r\n            return values.join('');\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    obj.apply = function(e) {\r\n        if (e.target && ! e.target.getAttribute('readonly')) {\r\n            var mask = e.target.getAttribute('data-mask');\r\n            if (mask && e.keyCode > 46) {\r\n                index = 0;\r\n                values = [];\r\n                // Create mask token\r\n                obj.prepare(mask);\r\n                // Current value\r\n                if (e.target.selectionStart < e.target.selectionEnd) {\r\n                    var currentValue = e.target.value.substring(0, e.target.selectionStart); \r\n                } else {\r\n                    var currentValue = e.target.value;\r\n                }\r\n                if (currentValue) {\r\n                    // Checking current value\r\n                    for (var i = 0; i < currentValue.length; i++) {\r\n                        if (currentValue[i] != null) {\r\n                            obj.process(currentValue[i]);\r\n                        }\r\n                    }\r\n                }\r\n                // New input\r\n                obj.process(obj.fromKeyCode(e));\r\n                // Update value to the element\r\n                e.target.value = values.join('');\r\n                if (pieces.length == values.length && pieces[pieces.length-1].length == values[values.length-1].length) {\r\n                    e.target.setAttribute('data-completed', 'true');\r\n                } else {\r\n                    e.target.setAttribute('data-completed', 'false');\r\n                }\r\n                // Prevent default\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Process inputs and save to values\r\n     */\r\n    obj.process = function(input) {\r\n        do {\r\n            if (pieces[index] == 'mm') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && values[index] < 2 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] == 0 && values[index] < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'dd') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 3 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 3 && parseInt(input) < 2) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 3 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh24') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 2 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 2 && parseInt(input) < 4) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 2 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 1 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'mi' || pieces[index] == 'ss') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 5 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                     } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'yy' || pieces[index] == 'yyyy') {\r\n                if (parseInt(input) < 10) {\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                    }\r\n                    \r\n                    if (values[index].length == pieces[index].length) {\r\n                        index++;\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '#' || pieces[index] == '#.##' || pieces[index] == '#,##' || pieces[index] == '# ##') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    if (pieces[index] == '#.##') {\r\n                        var separator = '.';\r\n                    } else if (pieces[index] == '#,##') {\r\n                        var separator = ',';\r\n                    } else if (pieces[index] == '# ##') {\r\n                        var separator = ' ';\r\n                    } else {\r\n                        var separator = '';\r\n                    }\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                        if (separator) {\r\n                            values[index] = values[index].match(/[0-9]/g).join('');\r\n                            var t = [];\r\n                            var s = 0;\r\n                            for (var j = values[index].length - 1; j >= 0 ; j--) {\r\n                                t.push(values[index][j]);\r\n                                s++;\r\n                                if (! (s % 3)) {\r\n                                    t.push(separator);\r\n                                }\r\n                            }\r\n                            t = t.reverse();\r\n                            values[index] = t.join('');\r\n                            if (values[index].substr(0,1) == separator) {\r\n                                values[index] = values[index].substr(1);\r\n                            } \r\n                        }\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    if (pieces[index] == '#.##' && input == '.') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '#,##' && input == ',') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '# ##' && input == ' ') {\r\n                        // Do nothing\r\n                    } else {\r\n                        if (values[index]) {\r\n                            index++;\r\n                            if (pieces[index]) {\r\n                                if (pieces[index] == input) {\r\n                                    values[index] = input;\r\n                                    return true;\r\n                                } else {\r\n                                    if (pieces[index] == '0' && pieces[index+1] == input) {\r\n                                        index++;\r\n                                        values[index] = input;\r\n                                        return true;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '0') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == 'a') {\r\n                if (input.match(/[a-zA-Z]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (pieces[index] != null) {\r\n                    if (pieces[index] == '\\\\a') {\r\n                        var v = 'a';\r\n                    } else if (pieces[index] == '\\\\0') {\r\n                        var v = '0';\r\n                    } else if (pieces[index] == '[-]') {\r\n                        if (input == '-' || input == '+') {\r\n                            var v = input;\r\n                        } else {\r\n                            var v = ' ';\r\n                        }\r\n                    } else {\r\n                        var v = pieces[index];\r\n                    }\r\n                    values[index] = v;\r\n                    if (input == v) {\r\n                        index++;\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            index++;\r\n        } while (pieces[index]);\r\n    }\r\n\r\n    /**\r\n     * Create tokens for the mask\r\n     */\r\n    obj.prepare = function(mask) {\r\n        pieces = [];\r\n        for (var i = 0; i < mask.length; i++) {\r\n            if (mask[i].match(/[0-9]|[a-z]|\\\\/g)) {\r\n                if (mask[i] == 'y' && mask[i+1] == 'y' && mask[i+2] == 'y' && mask[i+3] == 'y') {\r\n                    pieces.push('yyyy');\r\n                    i += 3;\r\n                } else if (mask[i] == 'y' && mask[i+1] == 'y') {\r\n                    pieces.push('yy');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm' && mask[i+3] == 'm') {\r\n                    pieces.push('mmmm');\r\n                    i += 3;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm') {\r\n                    pieces.push('mmm');\r\n                    i += 2;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm') {\r\n                    pieces.push('mm');\r\n                    i++;\r\n                } else if (mask[i] == 'd' && mask[i+1] == 'd') {\r\n                    pieces.push('dd');\r\n                    i++;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h' && mask[i+2] == '2' && mask[i+3] == '4') {\r\n                    pieces.push('hh24');\r\n                    i += 3;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h') {\r\n                    pieces.push('hh');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'i') {\r\n                    pieces.push('mi');\r\n                    i++;\r\n                } else if (mask[i] == 's' && mask[i+1] == 's') {\r\n                    pieces.push('ss');\r\n                    i++;\r\n                } else if (mask[i] == 'a' && mask[i+1] == 'm') {\r\n                    pieces.push('am');\r\n                    i++;\r\n                } else if (mask[i] == 'p' && mask[i+1] == 'm') {\r\n                    pieces.push('pm');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == '0') {\r\n                    pieces.push('\\\\0');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == 'a') {\r\n                    pieces.push('\\\\a');\r\n                    i++;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            } else {\r\n                if (mask[i] == '#' && mask[i+1] == '.' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#.##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ',' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#,##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ' ' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('# ##');\r\n                    i += 3;\r\n                } else if (mask[i] == '[' && mask[i+1] == '-' && mask[i+2] == ']') {\r\n                    pieces.push('[-]');\r\n                    i += 2;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * Thanks for the collaboration\r\n     */\r\n    obj.fromKeyCode = function(e) {\r\n        var _to_ascii = {\r\n            '188': '44',\r\n            '109': '45',\r\n            '190': '46',\r\n            '191': '47',\r\n            '192': '96',\r\n            '220': '92',\r\n            '222': '39',\r\n            '221': '93',\r\n            '219': '91',\r\n            '173': '45',\r\n            '187': '61', //IE Key codes\r\n            '186': '59', //IE Key codes\r\n            '189': '45'  //IE Key codes\r\n        }\r\n\r\n        var shiftUps = {\r\n            \"96\": \"~\",\r\n            \"49\": \"!\",\r\n            \"50\": \"@\",\r\n            \"51\": \"#\",\r\n            \"52\": \"$\",\r\n            \"53\": \"%\",\r\n            \"54\": \"^\",\r\n            \"55\": \"&\",\r\n            \"56\": \"*\",\r\n            \"57\": \"(\",\r\n            \"48\": \")\",\r\n            \"45\": \"_\",\r\n            \"61\": \"+\",\r\n            \"91\": \"{\",\r\n            \"93\": \"}\",\r\n            \"92\": \"|\",\r\n            \"59\": \":\",\r\n            \"39\": \"\\\"\",\r\n            \"44\": \"<\",\r\n            \"46\": \">\",\r\n            \"47\": \"?\"\r\n        };\r\n\r\n        var c = e.which;\r\n\r\n        if (_to_ascii.hasOwnProperty(c)) {\r\n            c = _to_ascii[c];\r\n        }\r\n\r\n        if (!e.shiftKey && (c >= 65 && c <= 90)) {\r\n            c = String.fromCharCode(c + 32);\r\n        } else if (e.shiftKey && shiftUps.hasOwnProperty(c)) {\r\n            c = shiftUps[c];\r\n        } else if (96 <= c && c <= 105) {\r\n            c = String.fromCharCode(c - 48);\r\n        } else {\r\n            c = String.fromCharCode(c);\r\n        }\r\n\r\n        return c;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mobile = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    if (jSuites.el) {\r\n        jSuites.el.addEventListener('mousedown', function(e) {\r\n            if (e.target.classList.contains('option-title')) {\r\n                if (e.target.classList.contains('selected')) {\r\n                    e.target.classList.remove('selected');\r\n                } else {\r\n                    e.target.classList.add('selected');\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.pages = (function() {\r\n    var container = null;\r\n    var current = null;\r\n\r\n    // Create a page\r\n    var createPage = function(options, callback) {\r\n        // Create page\r\n        var page = document.createElement('div');\r\n        page.classList.add('page');\r\n\r\n        // Always hidden\r\n        page.style.display = 'none';\r\n\r\n        // Keep options\r\n        page.options = options ? options : {};\r\n\r\n        if (! current) {\r\n            container.appendChild(page);\r\n        } else {\r\n            container.insertBefore(page, current.nextSibling);\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: page.options.url,\r\n            method: 'GET',\r\n            success: function(result) {\r\n                // Push to refresh controls\r\n                jSuites.refresh(page, page.options.onpush);\r\n\n                // Open page\r\n                page.innerHTML = result;\r\n                // Get javascript\r\n                var script = page.getElementsByTagName('script');\r\n                // Run possible inline scripts\r\n                for (var i = 0; i < script.length; i++) {\r\n                    // Get type\r\n                    var type = script[i].getAttribute('type');\r\n                    if (! type || type == 'text/javascript') {\r\n                        eval(script[i].innerHTML);\r\n                    }\r\n                }\r\n                // Set title\r\n                page.setTitle = function(text) {\r\n                    this.children[0].children[0].children[1].innerHTML = text;\r\n                }\r\n                // Show page\r\n                if (! page.options.closed) {\r\n                    showPage(page);\r\n                }\r\n                // Onload callback\r\n                if (typeof(page.options.onload) == 'function') {\r\n                    page.options.onload(page);\r\n                }\r\n                // Force callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(page);\r\n                }\r\n            }\r\n        });\r\n\r\n        return page;\r\n    }\r\n\r\n    var showPage = function(page, ignoreHistory, callback) {\r\n        if (current) {\r\n            if (current == page) {\r\n                current = page;\r\n            } else {\r\n                // Keep scroll in the top\r\n                window.scrollTo({ top: 0 });\r\n\r\n                // Show page\r\n                page.style.display = '';\r\n\r\n                var a = Array.prototype.indexOf.call(container.children, current);\r\n                var b = Array.prototype.indexOf.call(container.children, page);\r\n\r\n                // Leave\r\n                if (typeof(current.options.onleave) == 'function') {\r\n                    current.options.onleave(current, page, ignoreHistory);\r\n                }\r\n\r\n                jSuites.slideLeft(container, (a < b ? 0 : 1), function() {\r\n                    current.style.display = 'none';\r\n                    current = page;\r\n                });\r\n\r\n                // Enter\r\n                if (typeof(page.options.onenter) == 'function') {\r\n                    page.options.onenter(page, current, ignoreHistory);\r\n                }\r\n            }\r\n        } else {\r\n            // Show\r\n            page.style.display = '';\r\n\r\n            // Keep current\r\n            current = page;\r\n\r\n            // Enter\r\n            if (typeof(page.options.onenter) == 'function') {\r\n                page.options.onenter(page);\r\n            }\r\n        }\r\n\r\n        // Add history\r\n        if (! ignoreHistory) {\r\n            // Add history\r\n            window.history.pushState({ route: page.options.route }, page.options.title, page.options.route);\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(callback) == 'function') {\r\n            callback(page);\r\n        }\r\n    }\r\n\r\n    // Init method\r\n    var obj = function(route, mixed) {\r\n\r\n        // Create page container\r\n        if (! container) {\r\n            container = document.querySelector('.pages');\r\n            if (! container) {\r\n                container = document.createElement('div');\r\n                container.className = 'pages';\r\n            }\r\n\r\n            // Append container to the application\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(container);\r\n            } else {\r\n                document.body.appendChild(container);\r\n            }\r\n        }\r\n\r\n        if (! obj.pages[route]) {\r\n            if (! route) {\r\n                alert('Error, no route provided');\r\n            } else {\r\n                if (typeof(mixed) == 'function') {\r\n                    var options = {};\r\n                    var callback = mixed;\r\n                } else {\r\n                    // Page options\r\n                    var options = mixed ? mixed : {};\r\n                }\r\n\r\n                // Closed\r\n                options.closed = mixed && mixed.closed ? 1 : 0;\r\n                // Keep Route\r\n                options.route = route;\r\n\r\n                // New page url\r\n                if (! options.url) {\r\n                    var routePath = route.split('#');\r\n                    options.url = jSuites.pages.path + routePath[0] + '.html';\r\n                }\r\n                // Title\r\n                if (! options.title) {\r\n                    options.title = 'Untitled';\r\n                }\r\n\r\n                // Create new page\r\n                obj.pages[route] = createPage(options, callback ? callback : null);\r\n            }\r\n        } else {\r\n            // Update config\r\n            if (mixed) {\r\n                // History\r\n                var ignoreHistory = 0;\r\n\r\n                if (typeof(mixed) == 'function') {\r\n                    var callback = mixed;\r\n                } else {\r\n                    if (typeof(mixed.onenter) == 'function') {\r\n                        obj.pages[route].options.onenter = mixed.onenter;\r\n                    }\r\n                    if (typeof(mixed.onleave) == 'function') {\r\n                        obj.pages[route].options.onleave = mixed.onleave;\r\n                    }\r\n\r\n                    // Ignore history\r\n                    ignoreHistory = mixed.ignoreHistory ? 1 : 0; \r\n                }\r\n            }\r\n\r\n            showPage(obj.pages[route], ignoreHistory, callback ? callback : null);\r\n        }\r\n    }\r\n\r\n    obj.pages = {};\r\n\r\n    // Get page\r\n    obj.get = function(route) {\r\n        if (obj.pages[route]) {\r\n            return obj.pages[route]; \r\n        }\r\n    }\r\n\r\n    obj.getContainer = function() {\r\n        return container;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        // Current is null\r\n        current = null;\r\n        // Destroy containers\r\n        obj.pages = {};\r\n        // Reset container\r\n        if (container) {\r\n            container.innerHTML = '';\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\n// Path\r\njSuites.pages.path = 'pages';\r\n\r\n// Panel\r\njSuites.panel = (function() {\r\n    // No initial panel declared\r\n    var panel = null;\r\n\r\n    var obj = function(route) {\r\n        if (! panel) {\r\n            obj.create(jSuites.pages.path + route + '.html');\r\n        }\r\n\r\n        // Show panel\r\n        panel.style.display = '';\r\n\r\n        // Add animation\r\n        if (panel.classList.contains('panel-left')) {\r\n            jSuites.slideLeft(panel, 1);\r\n        } else {\r\n            jSuites.slideRight(panel, 1);\r\n        }\r\n    }\r\n\r\n    obj.create = function(route) {\r\n        if (! panel) {\r\n            // Create element\r\n            panel = document.createElement('div');\r\n            panel.classList.add('panel');\r\n            panel.classList.add('panel-left');\r\n            panel.style.display = 'none';\r\n\r\n            // Bind to the app\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(panel);\r\n            } else {\r\n                document.body.appendChild(panel);\r\n            }\r\n        }\r\n\r\n        // Remote content\r\n        if (route) {\r\n\t        var url = jSuites.pages.path + route + '.html';\r\n\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                success: function(result) {\r\n                    // Set content\r\n                    panel.innerHTML = result;\r\n                    // Get javascript\r\n                    var script = panel.getElementsByTagName('script');\r\n                    // Run possible inline scripts\r\n                    for (var i = 0; i < script.length; i++) {\r\n                        // Get type\r\n                        var type = script[i].getAttribute('type');\r\n                        if (! type || type == 'text/javascript') {\r\n                            eval(script[i].innerHTML);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (panel) {\r\n            // Animation\r\n            if (panel.classList.contains('panel-left')) {\r\n                jSuites.slideLeft(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            } else {\r\n                jSuites.slideRight(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.get = function() {\r\n        return panel;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        panel.remove();\r\n        panel = null;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = options;\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            elements[i].classList.remove('selected');\r\n        }\r\n        element.classList.add('selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.slideBottom(toolbar, 0, function() {\r\n            toolbar.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        toolbar.style.display = '';\r\n        jSuites.slideBottom(toolbar, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return toolbar;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        toolbar = null;\r\n    }\r\n\r\n    var toolbar = document.createElement('div');\r\n    toolbar.classList.add('jtoolbar');\r\n    toolbar.onclick = function(e) {\r\n        var element = jSuites.getElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n    }\r\n\r\n    var toolbarContent = document.createElement('div');\r\n    toolbar.appendChild(toolbarContent);\r\n\r\n    for (var i = 0; i < options.items.length; i++) {\r\n        var toolbarItem = document.createElement('div');\r\n        toolbarItem.classList.add('jtoolbar-item');\r\n        if (options.items[i].route) {\r\n            toolbarItem.setAttribute('data-href', options.items[i].route);\r\n            jSuites.pages(options.items[i].route, {\r\n                closed: true,\r\n                onenter: function() {\r\n                    obj.selectItem(toolbarItem);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (options.items[i].icon) {\r\n            var toolbarIcon = document.createElement('i');\r\n            toolbarIcon.classList.add('material-icons');\r\n            toolbarIcon.innerHTML = options.items[i].icon;\r\n            toolbarItem.appendChild(toolbarIcon);\r\n        }\r\n\r\n        var toolbarBadge = document.createElement('div');\r\n        toolbarBadge.classList.add('jbadge');\r\n        var toolbarBadgeContent = document.createElement('div');\r\n        toolbarBadgeContent.innerHTML = options.items[i].badge ? options.items[i].badge : '';\r\n        toolbarBadge.appendChild(toolbarBadgeContent);\r\n        toolbarItem.appendChild(toolbarBadge);\r\n\r\n        if (options.items[i].title) {\r\n            var toolbarTitle = document.createElement('span');\r\n            toolbarTitle.innerHTML = options.items[i].title;\r\n            toolbarItem.appendChild(toolbarTitle);\r\n        }\r\n\r\n        toolbarContent.appendChild(toolbarItem);\r\n    }\r\n\r\n    el.toolbar = obj;\r\n\r\n    el.appendChild(toolbar);\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.actionsheet = (function() {\r\n    var actionsheet = document.createElement('div');\r\n    actionsheet.className = 'jactionsheet';\r\n    actionsheet.style.display = 'none';\r\n\r\n    var actionContent = document.createElement('div');\r\n    actionContent.className = 'jactionsheet-content';\r\n    actionsheet.appendChild(actionContent);\r\n\r\n    var obj = function(options) {\r\n        if (options) {\r\n            obj.options = options;\r\n        }\r\n\r\n        // Reset container\r\n        actionContent.innerHTML = '';\r\n\r\n        // Create new elements\r\n        for (var i = 0; i < obj.options.length; i++) {\r\n            var actionGroup = document.createElement('div');\r\n            actionGroup.className = 'jactionsheet-group';\r\n\r\n            for (var j = 0; j < obj.options[i].length; j++) {\r\n                var v = obj.options[i][j];\r\n                var actionItem = document.createElement('div');\r\n                var actionInput = document.createElement('input');\r\n                actionInput.type = 'button';\r\n                actionInput.value = v.title;\r\n                if (v.className) {\r\n                    actionInput.className = v.className; \r\n                }\r\n                if (v.onclick) {\r\n                    actionInput.onclick = v.onclick; \r\n                }\r\n                if (v.action == 'cancel') {\r\n                    actionInput.style.color = 'red';\r\n                }\r\n                actionItem.appendChild(actionInput);\r\n                actionGroup.appendChild(actionItem);\r\n            }\r\n\r\n            actionContent.appendChild(actionGroup);\r\n        }\r\n\r\n        // Show\r\n        actionsheet.style.display = '';\r\n\r\n        // Append\r\n        jSuites.el.appendChild(actionsheet);\r\n\r\n        // Animation\r\n        jSuites.slideBottom(actionContent, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (actionsheet.style.display != 'none') {\r\n            // Remove any existing actionsheet\r\n            jSuites.slideBottom(actionContent, false, function() {\r\n                actionsheet.remove();\r\n                actionsheet.style.display = 'none';\r\n            });\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        obj.close();\r\n    }\r\n\r\n    actionsheet.addEventListener('mouseup', mouseUp);\r\n\r\n    obj.options = {};\r\n\r\n    return obj;\r\n})();\r\n\r\n/**\r\n * (c) jSuites modal\r\n * https://github.com/paulhodel/jsuites\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Modal\r\n */\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        temp.appendChild(el.children[i]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    for (var i = 0; i < temp.children.length; i++) {\r\n        obj.content.appendChild(temp.children[i]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    var backdrop = document.createElement('div');\r\n    backdrop.className = 'jmodal_backdrop';\r\n    el.appendChild(backdrop);\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        const rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.slideBottom(obj.container, 1);\r\n        } else {\r\n            backdrop.style.display = 'block';\r\n        }\r\n        // Current\r\n        jSuites.modal.current = obj;\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        // Backdrop\r\n        backdrop.style.display = '';\r\n        // Current\r\n        jSuites.modal.current = null;\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        jSuites.modal.current = obj;\r\n\r\n        if ('ontouchstart' in document.documentElement === true) {\r\n            document.addEventListener(\"touchstart\", jSuites.modal.mouseDownControls);\r\n        } else {\r\n            document.addEventListener('mousedown', jSuites.modal.mouseDownControls);\r\n            document.addEventListener('mousemove', jSuites.modal.mouseMoveControls);\r\n            document.addEventListener('mouseup', jSuites.modal.mouseUpControls);\r\n        }\r\n\r\n        document.addEventListener('keydown', jSuites.modal.keyDownControls);\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.modal.current = null;\r\njSuites.modal.position = null;\r\n\r\njSuites.modal.keyDownControls = function(e) {\r\n    if (e.which == 27) {\r\n        if (jSuites.modal.current) {\r\n            jSuites.modal.current.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseUpControls = function(e) {\r\n    if (jSuites.modal.current) {\r\n        jSuites.modal.current.container.style.cursor = 'auto';\r\n    }\r\n    jSuites.modal.position = null;\r\n}\r\n\r\njSuites.modal.mouseMoveControls = function(e) {\r\n    if (jSuites.modal.current && jSuites.modal.position) {\r\n        if (e.which == 1 || e.which == 3) {\r\n            var position = jSuites.modal.position;\r\n            jSuites.modal.current.container.style.top = (position[1] + (e.clientY - position[3]) + (position[5] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.left = (position[0] + (e.clientX - position[2]) + (position[4] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.cursor = 'move';\r\n        } else {\r\n            jSuites.modal.current.container.style.cursor = 'auto';\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseDownControls = function(e) {\r\n    jSuites.modal.position = [];\r\n\r\n    if (e.target.classList.contains('jmodal')) {\r\n        setTimeout(function() {\r\n            // Get target info\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                setTimeout(function() {\r\n                    jSuites.modal.current.close();\r\n                }, 100);\r\n            } else {\r\n                if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                    if (document.selection) {\r\n                        document.selection.empty();\r\n                    } else if ( window.getSelection ) {\r\n                        window.getSelection().removeAllRanges();\r\n                    }\r\n\r\n                    jSuites.modal.position = [\r\n                        rect.left,\r\n                        rect.top,\r\n                        e.clientX,\r\n                        e.clientY,\r\n                        rect.width,\r\n                        rect.height,\r\n                    ];\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeIn(notification);\r\n        } else {\r\n            jSuites.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeOut(notification, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        } else {\r\n            jSuites.slideTop(notification, 0, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        number: 5,\r\n        value: 0,\r\n        tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jrating');\r\n\r\n    // Add elements\r\n    for (var i = 0; i < obj.options.number; i++) {\r\n        var div = document.createElement('div');\r\n        div.setAttribute('data-index', (i + 1))\r\n        div.setAttribute('title', obj.options.tooltip[i])\r\n        el.appendChild(div);\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    if (obj.options.value) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < obj.options.value) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    // Events\r\n    el.addEventListener(\"click\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        if (index != undefined) {\r\n            if (index == obj.options.value) {\r\n                obj.setValue(0);\r\n            } else {\r\n                obj.setValue(index);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseover\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-over');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseout\", function(e) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            el.children[i].classList.remove('jrating-over');\r\n        }\r\n    });\r\n\r\n    el.rating = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n/**\r\n * (c) Image slider\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Image Slider\r\n */\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n\r\n        // Create container\r\n        var container = document.createElement('div');\r\n        container.className = 'jslider-container';\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n            }\r\n        }\r\n        if (obj.options.items.length > 0) {\r\n            for (var i = 0; i < obj.options.items.length; i++) {\r\n                obj.options.items[i].classList.add('jfile');\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n                if (index < 0) {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src);\r\n                } else {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src.substr(index + 1));\r\n                }\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n\r\n                container.appendChild(obj.options.items[i]);\r\n            }\r\n        }\r\n        el.appendChild(container);\r\n        // Add close buttom\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        close.onclick =  function() {\r\n            obj.close();\r\n        }\r\n        el.appendChild(close);\r\n    } else {\r\n        var container = el.querySelector('slider-container');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = container.children[0];\r\n        }\r\n\r\n        if (! container.classList.contains('jslider-preview')) {\r\n            container.classList.add('jslider-preview');\r\n            close.style.display = 'block';\r\n        }\r\n\r\n        // Hide all images\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = 'none';\r\n        }\r\n\r\n        // Show clicked only\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousSibling) {\r\n            container.classList.add('jslider-left');\r\n        } else {\r\n            container.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextSibling) {\r\n            container.classList.add('jslider-right');\r\n        } else {\r\n            container.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        container.classList.remove('jslider-preview');\r\n        container.classList.remove('jslider-left');\r\n        container.classList.remove('jslider-right');\r\n\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = '';\r\n        }\r\n\r\n        close.style.display = '';\r\n\r\n        obj.currentImage = null;\r\n\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        container.innerHTML = '';\r\n    }\r\n\r\n    obj.addFile = function(v, ignoreEvents) {\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-lastmodified', v.lastmodified);\r\n        img.setAttribute('data-name', v.name);\r\n        img.setAttribute('data-size', v.size);\r\n        img.setAttribute('data-extension', v.extension);\r\n        img.setAttribute('data-cover', v.cover);\r\n        img.setAttribute('src', v.file);\r\n        img.className = 'jfile';\r\n        container.appendChild(img);\r\n        obj.options.items.push(img);\r\n\r\n        // Onchange\r\n        if (! ignoreEvents) {\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, v);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.addFiles = function(files) {\r\n        for (var i = 0; i < files.length; i++) {\r\n            obj.addFile(files[i]);\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        if (obj.currentImage.nextSibling) {\r\n            obj.show(obj.currentImage.nextSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousSibling) {\r\n            obj.show(obj.currentImage.previousSibling);\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return jSuites.getFiles(container);\r\n    }\r\n\r\n    // Append data\r\n    if (obj.options.data && obj.options.data.length) {\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i]) {\r\n                obj.addFile(obj.options.data[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Allow insert\r\n    if (obj.options.allowAttachment) {\r\n        var attachmentInput = document.createElement('input');\r\n        attachmentInput.type = 'file';\r\n        attachmentInput.className = 'slider-attachment';\r\n        attachmentInput.setAttribute('accept', 'image/*');\r\n        attachmentInput.style.display = 'none';\r\n        attachmentInput.onchange = function() {\r\n            var reader = [];\r\n\r\n            for (var i = 0; i < this.files.length; i++) {\r\n                var type = this.files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    var extension = this.files[i].name;\r\n                    extension = extension.split('.');\r\n                    extension = extension[extension.length-1];\r\n\r\n                    var file = {\r\n                        size: this.files[i].size,\r\n                        name: this.files[i].name,\r\n                        extension: extension,\r\n                        cover: 0,\r\n                        lastmodified: this.files[i].lastModified,\r\n                    }\r\n\r\n                    reader[i] = new FileReader();\r\n                    reader[i].addEventListener(\"load\", function (e) {\r\n                        file.file = e.target.result;\r\n                        obj.addFile(file);\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(this.files[i]);\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            };\r\n        }\r\n\r\n        var attachmentIcon = document.createElement('i');\r\n        attachmentIcon.innerHTML = 'attachment';\r\n        attachmentIcon.className = 'jslider-attach material-icons';\r\n        attachmentIcon.onclick = function() {\r\n            jSuites.click(attachmentInput);\r\n        }\r\n\r\n        el.appendChild(attachmentInput);\r\n        el.appendChild(attachmentIcon);\r\n    }\r\n\r\n    // Push to refresh\r\n    var longTouchTimer = null;\r\n\r\n    var mouseDown = function(e) {\r\n        if (e.target.tagName == 'IMG') {\r\n            // Remove\r\n            var targetImage = e.target;\r\n            longTouchTimer = setTimeout(function() {\r\n                if (e.target.src.substr(0,4) == 'data') {\r\n                    e.target.remove();\r\n                } else {\r\n                    if (e.target.classList.contains('jremove')) {\r\n                        e.target.classList.remove('jremove');\r\n                    } else {\r\n                        e.target.classList.add('jremove');\r\n                    }\r\n                }\r\n\r\n                // Onchange\r\n                if (typeof(obj.options.onchange) == 'function') {\r\n                    obj.options.onchange(el, e.target);\r\n                }\r\n            }, 1000);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        if (longTouchTimer) {\r\n            clearTimeout(longTouchTimer);\r\n        }\r\n\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            if (! e.target.classList.contains('jremove')) {\r\n                obj.show(e.target);\r\n            }\r\n        } else {\r\n            // Arrow controls\r\n            if (e.target.clientWidth - e.offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (e.offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    container.addEventListener('mousedown', mouseDown);\r\n    container.addEventListener('touchstart', mouseDown);\r\n    container.addEventListener('mouseup', mouseUp);\r\n    container.addEventListener('touchend', mouseUp);\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jTools v1.0.1 - Element sorting\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Element drag and drop sorting\n */\n\njSuites.sorting = (function(el, options) {\n    el.classList.add('jsorting');\n\n    el.addEventListener('dragstart', function(e) {\n        e.target.classList.add('dragging');\n    });\n\n    el.addEventListener('dragover', function(e) {\n        e.preventDefault();\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[0].style.borderTop = '1px dotted #ccc';\n            e.path[0].style.borderBottom = '';\n        } else {\n            e.path[0].style.borderTop = '';\n            e.path[0].style.borderBottom = '1px dotted #ccc';\n        }\n    });\n\n    el.addEventListener('dragleave', function(e) {\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    el.addEventListener('dragend', function(e) {\n        e.path[1].querySelector('.dragging').classList.remove('dragging');\n    });\n\n    el.addEventListener('drop', function(e) {\n        var element = e.path[1].querySelector('.dragging');\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[1].insertBefore(element, e.path[0]);\n        } else {\n            e.path[1].insertBefore(element, e.path[0].nextSibling);\n        }\n\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    for (var i = 0; i < el.children.length; i++) {\n        el.children[i].setAttribute('draggable', 'true');\n    };\n\n    return el;\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: null,\r\n        allowCreate: false,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        animation: false,\r\n        create: null,\r\n        autoName: false,\r\n        prefixName: '',\r\n        hideHeaders: false,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    if (obj.options.animation == true) {\r\n        // Border\r\n        var border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        el.appendChild(border);\r\n\r\n        var setBorder = function(index) {\r\n            var rect = headers.children[index].getBoundingClientRect();\r\n            var rectContent = content.children[index].getBoundingClientRect();\r\n            border.style.width = rect.width + 'px';\r\n            border.style.left = (rect.left - rectContent.left) + 'px';\r\n            border.style.top = rect.height + 'px';\r\n        }\r\n    }\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        for (var i = 0; i < headers.children.length; i++) {\r\n            headers.children[i].classList.remove('jtabs-selected');\r\n            if (content.children[i]) {\r\n                content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        headers.children[index].classList.add('jtabs-selected');\r\n        if (content.children[index]) {\r\n            content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (headers.children.length < 2 && obj.options.allowCreate == false)) {\r\n            headers.style.display = 'none';\r\n        } else {\r\n            headers.style.display = '';\r\n            // Set border\r\n            if (obj.options.animation == true) {\r\n                setTimeout(function() {\r\n                    setBorder(index);\r\n                }, 100);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n    }\r\n\r\n    obj.create = function(title, div) {\r\n        if (typeof(obj.options.create) == 'function') {\r\n            obj.options.create();\r\n        } else {\r\n            obj.appendElement(title, div);\r\n\r\n            if (typeof(obj.options.oncreate) == 'function') {\r\n                obj.options.oncreate(el, div)\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, div) {\r\n        if (! title) {\r\n            if (obj.options.autoName == true) {\r\n                var title = obj.options.prefixName;\r\n                title += ' ' + (parseInt(content.children.length) + 1);\r\n            } else {\r\n                var title = prompt('Title?', '');\r\n            }\r\n        }\r\n\r\n        if (title) {\r\n            // Add headers\r\n            var header = document.createElement('div');\r\n            header.innerHTML = title;\r\n            if (obj.options.allowCreate) {\r\n                headers.insertBefore(header, headers.lastChild);\r\n            } else {\r\n                headers.appendChild(header);\r\n            }\r\n\r\n            // Add content\r\n            if (! div) {\r\n                var div = document.createElement('div');\r\n            }\r\n            content.appendChild(div);\r\n\r\n            // Open new tab\r\n            obj.selectIndex(header);\r\n        }\r\n    }\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Make sure the component is blank\r\n        el.innerHTML = '';\r\n        var headers = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n        el.appendChild(headers);\r\n        el.appendChild(content);\r\n\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            var headersItem = document.createElement('div');\r\n            headers.appendChild(headersItem);\r\n            var contentItem = document.createElement('div');\r\n            content.appendChild(contentItem);\r\n\r\n            headersItem.innerHTML = obj.options.data[i].title;\r\n            if (obj.options.data[i].content) {\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            } else if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    success: function(result) {\r\n                        contentItem.innerHTML = result;\r\n                    },\r\n                    complete: function() {\r\n                        if (typeof(obj.options.onload) == 'function') {\r\n                            obj.options.onload(el);\r\n\r\n                            obj.open(0);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    } else if (el.children[0] && el.children[1]) {\r\n        // Create from existing elements\r\n        var headers = el.children[0];\r\n        var content = el.children[1];\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n    } else {\r\n        el.innerHTML = '';\r\n        var headers = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n        el.appendChild(headers);\r\n        el.appendChild(content);\r\n    }\r\n\r\n    // New\r\n    if (obj.options.allowCreate == true) {\r\n        var add = document.createElement('i');\r\n        add.className = 'jtabs-add';\r\n        headers.appendChild(add);\r\n    }\r\n\r\n    // Events\r\n    headers.addEventListener(\"click\", function(e) {\r\n        if (e.target.tagName == 'DIV') {\r\n            obj.selectIndex(e.target);\r\n        } else {\r\n            obj.create();\r\n        }\r\n    });\r\n\r\n    if (headers.children.length) {\r\n        obj.open(0);\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    /**\r\n     * @typedef {Object} defaults\r\n     * @property {(string|Array)} value - Initial value of the compontent\r\n     * @property {number} limit - Max number of tags inside the element\r\n     * @property {string} search - The URL for suggestions\r\n     * @property {string} placeholder - The default instruction text on the element\r\n     * @property {validation} validation - Method to validate the tags\r\n     * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n     * @property {requestCallback} onfocus - Method to be execute when on focus\r\n     * @property {requestCallback} onblur - Method to be execute when on blur\r\n     * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n     */\r\n    var defaults = {\r\n        value: null,\r\n        limit: null,\r\n        limitMessage: 'The limit of entries is: ',\r\n        search: null,\r\n        placeholder: null,\r\n        validation: null,\r\n        onbeforechange: null,\r\n        onchange: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        colors: null,\r\n    };\r\n\r\n    // Loop through though the default configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Search helpers\r\n    var searchContainer = null;\r\n    var searchTerms = null;\r\n    var searchIndex = 0;\r\n    var searchTimer = 0;\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value, focus) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var v = obj.options.onbeforechange(el, obj, value);\r\n            if (v != null) {\r\n                value = v;\r\n            }\r\n        }\r\n\r\n        // Close search\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n\r\n        if (obj.options.limit > 0 && el.children.length >= obj.options.limit) {\r\n            alert(obj.options.limitMessage + ' ' + obj.options.limit);\r\n        } else {\r\n            // Get node\r\n            var node = getSelectionStart();\r\n\r\n            // Mix argument string or array\r\n            if (! value || typeof(value) == 'string') {\r\n                var div = document.createElement('div');\r\n                div.innerHTML = value ? value : '<br>';\r\n                if (node && node.parentNode.classList.contains('jtags')) {\r\n                    el.insertBefore(div, node.nextSibling);\r\n                } else {\r\n                    el.appendChild(div);\r\n                }\r\n            } else {\r\n                if (node && node.parentNode.classList.contains('jtags')) {\r\n                    if (! node.innerText.replace(\"\\n\", \"\")) {\r\n                        el.removeChild(node);\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i <= value.length; i++) {\r\n                    if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                        var div = document.createElement('div');\r\n                        div.innerHTML = value[i] ? value[i] : '<br>';\r\n                        el.appendChild(div);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Place caret\r\n            if (focus) {\r\n                setTimeout(function() {\r\n                    caret(div);\r\n                }, 0);\r\n            }\r\n\r\n            // Filter\r\n            filter();\r\n\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj, value ? value : '');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            var value = obj.getValue(i);\r\n            if (value) {\r\n                var id = el.children[i].getAttribute('data-id');\r\n                if (! id) {\r\n                    id = value;\r\n                }\r\n                data.push({ id: id, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {string} value - A string with the tags\r\n     */\r\n    obj.setValue = function(text) {\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            // Tags\r\n            var data = extractTags(text);\r\n            // Add tags to the element\r\n            obj.add(data);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(item) {\r\n        // Reset terms\r\n        searchTerms = '';\r\n        var node = getSelectionStart();\r\n        // Append text to the caret\r\n        node.innerText = item.children[1].innerText;\r\n        // Set node id\r\n        if (item.children[1].getAttribute('data-id')) {\r\n            node.setAttribute('data-id', item.children[1].getAttribute('data-id'));\r\n        }\r\n        // Close container\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n            searchContainer.innerHTML = '';\r\n        }\r\n        // Remove any error\r\n        node.classList.remove('jtags_error');\r\n        // Add new item\r\n        obj.add();\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Create and append search container to the DOM\r\n        if (! searchContainer) {\r\n            var div = document.createElement('div');\r\n            div.style.position = 'relative';\r\n            el.parentNode.insertBefore(div, el.nextSibling);\r\n\r\n            // Create container\r\n            searchContainer = document.createElement('div');\r\n            searchContainer.classList.add('jtags_search');\r\n            div.appendChild(searchContainer);\r\n        }\r\n\r\n        // Search for\r\n        var terms = node.anchorNode.nodeValue;\r\n\r\n        // Search\r\n        if (node.anchorNode.nodeValue && terms != searchTerms) {\r\n            // Terms\r\n            searchTerms = node.anchorNode.nodeValue;\r\n            // Reset index\r\n            searchIndex = 0;\r\n            // Get remove results\r\n            jSuites.ajax({\r\n                url: obj.options.search + searchTerms,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    // Reset container\r\n                    searchContainer.innerHTML = '';\r\n\r\n                    // Print results\r\n                    if (! data.length) {\r\n                        // Show container\r\n                        searchContainer.style.display = '';\r\n                    } else {\r\n                        // Show container\r\n                        searchContainer.style.display = 'block';\r\n\r\n                        // Show items\r\n                        var len = data.length < 11 ? data.length : 10;\r\n                        for (var i = 0; i < len; i++) {\r\n                            var div = document.createElement('div');\r\n                            if (i == 0) {\r\n                                div.classList.add('selected');\r\n                            }\r\n                            var img = document.createElement('img');\r\n                            if (data[i].image) {\r\n                                img.src = data[i].image;\r\n                            } else {\r\n                                img.style.display = 'none';\r\n                            }\r\n                            div.appendChild(img);\r\n\r\n                            var item = document.createElement('div');\r\n                            item.setAttribute('data-id', data[i].id);\r\n                            item.innerHTML = data[i].name;\r\n                            div.onclick = function() {\r\n                                // Add item\r\n                                obj.selectIndex(this);\r\n                            }\r\n                            div.appendChild(item);\r\n                            // Append item to the container\r\n                            searchContainer.appendChild(div);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var getRandomColor = function(index) {\r\n        var rand = function(min, max) {\r\n            return min + Math.random() * (max - min);\r\n        }\r\n        return 'hsl(' + rand(1, 360) + ',' + rand(40, 70) + '%,' + rand(65, 72) + '%)';\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-id'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Place caret in the element node\r\n     */\r\n    var caret = function(e) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        range.setStart(e, e.innerText.length);\r\n        range.collapse(true);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    /**\r\n     * Selection\r\n     */\r\n    var getSelectionStart = function() {\r\n        var node = document.getSelection().anchorNode;\r\n        if (node) {\r\n            return (node.nodeType == 3 ? node.parentNode : node);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\r\\n') {\r\n                    if (word) {\r\n                        data.push(word);\r\n                        word = '';\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify content\r\n        if (! el.children.length) {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = '<br>';\r\n            el.appendChild(div);\r\n        }\r\n        // Comma\r\n        if (e.which == 9 || e.which == 186 || e.which == 188) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                    obj.add('', true);\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 13) {\r\n            // Enter\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                obj.selectIndex(searchContainer.children[searchIndex]);\r\n            } else {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                        obj.add('', true);\r\n                    }\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 38) {\r\n            // Up\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex > 0) {\r\n                    searchIndex--;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 40) {\r\n            // Down\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex < 9) {\r\n                    searchIndex++;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add();\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (searchTimer) {\r\n                clearTimeout(searchTimer);\r\n            }\r\n\r\n            searchTimer = setTimeout(function() {\r\n                // Current node\r\n                var node = window.getSelection();\r\n                // Search\r\n                if (obj.options.search) {\r\n                    obj.search(node);\r\n                }\r\n                searchTimer = null;\r\n            }, 300);\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var html = window.clipboardData.getData('Html');\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        obj.setValue(text);\r\n        e.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                const rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    el.removeChild(e.target);\r\n                    el.focus();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event focus on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsFocus = function(e) {\r\n        if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n            if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                var div = document.createElement('div');\r\n                div.innerHTML = '<br>';\r\n                el.appendChild(div);\r\n            }\r\n        }\r\n\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event blur on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsBlur = function(e) {\r\n        if (searchContainer) {\r\n            setTimeout(function() {\r\n                searchContainer.style.display = '';\r\n            }, 200);\r\n        }\r\n\r\n        for (var i = 0; i < el.children.length - 1; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.removeChild(el.children[i]);\r\n            }\r\n        }\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    // Bind events\r\n    el.addEventListener('mouseup', tagsMouseUp);\r\n    el.addEventListener('keydown', tagsKeyDown);\r\n    el.addEventListener('keyup', tagsKeyUp);\r\n    el.addEventListener('paste', tagsPaste);\r\n    el.addEventListener('focus', tagsFocus);\r\n    el.addEventListener('blur', tagsBlur);\r\n\r\n    // Prepare container\r\n    el.classList.add('jtags');\r\n    el.setAttribute('contenteditable', true);\r\n    el.setAttribute('spellcheck', false);\r\n\r\n    if (obj.options.placeholder) {\r\n        el.placeholder = obj.options.placeholder;\r\n    }\r\n\r\n    // Make sure element is empty\r\n    if (obj.options.value) {\r\n        obj.setValue(obj.options.value);\r\n    } else {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj);\r\n    }\r\n\r\n    el.tags = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tracker = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                var elements = el.querySelectorAll(\"input, select, textarea\");\r\n \r\n                for (var i = 0; i < elements.length; i++) {\r\n                    var name = elements[i].getAttribute('name');\r\n                    if (data[name]) {\r\n                        elements[i].value = data[name];\r\n                    }\r\n                }\r\n\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            jSuites.alert(test);\r\n        } else {\r\n            var data = obj.getElements(true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    console.log('Onbeforesave returned false');\r\n                    return; \r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    jSuites.alert(result.message);\r\n\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        var data = obj.options.onsave(el, result);\r\n                    }\r\n\r\n                    obj.reset();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        var emailChecker = function(data) {\r\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\r\n            return pattern.test(data) ? true : false; \r\n        }\r\n\r\n        var passwordChecker = function(data) {\r\n            return (data.length > 5) ? true : false;\r\n        }\r\n\r\n        var addError = function(element) {\r\n            // Add error in the element\r\n            element.classList.add('error');\r\n            // Submit button\r\n            if (obj.options.submitButton) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            }\r\n            // Return error message\r\n            return element.getAttribute('data-error') || 'There is an error in the form';\r\n        }\r\n\r\n        var delError = function(element) {\r\n            var error = false;\r\n            // Remove class from this element\r\n            element.classList.remove('error');\r\n            // Get elements in the form\r\n            var elements = el.querySelectorAll(\"input, select, textarea\");\r\n            // Run all elements \r\n            for (var i = 0; i < elements.length; i++) {\r\n                if (elements[i].getAttribute('data-validation')) {\r\n                    if (elements[i].classList.contains('error')) {\r\n                        error = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (obj.options.submitButton) {\r\n                if (error) {\r\n                    obj.options.submitButton.setAttribute('disabled', true);\r\n                } else {\r\n                    obj.options.submitButton.removeAttribute('disabled');\r\n                }\r\n            }\r\n        }\r\n\r\n        // Blank\r\n        var test = '';\r\n        if (! element.value) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-email') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-password') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = '';\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (test) {\r\n                    test += \"<br>\\r\\n\";\r\n                }\r\n                test += obj.validateElement(elements[i]);\r\n            }\r\n        }\r\n        return test;\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(obj.getElements());\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Get form elements\r\n    obj.getElements = function(asArray) {\r\n        var data = {};\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n\r\n        for (var i = 0; i < elements.length; i++) {\r\n            var element = elements[i];\r\n            var name = element.name;\r\n            var value = element.value;\r\n\r\n            if (name) {\r\n                data[name] = value;\r\n            }\r\n        }\r\n\r\n        return asArray == true ? data : JSON.stringify(data);\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Alert\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if (obj.isChanged() && obj.options.ignore == false) {\r\n            var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n            if (confirmationMessage) {\r\n                if (typeof e == 'undefined') {\r\n                    e = window.event;\r\n                }\r\n\r\n                if (e) {\r\n                    e.returnValue = confirmationMessage;\r\n                }\r\n\r\n                return confirmationMessage;\r\n            } else {\r\n                return void(0);\r\n            }\r\n        }\r\n    });\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    el.tracker = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));","\r\n/**\r\n * jExcel v3.9.1\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jexcel/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\r\n\r\n if (! jSuites && typeof(require) === 'function') {\r\n    var jSuites = require('jsuites');\r\n    require('jsuites/dist/jsuites.css');\r\n}\r\n\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jexcel = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\n// Jexcel core object\n\nvar jexcel = (function(el, options) {\n    // Create jexcel object\n    var obj = {};\n    obj.options = {};\n\n    if (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n        console.error('JEXCEL: el is not a valid DOM element');\r\n        return false;\r\n    }\r\n\n    // Loading default configuration\n    var defaults = {\n        // External data\n        url:null,\n        // Data\n        data:null,\n        // Copy behavior\n        copyCompatibility:false,\n        // Rows and columns definitions\n        rows:[],\n        columns:[],\n        // Deprected legacy options\n        colHeaders:[],\n        colWidths:[],\n        colAlignments:[],\n        nestedHeaders:null,\n        // Column width that is used by default\n        defaultColWidth:50,\n        defaultColAlign:'center',\n        // Spare rows and columns\n        minSpareRows:0,\n        minSpareCols:0,\n        // Minimal table dimensions\n        minDimensions:[0,0],\n        // Allow Export\n        allowExport:true,\r\n        // @type {boolean} - Include the header titles on download\n        includeHeadersOnDownload:false,\n        // Allow column sorting\n        columnSorting:true,\n        // Allow column dragging\n        columnDrag:false,\n        // Allow column resizing\n        columnResize:true,\n        // Allow row resizing\n        rowResize:false,\n        // Allow row dragging\n        rowDrag:true,\n        // Allow table edition\n        editable:true,\n        // Allow new rows\n        allowInsertRow:true,\n        // Allow new rows\n        allowManualInsertRow:true,\n        // Allow new columns\n        allowInsertColumn:true,\n        // Allow new rows\n        allowManualInsertColumn:true,\n        // Allow row delete\n        allowDeleteRow:true,\n        // Allow deleting of all rows\n        allowDeletingAllRows:false,\n        // Allow column delete\n        allowDeleteColumn:true,\n        // Allow rename column\n        allowRenameColumn:true,\n        // Allow comments\n        allowComments:false,\n        // Global wrap\n        wordWrap:false,\n        // Image options\n        imageOptions: null,\n        // CSV source\n        csv:null,\n        // Filename\n        csvFileName:'jexcel',\n        // Consider first line as header\n        csvHeaders:true,\n        // Delimiters\n        csvDelimiter:',',\n        // Disable corner selection\n        selectionCopy:true,\n        // Merged cells\n        mergeCells:{},\n        // Create toolbar\n        toolbar:null,\n        // Allow search\n        search:false,\n        // Create pagination\n        pagination:false,\n        paginationOptions:null,\n        // Full screen\n        fullscreen:false,\n        // Lazy loading\n        lazyLoading:false,\n        loadingSpin:false,\n        // Table overflow\n        tableOverflow:false,\n        tableHeight:'300px',\n        tableWidth:null,\n        // Meta\n        meta: null,\n        // Style\n        style:null,\n        // Execute formulas\n        parseFormulas:true,\n        autoIncrement:true,\n        autoCasting:true,\n        // Event handles\n        onundo:null,\n        onredo:null,\n        onload:null,\n        onchange:null,\n        onbeforechange:null,\n        onafterchanges:null,\n        onbeforeinsertrow: null,\n        oninsertrow:null,\n        onbeforeinsertcolumn: null,\n        oninsertcolumn:null,\n        onbeforedeleterow:null,\n        ondeleterow:null,\n        onbeforedeletecolumn:null,\n        ondeletecolumn:null,\n        onmoverow:null,\n        onmovecolumn:null,\n        onresizerow:null,\n        onresizecolumn:null,\n        onsort:null,\n        onselection:null,\n        onpaste:null,\n        onbeforepaste:null,\n        onmerge:null,\n        onfocus:null,\n        onblur:null,\n        onchangeheader:null,\n        oneditionstart:null,\n        oneditionend:null,\n        onchangestyle:null,\n        onchangemeta:null,\n        onchangepage:null,\n        // Customize any cell behavior\n        updateTable:null,\n        // Detach the HTML table when calling updateTable\r\n        detachForUpdates: false,\n        // Texts\n        text:{\n            noRecordsFound: 'No records found',\n            showingPage: 'Showing page {0} of {1} entries',\n            show: 'Show ',\n            search: 'Search',\n            entries: ' entries',\n            columnName: 'Column name',\n            insertANewColumnBefore: 'Insert a new column before',\n            insertANewColumnAfter: 'Insert a new column after',\n            deleteSelectedColumns: 'Delete selected columns',\n            renameThisColumn: 'Rename this column',\n            orderAscending: 'Order ascending',\n            orderDescending: 'Order descending',\n            insertANewRowBefore: 'Insert a new row before',\n            insertANewRowAfter: 'Insert a new row after',\n            deleteSelectedRows: 'Delete selected rows',\n            editComments: 'Edit comments',\n            addComments: 'Add comments',\n            comments: 'Comments',\n            clearComments: 'Clear comments',\n            copy: 'Copy...',\n            paste: 'Paste...',\n            saveAs: 'Save as...',\n            about: 'About',\n            areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\n            areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\n            thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\n            thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\n            thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\n            invalidMergeProperties: 'Invalid merged properties',\n            cellAlreadyMerged: 'Cell already merged',\n            noCellsSelected: 'No cells selected',\n        },\n        // About message\n        about:\"jExcel CE Spreadsheet\\nVersion 3.9.1\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel/v3\",\n    };\n\n    // Loading initial configuration from user\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            if (property === 'text') {\r\n                obj.options[property] = defaults[property];\r\n                for (var textKey in options[property]) {\r\n                    if (options[property].hasOwnProperty(textKey)){\r\n                        obj.options[property][textKey] = options[property][textKey];\r\n                    }\r\n                }\r\n            } else {\r\n                obj.options[property] = options[property];\n            }\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global elements\n    obj.el = el;\n    obj.corner = null;\n    obj.contextMenu = null;\n    obj.textarea = null;\n    obj.ads = null;\n    obj.content = null;\n    obj.table = null;\n    obj.thead = null;\n    obj.tbody = null;\n    obj.rows = [];\n    obj.results = null;\n    obj.searchInput = null;\n    obj.toolbar = null;\n    obj.pagination = null;\n    obj.pageNumber = null;\n    obj.headerContainer = null;\n    obj.colgroupContainer = null;\n\n    // Containers\n    obj.headers = [];\n    obj.records = [];\n    obj.history = [];\n    obj.formula = [];\n    obj.colgroup = [];\n    obj.selection = [];\n    obj.highlighted  = [];\n    obj.selectedCell = null;\n    obj.selectedContainer = null;\n    obj.style = [];\n    obj.data = null;\n\n    // Internal controllers\n    obj.cursor = null;\n    obj.historyIndex = -1;\n    obj.ignoreEvents = false;\n    obj.ignoreHistory = false;\n    obj.edition = null;\n    obj.hashString = null;\n    obj.resizing = null;\n    obj.dragging = null;\n\n    // Lazy loading\n    if (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\n        console.error('JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\n        obj.options.lazyLoading = false;\n    }\n    \n    /**\n     * Activate/Disable fullscreen \n     * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\n     * @Param {boolean} activate\n     */\n    obj.fullscreen = function(activate) {\n        // If activate not defined, get reverse options.fullscreen\n        if (activate == null) {\n            activate = ! obj.options.fullscreen;\n        }\n\n        // If change\n        if (obj.options.fullscreen != activate) {\n            obj.options.fullscreen = activate;\n\n            // Test LazyLoading conflict\n            if (activate == true) {\n                el.classList.add('fullscreen');\n            } else {\n                el.classList.remove('fullscreen');\n            }\n        } \n    }\n\n    /**\n     * Prepare the jexcel table\n     * \n     * @Param config\n     */\n    obj.prepareTable = function() {\n        // Loading initial data from remote sources\n        var results = [];\n\n        // Number of columns\n        var size = obj.options.columns.length;\n\n        if (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\n            // Data keys\n            var keys = Object.keys(obj.options.data[0]);\n\n            if (keys.length > size) {\n                size = keys.length;\n            }\n        }\n\n        // Minimal dimensions\n        if (obj.options.minDimensions[0] > size) {\n            size = obj.options.minDimensions[0];\n        }\n\n        // Requests\n        var multiple = [];\n\n        // Preparations\n        for (var i = 0; i < size; i++) {\n            // Deprected options. You should use only columns\n            if (! obj.options.colHeaders[i]) {\n                obj.options.colHeaders[i] = '';\n            }\n            if (! obj.options.colWidths[i]) {\n                obj.options.colWidths[i] = obj.options.defaultColWidth;\n            }\n            if (! obj.options.colAlignments[i]) {\n                obj.options.colAlignments[i] = obj.options.defaultColAlign;\n            }\n\n            // Default column description\n            if (! obj.options.columns[i]) {\n                obj.options.columns[i] = { type:'text' };\n            } else if (! obj.options.columns[i].type) {\n                obj.options.columns[i].type = 'text';\n            }\n            if (! obj.options.columns[i].name) {\n                obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\n            }\n            if (! obj.options.columns[i].source) {\n                obj.options.columns[i].source = [];\n            }\n            if (! obj.options.columns[i].options) {\n                obj.options.columns[i].options = [];\n            }\n            if (! obj.options.columns[i].editor) {\n                obj.options.columns[i].editor = null;\n            }\n            if (! obj.options.columns[i].allowEmpty) {\n                obj.options.columns[i].allowEmpty = false;\n            }\n            if (! obj.options.columns[i].title) {\n                obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\n            }\n            if (! obj.options.columns[i].width) {\n                obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\n            }\n            if (! obj.options.columns[i].align) {\n                obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\n            }\n\n            // Pre-load initial source for json autocomplete\n            if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\n                // if remote content\n                if (obj.options.columns[i].url) {\n                    multiple.push(jSuites.ajax({\n                        url: obj.options.columns[i].url,\n                        index: i,\n                        method: 'GET',\n                        dataType: 'json',\n                        multiple: multiple,\n                        success: function(data) {\n                            var source = [];\n                            for (var i = 0; i < data.length; i++) {\n                                obj.options.columns[this.index].source.push(data[i]);\n                            }\n                        },\n                        complete: function() {\n                            obj.createTable();\n                        }\n                    }));\n                }\n            } else if (obj.options.columns[i].type == 'calendar') {\n                // Default format for date columns\n                if (! obj.options.columns[i].options.format) {\n                    obj.options.columns[i].options.format = 'DD/MM/YYYY';\n                }\n            }\n        }\n\n        // On complete\n        if (! multiple.length) {\n            obj.createTable();\n        }\n    }\n\n    obj.createTable = function() {\n        // Elements\n        obj.table = document.createElement('table');\n        obj.thead = document.createElement('thead');\n        obj.tbody = document.createElement('tbody');\n\n        // Create headers controllers\n        obj.headers = [];\n        obj.colgroup = [];\n\n        // Create table container\n        obj.content = document.createElement('div');\n        obj.content.classList.add('jexcel_content');\n\n        // Create toolbar object\n        obj.toolbar = document.createElement('div');\n        obj.toolbar.classList.add('jexcel_toolbar');\n\n        // Search\n        var searchContainer = document.createElement('div');\n        var searchText = document.createTextNode((obj.options.text.search) + ': ');\n        obj.searchInput = document.createElement('input');\n        obj.searchInput.classList.add('jexcel_search');\n        searchContainer.appendChild(searchText);\n        searchContainer.appendChild(obj.searchInput);\n        obj.searchInput.onfocus = function() {\n            obj.resetSelection();\n        }\n\n        // Pagination select option\n        var paginationUpdateContainer = document.createElement('div');\n\n        if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\n            obj.paginationDropdown = document.createElement('select');\n            obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\n            obj.paginationDropdown.onchange = function() {\n                obj.options.pagination = parseInt(this.value);\n                obj.page(0);\n            }\n\n            for (var i = 0; i < obj.options.paginationOptions.length; i++) {\n                var temp = document.createElement('option');\n                temp.value = obj.options.paginationOptions[i];\n                temp.innerHTML = obj.options.paginationOptions[i];\n                obj.paginationDropdown.appendChild(temp);\n            }\n\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\n            paginationUpdateContainer.appendChild(obj.paginationDropdown);\n            paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\n        }\n\n        // Filter and pagination container\n        obj.filter = document.createElement('div');\n        obj.filter.classList.add('jexcel_filter');\n        obj.filter.appendChild(paginationUpdateContainer);\n        obj.filter.appendChild(searchContainer);\n\n        // Colsgroup\n        obj.colgroupContainer = document.createElement('colgroup');\n        var tempCol = document.createElement('col');\n        tempCol.setAttribute('width', '50');\n        obj.colgroupContainer.appendChild(tempCol);\n\n        // Nested\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\n                }\n            } else {\n                obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\n            }\n        }\n\n        // Row\n        obj.headerContainer = document.createElement('tr');\n        var tempCol = document.createElement('td');\n        tempCol.classList.add('jexcel_selectall');\n        obj.headerContainer.appendChild(tempCol);\n\n        for (var i = 0; i < obj.options.columns.length; i++) {\n            // Create header\n            obj.createCellHeader(i);\n            // Append cell to the container\n            obj.headerContainer.appendChild(obj.headers[i]);\n            obj.colgroupContainer.appendChild(obj.colgroup[i]);\n        }\n\n        obj.thead.appendChild(obj.headerContainer);\n\n        // Content table\n        obj.table = document.createElement('table');\n        obj.table.classList.add('jexcel');\n        obj.table.setAttribute('cellpadding', '0');\n        obj.table.setAttribute('cellspacing', '0');\n        obj.table.setAttribute('unselectable', 'yes');\n        obj.table.setAttribute('onselectstart', 'return false');\n        obj.table.appendChild(obj.colgroupContainer);\n        obj.table.appendChild(obj.thead);\n        obj.table.appendChild(obj.tbody);\n\n        // Spreadsheet corner\n        obj.corner = document.createElement('div');\n        obj.corner.className = 'jexcel_corner';\n        obj.corner.setAttribute('unselectable', 'on');\n        obj.corner.setAttribute('onselectstart', 'return false');\n\n        if (obj.options.selectionCopy == false) {\n            obj.corner.style.display = 'none';\n        }\n\n        // Textarea helper\n        obj.textarea = document.createElement('textarea');\n        obj.textarea.className = 'jexcel_textarea';\n        obj.textarea.id = 'jexcel_textarea';\n        obj.textarea.tabIndex = '-1';\r\n\n        // Contextmenu container\n        obj.contextMenu = document.createElement('div');\n        obj.contextMenu.className = 'jexcel_contextmenu';\n\n        // Create element\n        jSuites.contextmenu(obj.contextMenu, {\n            onclick:function() {\n                obj.contextMenu.contextmenu.close(false);\n            }\n        });\n\n        // Powered by jExcel\r\n        var ads = document.createElement('a');\r\n        ads.setAttribute('href', 'https://bossanova.uk/jexcel/');\r\n        obj.ads = document.createElement('div');\r\n        obj.ads.className = 'jexcel_about';\r\n        if (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n            sessionStorage.setItem('jexcel', true);\r\n            var img = document.createElement('img');\r\n            img.src = '//bossanova.uk/jexcel/logo.png';\r\n            ads.appendChild(img);\r\n        }\r\n        var span = document.createElement('span');\r\n        span.innerHTML = 'Jexcel spreadsheet';\r\n        ads.appendChild(span);\r\n        obj.ads.appendChild(ads);\n\n        // Create table container TODO: frozen columns\n        var container = document.createElement('div');\n        container.classList.add('jexcel_table');\n\n        // Pagination\n        obj.pagination = document.createElement('div');\n        obj.pagination.classList.add('jexcel_pagination');\n        var paginationInfo = document.createElement('div');\n        var paginationPages = document.createElement('div');\n        obj.pagination.appendChild(paginationInfo);\n        obj.pagination.appendChild(paginationPages);\n\n        // Hide pagination if not in use\r\n        if (! obj.options.pagination) {\r\n            obj.pagination.style.display = 'none';\r\n        }\r\n\n        // Append containers to the table\n        if (obj.options.search == true) {\n            el.appendChild(obj.filter);\n        }\n\n        // Elements\n        obj.content.appendChild(obj.table);\n        obj.content.appendChild(obj.corner);\n        obj.content.appendChild(obj.textarea);\n\n        el.appendChild(obj.toolbar);\n        el.appendChild(obj.content);\n        el.appendChild(obj.pagination);\n        el.appendChild(obj.contextMenu);\n        el.appendChild(obj.ads);\n        el.classList.add('jexcel_container');\n\n        // Create toolbar\n        if (obj.options.toolbar && obj.options.toolbar.length) {\n            obj.createToolbar();\n        }\n\n        // Fullscreen\n        if (obj.options.fullscreen == true) {\n            el.classList.add('fullscreen');\n        } else {\n            // Overflow\n            if (obj.options.tableOverflow == true) {\n                if (obj.options.tableHeight) {\n                    obj.content.style['overflow-y'] = 'auto';\n                    obj.content.style.maxHeight = obj.options.tableHeight;\n                }\n                if (obj.options.tableWidth) {\n                    obj.content.style['overflow-x'] = 'auto';\n                    obj.content.style.width = obj.options.tableWidth;\n                }\n            }\n        }\n\n        // With toolbars\n        if (obj.options.tableOverflow != true && obj.options.toolbar) {\n            el.classList.add('with-toolbar');\n        }\n\n        // Actions\n        if (obj.options.columnDrag == true) {\n            obj.thead.classList.add('draggable');\n        }\n        if (obj.options.columnResize == true) {\n            obj.thead.classList.add('resizable');\n        }\n        if (obj.options.rowDrag == true) {\n            obj.tbody.classList.add('draggable');\n        }\n        if (obj.options.rowResize == true) {\n            obj.tbody.classList.add('resizable');\n        }\n\n        // Load data\n        obj.setData();\n\n        // Style\n        if (obj.options.style) {\n            obj.setStyle(obj.options.style, null, null, 1, 1);\n        }\n    }\n\r\n    /**\r\n     * Refresh the data\r\n     * \r\n     * @return void\r\n     */\r\n    obj.refresh = function() {\r\n        if (obj.options.url) {\r\n            // Loading\r\n            if (obj.options.loadingSpin == true) {\r\n                jSuites.loading.show();\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Data\r\n                    obj.options.data = (result.data) ? result.data : result;\r\n                    // Prepare table\r\n                    obj.setData();\r\n                    // Hide spin\r\n                    if (obj.options.loadingSpin == true) {\r\n                        jSuites.loading.hide();\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            obj.setData();\r\n        }\r\n    }\r\n\n    /**\n     * Set data\n     * \n     * @param array data In case no data is sent, default is reloaded\n     * @return void\n     */\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            if (typeof(data) == 'string') {\n                data = JSON.parse(data);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Data\n        if (! obj.options.data) {\n            obj.options.data = [];\n        }\n\n        // Prepare data\n        if (obj.options.data) {\n            var data = [];\n            for (var j = 0; j < obj.options.data.length; j++) {\n                var row = [];\n                for (var i = 0; i < obj.options.columns.length; i++) {\n                    row[i] = obj.options.data[j][obj.options.columns[i].name];\n                }\n                data.push(row);\n            }\n\n            obj.options.data = data;\n        }\n\n        // Adjust minimal dimensions\n        var j = 0;\n        var i = 0;\n        var size_i = obj.options.columns.length;\n        var size_j = obj.options.data.length;\n        var min_i = obj.options.minDimensions[0];\n        var min_j = obj.options.minDimensions[1];\n        var max_i = min_i > size_i ? min_i : size_i;\n        var max_j = min_j > size_j ? min_j : size_j;\n\n        for (j = 0; j < max_j; j++) {\n            for (i = 0; i < max_i; i++) {\n                if (obj.options.data[j] == undefined) {\n                    obj.options.data[j] = [];\n                }\n\n                if (obj.options.data[j][i] == undefined) {\n                    obj.options.data[j][i] = '';\n                }\n            }\n        }\n\n        // Reset containers\n        obj.rows = [];\n        obj.results = null;\n        obj.records = [];\n        obj.history = [];\n\n        // Reset internal controllers\n        obj.historyIndex = -1;\n\n        // Reset data\n        obj.tbody.innerHTML = '';\n\n        // Lazy loading\n        if (obj.options.lazyLoading == true) {\n            // Load only 100 records\n            var startNumber = 0\n            var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\n\n            if (obj.options.pagination) {\n                obj.options.pagination = false;\n                console.error('JEXCEL: Pagination will be disable due the lazyLoading');\n            }\n        } else if (obj.options.pagination) {\n            // Pagination\n            if (! obj.pageNumber) {\n                obj.pageNumber = 0;\n            }\n            var quantityPerPage = obj.options.pagination;\n            startNumber = (obj.options.pagination * obj.pageNumber);\n            finalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\n\n            if (obj.options.data.length < finalNumber) {\n                finalNumber = obj.options.data.length;\n            }\n        } else {\n            var startNumber = 0;\n            var finalNumber = obj.options.data.length;\n        }\n\n        // Append nodes to the HTML\n        for (j = 0; j < obj.options.data.length; j++) {\n            // Create row\n            var tr = obj.createRow(j, obj.options.data[j]);\n            // Append line to the table\n            if (j >= startNumber && j < finalNumber) {\n                obj.tbody.appendChild(tr);\n            }\n        }\n\n        if (obj.options.lazyLoading == true) {\n            // Do not create pagination with lazyloading activated\n        } else if (obj.options.pagination) {\n            obj.updatePagination();\n        }\n\n        // Merge cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var num = obj.options.mergeCells[keys[i]];\n                obj.setMerge(keys[i], num[0], num[1], 1);\n            }\n        }\n\n        // Updata table with custom configurations if applicable\n        obj.updateTable();\n\n        // Onload\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj);\n            }\n        }\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param bool get highlighted cells only\n     * @return array data\n     */\n        obj.getData = function(highlighted, dataOnly) {\n        // Control vars\n        var dataset = [];\n        var px = 0;\n        var py = 0;\n\n        // Data type\r\n        var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            px = 0;\n            for (var i = 0; i < x; i++) {\n                // Cell selected or fullset\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Get value\n                    if (! dataset[py]) {\n                        dataset[py] = [];\n                    }\n                    if (! dataType) {\n                        dataset[py][px] = obj.records[j][i].innerHTML;\n                    } else {\n                        dataset[py][px] = obj.options.data[j][i];\n                    }\n                    px++;\n                }\n            }\n            if (px > 0) {\n                py++;\n            }\n       }\n\n       return dataset;\n    }\n\n    /**\n     * Get the whole table data\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.getJson = function(highlighted) {\n        // Control vars\n        var data = [];\n\n        // Column and row length\n        var x = obj.options.columns.length\n        var y = obj.options.data.length\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            var row = null;\n            for (var i = 0; i < x; i++) {\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    if (row == null) {\n                        row = {};\n                    }\n                    row[obj.options.columns[i].name] = obj.options.data[j][i];\n                }\n            }\n\n            if (row != null) {\n                data.push(row);\n            }\n       }\n\n       return data;\n    }\n\n    /**\n     * Get a row data by rowNumber\n     */\n    obj.getRowData = function(rowNumber) {\n        return obj.options.data[rowNumber];\n    }\n\n    /**\n     * Set a row data by rowNumber\n     */\n    obj.setRowData = function(rowNumber, data) {\n        for (var i = 0; i < obj.headers.length; i++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\n            // Set value\n            if (data[i] != null) {\n                obj.setValue(columnName, data[i]);\n            }\n        }\n    }\n\n    /**\n     * Get a column data by columnNumber\n     */\n    obj.getColumnData = function(columnNumber) {\n        var dataset = [];\n        // Go through the rows to get the data\n        for (var j = 0; j < obj.options.data.length; j++) {\n            dataset.push(obj.options.data[j][columnNumber]);\n        }\n        return dataset;\n    }\n\n    /**\n     * Set a column data by colNumber\n     */\n    obj.setColumnData = function(colNumber, data) {\n        for (var j = 0; j < obj.rows.length; j++) {\n            // Update cell\n            var columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\n            // Set value\n            if (data[j] != null) {\n                obj.setValue(columnName, data[j]);\n            }\n        }\n    }\n\n    /**\n     * Create row\n     */\n    obj.createRow = function(j, data) {\n        // Create container\n        if (! obj.records[j]) {\n            obj.records[j] = [];\n        }\n        // Default data\n        if (! data) {\n            var data = obj.options.data[j];\n        }\n        // New line of data to be append in the table\n        obj.rows[j] = document.createElement('tr');\n        obj.rows[j].setAttribute('data-y', j);\n        // Definitions\n        if (obj.options.rows[j]) {\n            if (obj.options.rows[j].height) {\n                obj.rows[j].style.height = obj.options.rows[j].height;\n            }\n        }\n        // Row number label\n        var td = document.createElement('td');\n        td.innerHTML = parseInt(j + 1);\n        td.setAttribute('data-y', j);\n        td.className = 'jexcel_row';\n        obj.rows[j].appendChild(td);\n\n        // Data columns\n        for (i = 0; i < obj.options.columns.length; i++) {\n            // New column of data to be append in the line\n            obj.records[j][i] = obj.createCell(i, j, data[i]);\n            // Add column to the row\n            obj.rows[j].appendChild(obj.records[j][i]);\n        }\n\n        // Add row to the table body\n        return obj.rows[j];\n    }\n\n    /**\n     * Create cell\n     */\n    obj.createCell = function(i, j, value) {\n        // Create cell and properties\n        var td = document.createElement('td');\n        td.setAttribute('data-x', i);\n        td.setAttribute('data-y', j);\n        // Hidden column\n        if (obj.options.columns[i].type == 'hidden') {\n            td.style.display = 'none';\n            td.innerHTML = value;\n        } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n            // Create input\n            var element = document.createElement('input');\n            element.type = obj.options.columns[i].type;\n            element.name = 'c' + i;\n            element.checked = (value == 1 || value == true || value == 'true') ? true : false;\n            element.onclick = function() {\n                obj.setValue(td, this.checked);\n            }\n\n            if (obj.options.columns[i].readOnly == true) {\n                element.setAttribute('disabled', 'disabled');\n            }\n\n            // Append to the table\n            td.appendChild(element);\n            // Make sure the values are correct\n            obj.options.data[j][i] = element.checked;\n        } else if (obj.options.columns[i].type == 'calendar') {\n            // Try formatted date\n            var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\n            // Create calendar cell\n            td.innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\n        } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\n            // Create dropdown cell\n            td.classList.add('jexcel_dropdown');\n            td.innerHTML = obj.getDropDownValue(i, value);\n        } else if (obj.options.columns[i].type == 'color') {\n            if (obj.options.columns[i].render == 'square') {\n                var color = document.createElement('div');\n                color.className = 'color';\n                color.style.backgroundColor = value;\n                td.appendChild(color);\n            } else {\n                td.style.color = value;\n                td.innerHTML = value;\n            }\n        } else if (obj.options.columns[i].type == 'image') {\n            if (value && value.substr(0, 10) == 'data:image') {\n                var img = document.createElement('img');\n                img.src = value;\n                td.appendChild(img);\n            }\n        } else {\n            if ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\n                value = obj.executeFormula(value, i, j)\n            }\n            if (obj.options.columns[i].mask) {\n                var decimal = obj.options.columns[i].decimal || '.';\n                value = '' + jSuites.mask.run(value, obj.options.columns[i].mask, decimal);\n            }\n\n            td.innerHTML = value;\n        }\n\n        // Readonly\n        if (obj.options.columns[i].readOnly == true) {\n            td.className = 'readonly';\n        }\n\n        // Text align\n        var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\n        td.style.textAlign = colAlign;\n\n        // Wrap option\n        if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\n            td.style.whiteSpace = 'pre-wrap';\n        }\n\n        // Overflow\n        if (i > 0) {\n            if (value || td.innerHTML) {\n                obj.records[j][i-1].style.overflow = 'hidden';\n            } else {\n                if (i == obj.options.columns.length - 1) {\n                    td.style.overflow = 'hidden';\n                }\n            }\n        }\n\n        return td;\n    }\n\n    obj.createCellHeader = function(colNumber) {\n        // Create col global control\n        var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\n        var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\n\n        // Create header cell\n        obj.headers[colNumber] = document.createElement('td');\n        obj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\n        obj.headers[colNumber].setAttribute('data-x', colNumber);\n        obj.headers[colNumber].style.textAlign = colAlign;\n        if (obj.options.columns[colNumber].title) {\n            obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\n        }\n\n        // Width control\n        obj.colgroup[colNumber] = document.createElement('col');\n        obj.colgroup[colNumber].setAttribute('width', colWidth);\n\n        // Hidden column\n        if (obj.options.columns[colNumber].type == 'hidden') {\n            obj.headers[colNumber].style.display = 'none';\n            obj.colgroup[colNumber].style.display = 'none';\n        }\n    }\n\n    obj.createNestedHeader = function(nestedInformation) {\n        var tr = document.createElement('tr');\n        tr.classList.add('jexcel_nested');\n        var td = document.createElement('td');\n        tr.appendChild(td);\n\n        var headerIndex = 0;\n        for (var i = 0; i < nestedInformation.length; i++) {\n            // Default values\n            if (! nestedInformation[i].colspan) {\n                nestedInformation[i].colspan = 1;\n            }\n            if (! nestedInformation[i].align) {\n                nestedInformation[i].align = 'center';\n            }\n            if (! nestedInformation[i].title) {\n                nestedInformation[i].title = '';\n            }\n\n            // Number of columns\n            var numberOfColumns = nestedInformation[i].colspan;\n\n            // Classes container\n            var column = [];\n            // Header classes for this cell\n            for (var x = 0; x < numberOfColumns; x++) {\n                if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\n                    numberOfColumns++;\n                }\n                column.push(headerIndex);\n                headerIndex++;\n            }\n\n            // Created the nested cell\n            var td = document.createElement('td');\n            td.setAttribute('data-column', column.join(','));\n            td.setAttribute('colspan', nestedInformation[i].colspan);\n            td.setAttribute('align', nestedInformation[i].align);\n            td.innerHTML = nestedInformation[i].title;\n            tr.appendChild(td);\n        }\n\n        return tr;\n    }\n\n    /**\n     * Create toolbar\n     */\n    obj.createToolbar = function(toolbar) {\n        if (toolbar) {\n            obj.options.toolbar = toolbar;\n        } else {\n            var toolbar = obj.options.toolbar;\n        }\n\n        for (var i = 0; i < toolbar.length; i++) {\n            if (toolbar[i].type == 'i') {\n                var toolbarItem = document.createElement('i');\n                toolbarItem.classList.add('jexcel_toolbar_item');\n                toolbarItem.classList.add('material-icons');\n                toolbarItem.setAttribute('data-k', toolbar[i].k);\n                toolbarItem.setAttribute('data-v', toolbar[i].v);\n                // Tooltip\n                if (toolbar[i].tooltip) {\n                    toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                }\n                // Handle click\n                if (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\n                    toolbarItem.onclick = toolbar[i].onclick;\n                } else {\n                    toolbarItem.onclick = function() {\n                        var k = this.getAttribute('data-k');\n                        var v = this.getAttribute('data-v');\n                        obj.setStyle(obj.highlighted, k, v);\n                    }\n                }\n                // Append element\n                toolbarItem.innerHTML = toolbar[i].content;\n                obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'select') {\n               var toolbarItem = document.createElement('select');\n               toolbarItem.classList.add('jexcel_toolbar_item');\n               toolbarItem.setAttribute('data-k', toolbar[i].k);\n               // Tooltip\n               if (toolbar[i].tooltip) {\n                   toolbarItem.setAttribute('title', toolbar[i].tooltip);\n               }\n               // Handle onchange\n               if (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\n                   toolbarItem.onchange = toolbar[i].onchange;\n               } else {\n                   toolbarItem.onchange = function() {\n                       var k = this.getAttribute('data-k');\n                       obj.setStyle(obj.highlighted, k, this.value);\n                   }\n               }\n               // Add options to the dropdown\n               for(var j = 0; j < toolbar[i].v.length; j++) {\n                    var toolbarDropdownOption = document.createElement('option');\n                    toolbarDropdownOption.value = toolbar[i].v[j];\n                    toolbarDropdownOption.innerHTML = toolbar[i].v[j];\n                    toolbarItem.appendChild(toolbarDropdownOption);\n               }\n               obj.toolbar.appendChild(toolbarItem);\n            } else if (toolbar[i].type == 'color') {\n                 var toolbarItem = document.createElement('i');\n                 toolbarItem.classList.add('jexcel_toolbar_item');\n                 toolbarItem.classList.add('material-icons');\n                 toolbarItem.setAttribute('data-k', toolbar[i].k);\n                 toolbarItem.setAttribute('data-v', '');\n                 // Tooltip\n                 if (toolbar[i].tooltip) {\n                     toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                 }\n                 obj.toolbar.appendChild(toolbarItem);\n                 toolbarItem.onclick = function() {\n                     this.color.open();\n                 }\n                 toolbarItem.innerHTML = toolbar[i].content;\n                 jSuites.color(toolbarItem, {\n                     onchange:function(o, v) {\n                         var k = o.getAttribute('data-k');\n                         obj.setStyle(obj.highlighted, k, v);\n                     }\n                 });\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\n        var test = false;\n\n        if (! cellName) {\n            if (! obj.highlighted.length) {\n                alert(obj.options.text.noCellsSelected);\n                return null;\n            } else {\n                var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\n                var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\n                var x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\n                var y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\n                var cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\n                var colspan = (x2 - x1) + 1;\n                var rowspan = (y2 - y1) + 1;\n            }\n        }\n\n        var cell = jexcel.getIdFromColumnName(cellName, true);\n\n        if (obj.options.mergeCells[cellName]) {\n            if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\n                test = obj.options.text.cellAlreadyMerged;\n            }\n        } else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\n            test = obj.options.text.invalidMergeProperties;\n        } else {\n            var cells = [];\n            for (var j = cell[1]; j < cell[1] + rowspan; j++) {\n                for (var i = cell[0]; i < cell[0] + colspan; i++) {\n                    var columnName = jexcel.getColumnNameFromId([i, j]);\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\n                    }\n                }\n            }\n        }\n\n        if (test) {\n            alert(test);\n        } else {\n            // Add property\n            if (colspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\n            } else {\n                colspan = 1;\n            }\n            if (rowspan > 1) {\n                obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\n            } else {\n                rowspan = 1;\n            }\n            // Keep links to the existing nodes\n            obj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\n            // Mark cell as merged\n            obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\n            // Overflow\n            obj.records[cell[1]][cell[0]].style.overflow = 'hidden';\n            // History data\n            var data = [];\n            // Adjust the nodes\n            for (var y = cell[1]; y < cell[1] + rowspan; y++) {\n                for (var x = cell[0]; x < cell[0] + colspan; x++) {\n                    if (! (cell[0] == x && cell[1] == y)) {\n                        data.push(obj.options.data[y][x]);\n                        obj.updateCell(x, y, '', true);\n                        obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\n                        obj.records[y][x].style.display = 'none';\n                        obj.records[y][x] = obj.records[cell[1]][cell[0]];\n                    }\n                }\n            }\n            // In the initialization is not necessary keep the history\n            obj.updateSelection(obj.records[cell[1]][cell[0]]);\n\n            if (! ignoreHistoryAndEvents) {\n                obj.setHistory({\n                    action:'setMerge',\n                    column:cellName,\n                    colspan:colspan,\n                    rowspan:rowspan,\n                    data:data,\n                });\n\n                if (typeof(obj.options.onmerge) == 'function') {\n                    obj.options.onmerge(el, cellName, colspan, rowspan);\n                }\n            }\n        }\n    }\n\n    /**\n     * Merge cells\n     * @param cellName\n     * @param colspan\n     * @param rowspan\n     * @param ignoreHistoryAndEvents\n     */\n    obj.getMerge = function(cellName) {\n        var data = {};\n        if (cellName) {\n            if (obj.options.mergeCells[cellName]) {\n                data = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\n            } else {\n                data = null;\n            }\n        } else {\n            if (obj.options.mergeCells) {\n                var mergedCells = obj.options.mergeCells;\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    data[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\n                }\n            }\n        }\n\n        return data;\n    }\n\n    /**\n     * Remove merge by cellname\n     * @param cellName\n     */\n    obj.removeMerge = function(cellName, data, keepOptions) {\n        if (obj.options.mergeCells[cellName]) {\n            var cell = jexcel.getIdFromColumnName(cellName, true);\n            obj.records[cell[1]][cell[0]].removeAttribute('colspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\n            obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\n            var info = obj.options.mergeCells[cellName];\n\n            var index = 0;\n            for (var j = 0; j < info[1]; j++) {\n                for (var i = 0; i < info[0]; i++) {\n                    if (j > 0 || i > 0) {\n                        obj.records[cell[1]+j][cell[0]+i] = info[2][index];\n                        obj.records[cell[1]+j][cell[0]+i].style.display = '';\n                        // Recover data\n                        if (data && data[index]) {\n                            obj.updateCell(cell[0]+i, cell[1]+j, data[index]);\n                        }\n                        index++;\n                    }\n                }\n            }\n\n            // Update selection\n            obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\n\n            if (! keepOptions) {\n                delete(obj.options.mergeCells[cellName]);\n            }\n        }\n    }\n\n    /**\n     * Remove all merged cells\n     */\n    obj.destroyMerged = function(keepOptions) {\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var mergedCells = obj.options.mergeCells;\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                obj.removeMerge(keys[i], null, keepOptions);\n            }\n        }\n    }\n\n    /**\n     * Is column merged\n     */\n    obj.isColMerged = function(x, insertBefore) {\n        var cols = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var colspan = obj.options.mergeCells[keys[i]][0];\n                var x1 = info[0];\n                var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((x1 <= x && x2 >= x)) {\n                        cols.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((x1 < x && x2 >= x)) {\n                            cols.push(keys[i]);\n                        }\n                    } else {\n                        if ((x1 <= x && x2 > x)) {\n                            cols.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Is rows merged\n     */\n    obj.isRowMerged = function(y, insertBefore) {\n        var rows = [];\n        // Remove any merged cells\n        if (obj.options.mergeCells) {\n            var keys = Object.keys(obj.options.mergeCells);\n            for (var i = 0; i < keys.length; i++) {\n                var info = jexcel.getIdFromColumnName(keys[i], true);\n                var rowspan = obj.options.mergeCells[keys[i]][1];\n                var y1 = info[1];\n                var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\n\n                if (insertBefore == null) {\n                    if ((y1 <= y && y2 >= y)) {\n                        rows.push(keys[i]);\n                    }\n                } else {\n                    if (insertBefore) {\n                        if ((y1 < y && y2 >= y)) {\n                            rows.push(keys[i]);\n                        }\n                    } else {\n                        if ((y1 <= y && y2 > y)) {\n                            rows.push(keys[i]);\n                        }\n                    }\n                }\n            }\n        }\n\n        return rows;\n    }\n\n    /**\n     * Open the editor\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.openEditor = function(cell, empty, e) {\n        // Get cell position\n        var y = cell.getAttribute('data-y');\n        var x = cell.getAttribute('data-x');\n\n        // On edition start\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionstart) == 'function') {\n                obj.options.oneditionstart(el, cell, x, y);\n            }\n        }\n\n        // Overflow\n        if (x > 0) {\n            obj.records[y][x-1].style.overflow = 'hidden';\n        }\n\n        // Create editor\n        var createEditor = function(type) {\n            // Cell information\n            var info = cell.getBoundingClientRect();\n\n            // Create dropdown\n            var editor = document.createElement(type);\n            editor.style.width = (info.width) + 'px';\n            editor.style.height = (info.height - 2) + 'px';\n            editor.style.minHeight = (info.height - 2) + 'px';\n\n            // Edit cell\n            cell.classList.add('editor');\n            cell.innerHTML = '';\n            cell.appendChild(editor);\n\n            return editor;\n        }\n\n        // Readonly\n        if (cell.classList.contains('readonly') == true) {\n            // Do nothing\n        } else {\n            // Holder\n            obj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\n\n            // If there is a custom editor for it\n            if (obj.options.columns[x].editor) {\n                // Custom editors\n                obj.options.columns[x].editor.openEditor(cell, el, empty, e);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Get value\n                    var value = cell.children[0].checked ? false : true;\n                    // Toogle value\n                    obj.setValue(cell, value);\n                    // Do not keep edition open\n                    obj.edition = null;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Get current value\n                    var value = obj.options.data[y][x];\n\n                    // Create dropdown\n                    if (typeof(obj.options.columns[x].filter) == 'function') {\n                        var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\n                    } else {\n                        var source = obj.options.columns[x].source;\n                    }\n\n                    // Create editor\n                    var editor = createEditor('div');\n                    var options = {\n                        data: source,\n                        multiple: obj.options.columns[x].multiple ? true : false,\n                        autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\n                        opened:true,\n                        value: obj.options.columns[x].multiple ? value.split(';') : value,\n                        width:'100%',\n                        height:editor.style.minHeight,\n                        position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\n                        onclose:function() {\n                            obj.closeEditor(cell, true);\n                        }\n                    };\n                    if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\n                        options.type = obj.options.columns[x].options.type;\n                    }\n                    jSuites.dropdown(editor, options);\n                } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\n                    // Value\n                    var value = obj.options.data[y][x];\n                    // Create editor\n                    var editor = createEditor('input');\n                    editor.value = value;\n\n                    if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\n                        obj.options.columns[x].options.position = true;\n                    }\n                    obj.options.columns[x].options.value = obj.options.data[y][x];\n                    obj.options.columns[x].options.opened = true;\n                    obj.options.columns[x].options.onclose = function(el, value) {\n                        obj.closeEditor(cell, true);\n                    }\n                    // Current value\n                    if (obj.options.columns[x].type == 'color') {\n                        jSuites.color(editor, obj.options.columns[x].options);\n                    } else {\n                        var calendar = jSuites.calendar(editor, obj.options.columns[x].options);\n                        calendar.setValue(value);\n                    }\n                    // Focus on editor\n                    editor.focus();\n                } else if (obj.options.columns[x].type == 'image') {\n                    // Value\n                    var img = cell.children[0];\n                    // Create editor\n                    var editor = createEditor('div');\n                    editor.style.position = 'relative';\n                    var div = document.createElement('div');\n                    div.classList.add('jclose');\n                    if (img && img.src) {\n                        div.appendChild(img);\n                    }\n                    editor.appendChild(div);\n                    jSuites.image(div, obj.options.imageOptions);\n                    const rect = cell.getBoundingClientRect();\n                    const rectContent = div.getBoundingClientRect();\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        div.style.top = (rect.top) + 'px';\n                    }\n                } else {\n                    // Value\n                    var value = empty == true ? '' : obj.options.data[y][x];\n\n                    // Basic editor\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\n                        var editor = createEditor('textarea');\n                    } else {\n                        var editor = createEditor('input');\n                        // Mask\n                        if (obj.options.columns[x].mask) {\n                            editor.setAttribute('data-mask', obj.options.columns[x].mask);\n                        }\n                    }\n\n                    editor.value = value;\n                    editor.onblur = function() {\n                        obj.closeEditor(cell, true);\n                    };\n                    editor.focus();\n                }\n            }\n        }\n    }\n\n    /**\n     * Close the editor and save the information\n     * \n     * @param object cell\n     * @param boolean save\n     * @return void\n     */\n    obj.closeEditor = function(cell, save) {\n        var x = parseInt(cell.getAttribute('data-x'));\n        var y = parseInt(cell.getAttribute('data-y'));\n\n        // Get cell properties\n        if (save == true) {\n            // If custom editor\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                var value = obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\n                    // Do nothing\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    var value = cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    var value = cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    var value = cell.children[1].color.close(true);\n                } else if (obj.options.columns[x].type == 'image') {\n                    var img = cell.children[0].children[0].children[0];\n                    var value = img && img.tagName == 'IMG' ? img.src : '';\n                } else if (obj.options.columns[x].type == 'numeric') {\n                    var value = cell.children[0].value;\n                    if (value.substr(0,1) != '=') {\n                        if (value == '') {\n                            value = obj.options.columns[x].allowEmpty ? '' : 0;\n                        }\n                    }\n                    cell.children[0].onblur = null;\n                } else {\n                    var value = cell.children[0].value;\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Ignore changes if the value is the same\n            if (obj.options.data[y][x] == value) {\n                cell.innerHTML = obj.edition[1];\n            } else {\n                obj.setValue(cell, value);\n            }\n        } else {\n            if (obj.options.columns[x].editor) {\n                // Custom editor\n                obj.options.columns[x].editor.closeEditor(cell, save);\n            } else {\n                if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    cell.children[0].dropdown.close(true);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    cell.children[0].calendar.close(true);\n                } else if (obj.options.columns[x].type == 'color') {\n                    cell.children[1].color.close(true);\n                } else {\n                    cell.children[0].onblur = null;\n                }\n            }\n\n            // Restore value\n            cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\n        }\n\n        // On edition end\n        if (! obj.ignoreEvents) {\n            if (typeof(obj.options.oneditionend) == 'function') {\n                obj.options.oneditionend(el, cell, x, y, value, save);\n            }\n        }\n\n        // Remove editor class\n        cell.classList.remove('editor');\n\n        // Finish edition\n        obj.edition = null;\n    }\n\n    /**\n     * Get the cell object\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCell = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get the cell object from coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getCellFromCoords = function(x, y) {\n        return obj.records[y][x];\n    }\n\n    /**\n     * Get label\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabel = function(cell) {\n        // Convert in case name is excel liked ex. A10, BB92\n        cell = jexcel.getIdFromColumnName(cell, true);\n        var x = cell[0];\n        var y = cell[1];\n\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get labelfrom coords\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getLabelFromCoords = function(x, y) {\n        return obj.records[y][x].innerHTML;\n    }\n\n    /**\n     * Get the value from a cell\n     * \n     * @param object cell\n     * @return string value\n     */\n    obj.getValue = function(cell, processedValue) {\n        if (typeof(cell) == 'object') {\n            var x = cell.getAttribute('data-x');\n            var y = cell.getAttribute('data-y');\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n            var x = cell[0];\n            var y = cell[1];\n        }\n\n        var value = null;\n\n        if (x != null && y != null) {\n            if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Get the value from a coords\n     * \n     * @param int x\n     * @param int y\n     * @return string value\n     */\n    obj.getValueFromCoords = function(x, y, processedValue) {\n        var value = null;\n\n        if (x != null && y != null) {\n            if ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\n                value = obj.records[y][x].innerHTML;\n            } else {\n                if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                    value = obj.options.data[y][x];\n                }\n            }\n        }\n\n        return value;\n    }\n\n    /**\n     * Set a cell value\n     * \n     * @param mixed cell destination cell\n     * @param string value value\n     * @return void\n     */\n    obj.setValue = function(cell, value, force) {\n        var records = [];\n\n        if (typeof(cell) == 'string') {\n            var columnId = jexcel.getIdFromColumnName(cell, true);\n            var x = columnId[0];\n            var y = columnId[1];\n\n            // Update cell\n            records.push(obj.updateCell(x, y, value, force));\n\n            // Update all formulas in the chain\n            obj.updateFormulaChain(x, y, records);\n        } else {\n            var x = null;\n            var y = null;\n            if (cell && cell.getAttribute) {\n                var x = cell.getAttribute('data-x');\n                var y = cell.getAttribute('data-y');\n            }\n\n            // Update cell\n            if (x != null && y != null) {\n                records.push(obj.updateCell(x, y, value, force));\n\n                // Update all formulas in the chain\n                obj.updateFormulaChain(x, y, records);\n            } else {\n                var keys = Object.keys(cell);\n                if (keys.length > 0) {\n                    for (var i = 0; i < keys.length; i++) {\n                        if (typeof(cell[i]) == 'string') {\n                            var columnId = jexcel.getIdFromColumnName(cell[i], true);\n                            var x = columnId[0];\n                            var y = columnId[1];\n                        } else {\n                            var x = cell[i].getAttribute('data-x');\n                            var y = cell[i].getAttribute('data-y');\n                        }\n\n                         // Update cell\n                        if (x != null && y != null) {\n                            records.push(obj.updateCell(x, y, value, force));\n\n                            // Update all formulas in the chain\n                            obj.updateFormulaChain(x, y, records);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Set a cell value based on coordinates\n     * \n     * @param int x destination cell\n     * @param int y destination cell\n     * @param string value\n     * @return void\n     */\n    obj.setValueFromCoords = function(x, y, value, force) {\n        var records = [];\n        records.push(obj.updateCell(x, y, value, force));\n\n        // Update all formulas in the chain\n        obj.updateFormulaChain(x, y, records);\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configurations if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Toogle\n     */\n    obj.setCheckRadioValue = function() {\n        var records = [];\n        var keys = Object.keys(obj.highlighted);\n        for (var i = 0; i < keys.length; i++) {\n            var x = obj.highlighted[i].getAttribute('data-x');\n            var y = obj.highlighted[i].getAttribute('data-y');\n\n            if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                // Update cell\n                records.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\n            }\n        }\n\n        if (records.length) {\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Update cell content\n     * \n     * @param object cell\n     * @return void\n     */\n    obj.updateCell = function(x, y, value, force) {\n        // Changing value depending on the column type\n        if (obj.records[y][x].classList.contains('readonly') == true && ! force) {\n            // Do nothing\r\n            var record = {\r\n                x: x,\r\n                y: y,\r\n                col: x,\r\n                row: y\r\n            }\n        } else {\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onbeforechange) == 'function') {\n                    // Overwrite a value\n                    var val = obj.options.onbeforechange(el, obj.records[y][x], x, y, value);\n\n                    // If you return something this will overwrite the value\n                    if (val != undefined) {\n                        value = val;\n                    }\n                }\n            }\n\n            // History format\n            var record = {\n                x: x,\r\n                y: y,\n                col: x,\n                row: y,\n                newValue: value,\n                oldValue: obj.options.data[y][x],\n            }\n\n            if (obj.options.columns[x].editor) {\n                // Update data and cell\n                obj.options.data[y][x] = value;\n                obj.options.columns[x].editor.setValue(obj.records[y][x], value, force);\n            } else {\n                // Native functions\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Unchecked all options\n                    if (obj.options.columns[x].type == 'radio') {\n                        for (var j = 0; j < obj.options.data.length; j++) {\n                            obj.options.data[j][x] = false;\n                        }\n                    }\n\n                    // Update data and cell\n                    obj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\n                    obj.options.data[y][x] = obj.records[y][x].children[0].checked;\n                } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = obj.getDropDownValue(x, value);\n                } else if (obj.options.columns[x].type == 'calendar') {\n                    // Update calendar\n                    var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\n                } else if (obj.options.columns[x].type == 'color') {\n                    // Update color\n                    obj.options.data[y][x] = value;\n                    // Render\n                    if (obj.options.columns[x].render == 'square') {\n                        var color = document.createElement('div');\n                        color.className = 'color';\n                        color.style.backgroundColor = value;\n                        obj.records[y][x].innerHTML = '';\n                        obj.records[y][x].appendChild(color);\n                    } else {\n                    obj.records[y][x].style.color = value;\n                        obj.records[y][x].innerHTML = value;\n                    }\n                } else if (obj.options.columns[x].type == 'image') {\n                    value = ''+value;\n                    obj.options.data[y][x] = value;\n                    obj.records[y][x].innerHTML = '';\n                    if (value && value.substr(0, 10) == 'data:image') {\n                        var img = document.createElement('img');\n                        img.src = value;\n                        obj.records[y][x].appendChild(img);\n                    }\n                } else {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                    // Label\n                    if (('' + value).substr(0,1) == '='  && obj.options.parseFormulas == true) {\n                        value = obj.executeFormula(value, x, y);\n                    }\n                    if (obj.options.columns[x].mask) {\n                        var decimal = obj.options.columns[x].decimal || '.';\n                        value = '' + jSuites.mask.run(value, obj.options.columns[x].mask, decimal);\n                    }\n                    obj.records[y][x].innerHTML = value;\n\n                    // Handle big text inside a cell\n                    if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\n                        obj.records[y][x].style.whiteSpace = 'pre-wrap';\n                    } else {\n                        obj.records[y][x].style.whiteSpace = '';\n                    }\n                }\n            }\n\n            // Overflow\n            if (x > 0) {\n                if (value) {\n                    obj.records[y][x-1].style.overflow = 'hidden';\n                } else {\n                    obj.records[y][x-1].style.overflow = '';\n                }\n            }\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchange) == 'function') {\n                    obj.options.onchange(el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\n                }\n            }\n        }\n\n        return record;\n    }\n\n    /**\n     * Helper function to copy data using the corner icon\n     */\n    obj.copyData = function(o, d) {\n        // Get data from all selected cells\n        var data = obj.getData(true, true);\n\n        // Selected cells\r\n        var h = obj.selectedContainer;\n\n        // Cells\n        var x1 = parseInt(o.getAttribute('data-x'));\n        var y1 = parseInt(o.getAttribute('data-y'));\n        var x2 = parseInt(d.getAttribute('data-x'));\n        var y2 = parseInt(d.getAttribute('data-y'));\n\n        // Records\n        var records = [];\n        var breakControl = false;\n\n        if (h[0] == x1) {\r\n            // Vertical copy\r\n            if (y1 < h[1]) {\r\n                var rowNumber = y1 - h[1];\r\n            } else {\r\n                var rowNumber = 1;\r\n            }\r\n            var colNumber = 0;\r\n        } else {\r\n            if (x1 < h[0]) {\r\n                var colNumber = x1 - h[0];\r\n            } else {\r\n                var colNumber = 1;\r\n            }\r\n            var rowNumber = 0;\r\n        }\r\n\n        // Copy data procedure\n        var posx = 0;\n        var posy = 0;\n\n        for (var j = y1; j <= y2; j++) {\n            // Skip hidden rows\n            if (obj.rows[j] && obj.rows[j].style.display == 'none') {\n                continue;\n            }\n\n            // Controls\n            if (data[posy] == undefined) {\n                posy = 0;\n            }\n            posx = 0;\n\n            // Data columns\n            if (h[0] != x1) {\r\n                if (x1 < h[0]) {\r\n                    var colNumber = x1 - h[0];\r\n                } else {\r\n                    var colNumber = 1;\r\n                }\r\n            }\n            // Data columns\n            for (var i = x1; i <= x2; i++) {\n                // Update non-readonly\n                if (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\n                    // Stop if contains value\n                    if (! obj.selection.length) {\n                        if (obj.options.data[j][i] != '') {\n                            breakControl = true;\n                            continue;\n                        }\n                    }\n\n                    // Column\n                    if (data[posy] == undefined) {\n                        posx = 0;\n                    } else if (data[posy][posx] == undefined) {\n                        posx = 0;\n                    }\r\n\r\n                    // Value\r\n                    var value = data[posy][posx];\n\n                        if (value && ! data[1] && obj.options.autoIncrement == true) {\n                        if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\n                            if ((''+value).substr(0,1) == '=') {\n                                var tokens = value.match(/([A-Z]+[0-9]+)/g);\n\n                                if (tokens) {\n                                    var affectedTokens = [];\n                                    for (var index = 0; index < tokens.length; index++) {\n                                        var position = jexcel.getIdFromColumnName(tokens[index], 1);\n                                        position[0] += colNumber;\r\n                                        position[1] += rowNumber;\r\n                                        if (position[1] < 0) {\r\n                                            position[1] = 0;\r\n                                        }\n                                        var token = jexcel.getColumnNameFromId([position[0], position[1]]);\n\n                                        if (token != tokens[index]) {\n                                            affectedTokens[tokens[index]] = token;\n                                        }\n                                    }\n                                    // Update formula\n                                    if (affectedTokens) {\n                                        value = obj.updateFormula(value, affectedTokens)\n                                    }\n                                }\n                            } else {\n                                if (value == Number(value)) {\n                                    value = Number(value) + rowNumber;\n                                }\n                            }\n                        } else if (obj.options.columns[i].type == 'calendar') {\n                            var date = new Date(value);\n                            date.setDate(date.getDate() + rowNumber);\n                            value = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\n                        }\n                    }\n\n                    records.push(obj.updateCell(i, j, value));\n\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(i, j, records);\n                }\n                posx++;\n                if (h[0] != x1) {\r\n                    colNumber++;\r\n                }\n            }\n            posy++;\n            rowNumber++;\n        }\n\n        // Update history\n        obj.setHistory({\n            action:'setValue',\n            records:records,\n            selection:obj.selectedCell,\n        });\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n\n        // On after changes\n        obj.onafterchanges(el, records);\n    }\n\n    /**\n     * Refresh current selection\n     */\n    obj.refreshSelection = function() {\n        if (obj.selectedCell) {\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        }\n    }\n\n    /**\n     * Move coords to A1 in case ovelaps with an excluded cell\n     */\n    obj.conditionalSelectionUpdate = function(type, o, d) {\n        if (type == 1) {\n            if (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\n                obj.resetSelection();\n                return;\n            }\n        } else {\n            if (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\n                obj.resetSelection();\n                return;\n            }\n        }\n    }\n\n    /**\n     * Clear table selection\n     */\n    obj.resetSelection = function(blur) {\n        // Remove style\n        if (! obj.highlighted.length) {\n            var previousStatus = 0;\n        } else {\n            var previousStatus = 1;\n\n            for (var i = 0; i < obj.highlighted.length; i++) {\n                obj.highlighted[i].classList.remove('highlight');\n                obj.highlighted[i].classList.remove('highlight-left');\n                obj.highlighted[i].classList.remove('highlight-right');\n                obj.highlighted[i].classList.remove('highlight-top');\n                obj.highlighted[i].classList.remove('highlight-bottom');\n                obj.highlighted[i].classList.remove('highlight-selected');\n\n                var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\n                var py = parseInt(obj.highlighted[i].getAttribute('data-y'));\n\n                // Check for merged cells\n                if (obj.highlighted[i].getAttribute('data-merged')) {\n                    var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\n                    var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\n                    var ux = colspan > 0 ? px + (colspan - 1) : px;\n                    var uy = rowspan > 0 ? py + (rowspan - 1): py;\n                } else {\n                    var ux = px;\n                    var uy = py;\n                }\n\n                // Remove selected from headers\n                for (var j = px; j <= ux; j++) {\n                    if (obj.headers[j]) {\n                        obj.headers[j].classList.remove('selected');\n                    }\n                }\n\n                // Remove selected from rows\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j]) {\n                        obj.rows[j].classList.remove('selected');\n                    }\n                }\n            }\n        }\n\n        // Reset highlighed cells\n        obj.highlighted = [];\n\n        // Reset\n        obj.selectedCell = null;\n\n        // Hide corner\n        obj.corner.style.top = '-2000px';\n        obj.corner.style.left = '-2000px';\n\n        if (obj.ignoreEvents != true && blur == true) {\n            if (obj.options.onblur) {\n                if (typeof(obj.options.onblur) == 'function') {\n                    if (previousStatus == 1) {\n                        obj.options.onblur(el);\n                    }\n                }\n            }\n        }\n\n        return previousStatus;\n    }\n\n    /**\n     * Update selection based on two cells\n     */\n    obj.updateSelection = function(el1, el2, origin) {\n        var x1 = el1.getAttribute('data-x');\n        var y1 = el1.getAttribute('data-y');\n        if (el2) {\n            var x2 = el2.getAttribute('data-x');\n            var y2 = el2.getAttribute('data-y');\n        } else {\n            var x2 = x1;\n            var y2 = y1;\n        }\n\n        obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\n    }\n\n    /**\n     * Update selection from coords\n     */\n    obj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\n        // Reset Selection\n        var updated = null;\n        var previousState = obj.resetSelection();\n\n        // Same element\n        if (x2 == null) {\n            x2 = x1;\n        }\n        if (y2 == null) {\n            y2 = y1;\n        }\n\n        // Selection must be within the existing data\n        if (x1 >= obj.headers.length) {\n            x1 = obj.headers.length - 1;\n        }\n        if (y1 >= obj.rows.length) {\n            y1 = obj.rows.length - 1;\n        }\n        if (x2 >= obj.headers.length) {\n            x2 = obj.headers.length - 1;\n        }\n        if (y2 >= obj.rows.length) {\n            y2 = obj.rows.length - 1;\n        }\n\n        // Keep selected cell\n        obj.selectedCell = [x1, y1, x2, y2];\n\n        // Select cells\n        if (x1 != null) {\n            // Add selected cell\n            if (obj.records[y1][x1]) {\n                obj.records[y1][x1].classList.add('highlight-selected');\n            }\n\n            // Origin & Destination\n            if (parseInt(x1) < parseInt(x2)) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var px = parseInt(x2);\n                var ux = parseInt(x1);\n            }\n\n            if (parseInt(y1) < parseInt(y2)) {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            } else {\n                var py = parseInt(y2);\n                var uy = parseInt(y1);\n            }\n\n            // Verify merged columns\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\n                        var x = parseInt(obj.records[j][i].getAttribute('data-x'));\n                        var y = parseInt(obj.records[j][i].getAttribute('data-y'));\n                        var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\n                        var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\n\n                        if (colspan > 1) {\n                            if (x < px) {\n                                px = x;\n                            }\n                            if (x + colspan > ux) {\n                                ux = x + colspan - 1;\n                            }\n                        }\n\n                        if (rowspan) {\n                            if (y < py) {\n                                py = y;\n\n                            }\n                            if (y + rowspan > uy) {\n                                uy = y + rowspan - 1;\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Limits\n            var borderLeft = null;\n            var borderRight = null;\n            var borderTop = null;\n            var borderBottom = null;\n\n            // Vertical limits\n            for (var j = py; j <= uy; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    if (borderTop == null) {\n                        borderTop = j;\n                    }\n                    borderBottom = j;\n                }\n            }\n\n            // Redefining styles\n            for (var i = px; i <= ux; i++) {\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('highlight');\n                        obj.highlighted.push(obj.records[j][i]);\n                    }\n                }\n\n                // Horizontal limits\n                if (obj.options.columns[i].type != 'hidden') {\n                    if (borderLeft == null) {\n                        borderLeft = i;\n                    }\n                    borderRight = i;\n                }\n            }\n\n            // Create borders\n            if (! borderLeft) {\n                borderLeft = 0;\n            }\n            if (! borderRight) {\n                borderRight = 0;\n            }\n            for (var i = borderLeft; i <= borderRight; i++) {\n                if (obj.options.columns[i].type != 'hidden') {\n                    // Top border\n                    if (obj.records[borderTop][i]) {\n                        obj.records[borderTop][i].classList.add('highlight-top');\n                    }\n                    // Bottom border\n                    if (obj.records[borderBottom][i]) {\n                        obj.records[borderBottom][i].classList.add('highlight-bottom');\n                    }\n                    // Add selected from headers\n                    obj.headers[i].classList.add('selected');\n                }\n            }\n\n            for (var j = borderTop; j <= borderBottom; j++) {\n                if (obj.rows[j].style.display != 'none') {\n                    // Left border\n                    obj.records[j][borderLeft].classList.add('highlight-left');\n                    // Right border\n                    obj.records[j][borderRight].classList.add('highlight-right');\n                    // Add selected from rows\n                    obj.rows[j].classList.add('selected');\n                }\n            }\n\n            obj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\n        }\n\n        // Handle events\n        if (obj.ignoreEvents != true) {\n            if (obj.options.onfocus) {\n                if (typeof(obj.options.onfocus) == 'function') {\n                    if (previousState == 0) {\n                        obj.options.onfocus(el);\n                    }\n                }\n            }\n\n            if (typeof(obj.options.onselection) == 'function') {\n                obj.options.onselection(el, borderLeft, borderTop, borderRight, borderBottom, origin);\n            }\n        }\n\n        // Find corner cell\n        obj.updateCornerPosition();\n    }\n\n    /**\n     * Remove copy selection\n     * \n     * @return void\n     */\n    obj.removeCopySelection = function() {\n        // Remove current selection\n        for (var i = 0; i < obj.selection.length; i++) {\n            obj.selection[i].classList.remove('selection');\n            obj.selection[i].classList.remove('selection-left');\n            obj.selection[i].classList.remove('selection-right');\n            obj.selection[i].classList.remove('selection-top');\n            obj.selection[i].classList.remove('selection-bottom');\n        }\n\n        obj.selection = [];\n    }\n\n    /**\n     * Update copy selection\n     * \n     * @param int x, y\n     * @return void\n     */\n    obj.updateCopySelection = function(x3, y3) {\n        // Remove selection\n        obj.removeCopySelection();\n\n        // Get elements first and last\n        var x1 = obj.selectedContainer[0];\n        var y1 = obj.selectedContainer[1];\n        var x2 = obj.selectedContainer[2];\n        var y2 = obj.selectedContainer[3];\n\n        if (x3 != null && y3 != null) {\n            if (x3 - x2 > 0) {\n                var px = parseInt(x2) + 1;\n                var ux = parseInt(x3);\n            } else {\n                var px = parseInt(x3);\n                var ux = parseInt(x1) - 1;\n            }\n\n            if (y3 - y2 > 0) {\n                var py = parseInt(y2) + 1;\n                var uy = parseInt(y3);\n            } else {\n                var py = parseInt(y3);\n                var uy = parseInt(y1) - 1;\n            }\n\n            if (ux - px < uy - py) {\n                var px = parseInt(x1);\n                var ux = parseInt(x2);\n            } else {\n                var py = parseInt(y1);\n                var uy = parseInt(y2);\n            }\n\n            for (var j = py; j <= uy; j++) {\n                for (var i = px; i <= ux; i++) {\n                    if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                        obj.records[j][i].classList.add('selection');\n                        obj.records[py][i].classList.add('selection-top');\n                        obj.records[uy][i].classList.add('selection-bottom');\n                        obj.records[j][px].classList.add('selection-left');\n                        obj.records[j][ux].classList.add('selection-right');\n\n                        // Persist selected elements\n                        obj.selection.push(obj.records[j][i]);\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Update corner position\n     * \n     * @return void\n     */\n    obj.updateCornerPosition = function() {\n        // If any selected cells\n        if (! obj.highlighted.length) {\n            obj.corner.style.top = '-2000px';\n            obj.corner.style.left = '-2000px';\n        } else {\n            // Get last cell\n            var last = obj.highlighted[obj.highlighted.length-1];\n\r\n            const contentRect = obj.content.getBoundingClientRect();\r\n            var x1 = contentRect.left;\r\n            var y1 = contentRect.top;\r\n\r\n            const lastRect = last.getBoundingClientRect();\r\n            var x2 = lastRect.left;\r\n            var y2 = lastRect.top;\r\n            var w2 = lastRect.width;\r\n            var h2 = lastRect.height;\r\n\n            var x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\n            var y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\n\n            // Place the corner in the correct place\n            obj.corner.style.top = y + 'px';\n            obj.corner.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Update scroll position based on the selection\n     */\n    obj.updateScroll = function(direction) {\n        // jExcel Container information\n        const contentRect = obj.content.getBoundingClientRect();\r\n        var x1 = contentRect.left;\r\n        var y1 = contentRect.top;\r\n        var w1 = contentRect.width;\r\n        var h1 = contentRect.height;\r\n\n        // Direction Left or Up\n        var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\n\n            // Reference\r\n        const referenceRect = reference.getBoundingClientRect();\r\n        var x2 = referenceRect.left;\r\n        var y2 = referenceRect.top;\r\n        var w2 = referenceRect.width;\r\n        var h2 = referenceRect.height;\n\n        // Direction\n        if (direction == 0 || direction == 1) {\n            var x = (x2 - x1) + obj.content.scrollLeft;\n            var y = (y2 - y1) + obj.content.scrollTop - 2;\n        } else {\n            var x = (x2 - x1) + obj.content.scrollLeft + w2;\n            var y = (y2 - y1) + obj.content.scrollTop + h2;\n        }\n\n        // Top position check\n        if (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (y < obj.content.scrollTop + 30) {\n                obj.content.scrollTop = y - h2;\n            } else {\n                obj.content.scrollTop = y - (h1 - 2);\n            }\n        }\n\n        // Left position check - TODO: change that to the bottom border of the element\n        if (x > (obj.content.scrollLeft) && x < (obj.content.scrollLeft + w1)) {\n            // In the viewport\n        } else {\n            // Out of viewport\n            if (x < obj.content.scrollLeft + 30) {\n                obj.content.scrollLeft = x;\n                if (obj.content.scrollLeft < 50) {\n                    obj.content.scrollLeft = 0;\n                }\n            } else {\n                obj.content.scrollLeft = x - (w1 - 20);\n            }\n        }\n    }\n\n    /**\n     * Get the column width\n     * \n     * @param int column column number (first column is: 0)\n     * @return int current width\n     */\n    obj.getWidth = function(column) {\n        if (! column) {\n            // Get all headers\n            var data = [];\n            for (var i = 0; i < obj.headers.length; i++) {\n                data.push(obj.options.columns[i].width);\n            }\n        } else {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = $(column).getAttribute('data-x');\n            }\n\n            data = obj.colgroup[column].getAttribute('width')\n        }\n\n        return data;\n    }\n\n    /**\n     * Set the column width\n     * \n     * @param int column number (first column is: 0)\n     * @param int new column width\n     * @param int old column width\n     */\n    obj.setWidth = function (column, width, oldWidth) {\n        if (width > 0) {\n            // In case the column is an object\n            if (typeof(column) == 'object') {\n                column = column.getAttribute('data-x');\n            }\n\n            // Oldwidth\n            if (! oldWidth) {\n                oldWidth = obj.colgroup[column].getAttribute('width');\n            }\n\n            // Set width\n            obj.colgroup[column].setAttribute('width', width);\n            obj.options.columns[column].width = width;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setWidth',\n                column:column,\n                oldValue:oldWidth,\n                newValue:width,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizecolumn) == 'function') {\n                    obj.options.onresizecolumn(el, column, width, oldWidth);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Set the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @param height - new row height\n     * @param oldHeight - old row height\n     */\n    obj.setHeight = function (row, height, oldHeight) {\n        if (height > 0) {\n            // In case the column is an object\n            if (typeof(row) == 'object') {\n                row = row.getAttribute('data-y');\n            }\n\n            // Oldwidth\n            if (! oldHeight) {\n                oldHeight = obj.rows[row].getAttribute('height');\r\n\r\n                if (! oldHeight) {\r\n                    var rect = obj.rows[row].getBoundingClientRect();\r\n                    oldHeight = rect.height;\r\n                }\n            }\n\n            // Integer\r\n            height = parseInt(height);\r\n\n            // Set width\n            obj.rows[row].style.height = height + 'px';\n\n            // Keep options updated\n            if (! obj.options.rows[row]) {\n                obj.options.rows[row] = {};\n            }\n            obj.options.rows[row].height = height;\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'setHeight',\n                row:row,\n                oldValue:oldHeight,\n                newValue:height,\n            });\n\n            // On resize column\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onresizerow) == 'function') {\n                    obj.options.onresizerow(el, row, height, oldHeight);\n                }\n            }\n\n            // Update corner position\n            obj.updateCornerPosition();\n        }\n    }\n\n    /**\n     * Get the row height\n     * \n     * @param row - row number (first row is: 0)\n     * @return height - current row height\n     */\n    obj.getHeight = function(row) {\n        if (! row) {\n            // Get height of all rows\n            var data = [];\n            for (var j = 0; j < obj.rows.length; j++) {\n                var h = obj.rows[j].style.height;\n                if (h) {\n                    data[j] = h;\n                }\n            }\n        } else {\n            // In case the row is an object\n            if (typeof(row) == 'object') {\n                row = $(row).getAttribute('data-y');\n            }\n\n            var data = obj.rows[row].style.height;\n        }\n\n        return data;\n    }\n\n    /**\n     * Get the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.getHeader = function(column) {\n        return obj.headers[column].innerText;\n    }\n\n    /**\n     * Set the column title\n     * \n     * @param column - column number (first column is: 0)\n     * @param title - new column title\n     */\n    obj.setHeader = function(column, newValue) {\n        if (obj.headers[column]) {\n            var oldValue = obj.headers[column].innerText;\n\n            if (! newValue) {\n                newValue = prompt(obj.options.text.columnName, oldValue)\n            }\n\n            if (newValue) {\n                obj.headers[column].innerHTML = newValue;\n                // Keep the title property\r\n                obj.headers[column].setAttribute('title', newValue);\n            }\n\n            obj.setHistory({\n                action: 'setHeader',\n                column: column,\n                oldValue: oldValue,\n                newValue: newValue\n            });\n\n            // On change\n            if (! obj.ignoreEvents) {\n                if (typeof(obj.options.onchangeheader) == 'function') {\n                    obj.options.onchangeheader(el, column, oldValue, newValue);\n                }\n            }\n        }\n    }\n\n    /**\n     * Get the headers\n     * \n     * @param asArray\n     * @return mixed\n     */\n    obj.getHeaders = function (asArray) {\n        var title = [];\n\n        for (var i = 0; i < obj.headers.length; i++) {\n            title.push(obj.getHeader(i));\n        }\n\n        return asArray ? title : title.join(obj.options.csvDelimiter);\n    }\n\n    /**\n     * Get meta information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getMeta = function(cell, key) {\n        if (! cell) {\n            return obj.options.meta;\n        } else {\n            if (key) {\n                return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\n            } else {\n                return obj.options.meta[cell] ? obj.options.meta[cell] : null;\n            }\n        }\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setMeta = function(o, k, v) {\n        if (! obj.options.meta) {\n            obj.options.meta = {}\n        }\n\n        if (k && v) {\n            // Set data value\n            if (! obj.options.meta[o]) {\n                obj.options.meta[o] = {};\n            }\n            obj.options.meta[o][k] = v;\n        } else {\n            // Apply that for all cells\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                if (! obj.options.meta[keys[i]]) {\n                    obj.options.meta[keys[i]] = {};\n                }\n\n                var prop = Object.keys(o[keys[i]]);\n                for (var j = 0; j < prop.length; j++) {\n                    obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\n                }\n            }\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangemeta) == 'function') {\n                obj.options.onchangemeta(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Update meta information\n     * \n     * @return integer\n     */\n    obj.updateMeta = function(affectedCells) {\n        if (obj.options.meta) {\n            var newMeta = {};\n            var keys = Object.keys(obj.options.meta);\n            for (var i = 0; i < keys.length; i++) {\n                if (affectedCells[keys[i]]) {\n                    newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\n                } else {\n                    newMeta[keys[i]] = obj.options.meta[keys[i]];\n                }\n            }\n            // Update meta information\n            obj.options.meta = newMeta;\n        }\n    }\n\n    /**\n     * Get style information from cell(s)\n     * \n     * @return integer\n     */\n    obj.getStyle = function(cell, key) {\n        // Cell\n        if (! cell) {\n            // Control vars\n            var data = {};\n\n            // Column and row length\n            var x = obj.options.data[0].length;\n            var y = obj.options.data.length;\n\n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                for (var i = 0; i < x; i++) {\n                    // Value\n                    var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\n\n                    // Any meta data for this column?\n                    if (v) {\n                        // Column name\n                        var k = jexcel.getColumnNameFromId([i, j]);\n                        // Value\n                        data[k] = v;\n                    }\n                }\n            }\n\n           return data;\n        } else {\n            cell = jexcel.getIdFromColumnName(cell, true);\n\n            return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\n        }\n    },\n\n    obj.resetStyle = function(o, ignoreHistoryAndEvents) {\n        var keys = Object.keys(o);\n        for (var i = 0; i < keys.length; i++) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(keys[i], true);\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                obj.records[cell[1]][cell[0]].setAttribute('style', '');\n            }\n        }\n        obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\n    }\n\n    /**\n     * Set meta information to cell(s)\n     * \n     * @return integer\n     */\n    obj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\n        var newValue = {};\n        var oldValue = {};\n\n        // Apply style\n        var applyStyle = function(cellId, key, value) {\n            // Position\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n\n            if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                // Current value\n                var currentValue = obj.records[cell[1]][cell[0]].style[key];\n\n                // Change layout\n                if (currentValue == value && ! force) {\n                    value = '';\n                    obj.records[cell[1]][cell[0]].style[key] = '';\n                } else {\n                    obj.records[cell[1]][cell[0]].style[key] = value;\n                }\n\n                // History\n                if (! oldValue[cellId]) {\n                    oldValue[cellId] = [];\n                }\n                if (! newValue[cellId]) {\n                    newValue[cellId] = [];\n                }\n\n                oldValue[cellId].push([key + ':' + currentValue]);\n                newValue[cellId].push([key + ':' + value]);\n            }\n        }\n\n        if (k && v) {\n            // Get object from string\n            if (typeof(o) == 'string') {\n                applyStyle(o, k, v);\n            } else {\n                // Avoid duplications\n                var oneApplication = [];\n                // Apply that for all cells\n                for (var i = 0; i < o.length; i++) {\n                    var x = o[i].getAttribute('data-x');\n                    var y = o[i].getAttribute('data-y');\n                    var cellName = jexcel.getColumnNameFromId([x, y]);\n                    // This happens when is a merged cell\n                    if (! oneApplication[cellName]) {\n                        applyStyle(cellName, k, v);\n                        oneApplication[cellName] = true;\n                    }\n                }\n            }\n        } else {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                var style = o[keys[i]];\n                if (typeof(style) == 'string') {\n                    style = style.split(';');\n                }\n                for (var j = 0; j < style.length; j++) {\n                    if (typeof(style[j]) == 'string') {\n                        style[j] = style[j].split(':');\n                    }\n                    // Apply value\n                    if (style[j][0].trim()) {\n                        applyStyle(keys[i], style[j][0].trim(), style[j][1]);\n                    }\n                }\n            }\n        }\n\n        var keys = Object.keys(oldValue);\n        for (var i = 0; i < keys.length; i++) {\n            oldValue[keys[i]] = oldValue[keys[i]].join(';');\n        }\n        var keys = Object.keys(newValue);\n        for (var i = 0; i < keys.length; i++) {\n            newValue[keys[i]] = newValue[keys[i]].join(';');\n        }\n\n        if (! ignoreHistoryAndEvents) {\n            // Keeping history of changes\n            obj.setHistory({\n                action: 'setStyle',\n                oldValue: oldValue,\n                newValue: newValue,\n            });\n        }\n\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onchangestyle) == 'function') {\n                obj.options.onchangestyle(el, o, k, v);\n            }\n        }\n    }\n\n    /**\n     * Get cell comments, null cell for all\n     */\n    obj.getComments = function(cell, withAuthor) {\n        if (cell) {\r\n            if (typeof(cell) == 'string') {\r\n              var cell = jexcel.getIdFromColumnName(cell, true);\r\n            }\r\n\r\n            if (withAuthor) {\r\n                return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\r\n            } else {\r\n                return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\r\n            }\r\n        } else {\r\n            var data = {};\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                for (var i = 0; i < obj.options.columns.length; i++) {\r\n                    var comments = obj.records[j][i].getAttribute('title');\r\n                    if (comments) {\r\n                        var cell = jexcel.getColumnNameFromId([i, j]);\r\n                        data[cell] = comments;\r\n                    }\r\n                }\r\n            }\r\n            return data;\r\n        }\n    }\n\n    /**\n     * Set cell comments\n     */\n    obj.setComments = function(cellId, comments, author) {\n        if (typeof(cellId) == 'string') {\n            var cell = jexcel.getIdFromColumnName(cellId, true);\n        } else {\n            var cell = cellId;\n        }\n\n        // Keep old value\n        var title = obj.records[cell[1]][cell[0]].getAttribute('title');\n        var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\n        var oldValue = [ title, author ];\n\n        // Set new values\n        obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\n        obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\n\n        // Remove class if there is no comment\n        if (comments) {\n            obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\n        } else {\n            obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\n        }\n\n        // Save history\n        obj.setHistory({\n            action:'setComments',\n            column: cellId,\n            newValue: [ comments, author ],\n            oldValue: oldValue,\n        });\n    }\n\n    /**\n     * Get table config information\n     */\n    obj.getConfig = function() {\n        var options = obj.options;\n        options.style = obj.getStyle();\n        options.mergeCells = obj.getMerge();\r\n        options.comments = obj.getComments();\n\n        return options;\n    }\n\n    /**\n     * Sort data and reload table\n     */\n    obj.orderBy = function(column, order) {\n        if (column >= 0) {\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    // Remove merged cells\n                    obj.destroyMerged();\n                }\n            }\n\n            // Direction\n            if (order == null) {\n                order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\n            } else {\n                order = order ? 1 : 0;\n            }\n\n            // Filter\n            Array.prototype.orderBy = function(p, o) {\n                return this.slice(0).sort(function(a, b) {\n                    var valueA = a[p] == '' ? '' : Number(a[p]) == a[p] ? Number(a[p]) : a[p].toLowerCase();\n                    var valueB = b[p] == '' ? '' : Number(b[p]) == b[p] ? Number(b[p]) : b[p].toLowerCase();\n\n                    if (! o) {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\n                    } else {\n                        return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\n                    }\n                });\n            }\n\n            // Test order\n            var temp = [];\n            if (obj.options.columns[column].type == 'calendar' ||\n                obj.options.columns[column].type == 'checkbox' ||\n                obj.options.columns[column].type == 'radio') {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.options.data[j][column] ];\n                }\n            } else {\n                for (var j = 0; j < obj.options.data.length; j++) {\n                    temp[j] = [ j, obj.records[j][column].innerHTML ];\n                }\n            }\n            temp = temp.orderBy(1, order);\n\n            // Save history\n            var newValue = [];\n            for (var j = 0; j < temp.length; j++) {\n                newValue[j] = temp[j][0];\n            }\n\n            // Save history\n            obj.setHistory({\n                action: 'orderBy',\n                rows: newValue,\n                column: column,\n                order: order,\n            });\n\n            // Update order\n            obj.updateOrderArrow(column, order);\n            obj.updateOrder(newValue);\n\n            // On sort event\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.onsort) == 'function') {\n                    obj.options.onsort(el, column, order);\n                }\n            }\n\n            return true;\n        }\n    }\n\n    /**\n     * Update order arrow\n     */\n    obj.updateOrderArrow = function(column, order) {\n        // Remove order\n        for (var i = 0; i < obj.headers.length; i++) {\n            obj.headers[i].classList.remove('arrow-up');\n            obj.headers[i].classList.remove('arrow-down');\n        }\n\n        // No order specified then toggle order\n        if (order) {\n            obj.headers[column].classList.add('arrow-up');\n        } else {\n            obj.headers[column].classList.add('arrow-down');\n        }\n    }\n\n    /**\n     * Update rows position\n     */\n    obj.updateOrder = function(rows) {\n        // History\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.options.data[rows[j]];\n        }\n        obj.options.data = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.records[rows[j]];\n        }\n        obj.records = data;\n\n        var data = []\n        for (var j = 0; j < rows.length; j++) {\n            data[j] = obj.rows[rows[j]];\n        }\n        obj.rows = data;\n\n        // Update references\n        obj.updateTableReferences();\n\n        // Redo search\n        if (obj.searchInput.value) {\n            obj.search(obj.searchInput.value);\n        } else {\n            // Create page\n            obj.results = null;\n            obj.pageNumber = 0;\n\n            if (obj.options.pagination > 0) {\n                obj.page(0);\n            } else if (obj.options.lazyLoading == true) {\n                obj.loadPage(0);\n            } else {\n                for (var j = 0; j < obj.rows.length; j++) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                }\n            }\n        }\n    }\n\n    /**\n     * Move row\n     * \n     * @return void\n     */\n    obj.moveRow = function(o, d, ignoreDom) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n           if (o > d) {\r\n               var insertBefore = 1;\r\n           } else {\r\n               var insertBefore = 0;\r\n           }\r\n\r\n           if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                    obj.resetSearch();\n                } else {\n                    return false;\n                }\n            }\n\n            obj.results = null;\n        }\n\n        if (! ignoreDom) {\n            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\n                if (o > d) {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\n                } else {\n                    obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\n                }\n            } else {\n                obj.tbody.removeChild(obj.rows[o]);\n            }\n        }\n\n        // Place references in the correct position\n        obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\n        obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\n        obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\n\n        // Respect pagination\n        if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n            obj.page(obj.pageNumber);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveRow',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmoverow) == 'function') {\n                obj.options.onmoverow(el, o, d);\n            }\n        }\n    }\n\n    /**\n     * Insert a new row\n     * \n     * @param mixed - number of blank lines to be insert or a single array with the data of the new row\n     * @param rowNumber\n     * @param insertBefore\n     * @return void\n     */\n    obj.insertRow = function(mixed, rowNumber, insertBefore) {\n        // Configuration\n        if (obj.options.allowInsertRow == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfRows = mixed;\n            } else {\n                var numOfRows = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastRow = obj.options.data.length - 1;\n\n            if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\n                rowNumber = lastRow;\n            }\n\n            // Onbeforeinsertrow\n            if (typeof(obj.options.onbeforeinsertrow) == 'function') {\n                if (! obj.options.onbeforeinsertrow(el, rowNumber, numOfRows, insertBefore)) {\n                    console.log('onbeforeinsertrow returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isRowMerged(rowNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Clear any search\n            if (obj.options.search == true) {\n                if (obj.results && obj.results.length != obj.rows.length) {\n                    if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                        obj.resetSearch();\n                    } else {\n                        return false;\n                    }\n                }\n\n                obj.results = null;\n            }\n\n            // Insertbefore\n            var rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\n\n            // Keep the current data\n            var currentRecords = obj.records.splice(rowIndex);\n            var currentData = obj.options.data.splice(rowIndex);\n            var currentRows = obj.rows.splice(rowIndex);\n\n            // Adding lines\n            var rowRecords = [];\n            var rowData = [];\n            var rowNode = [];\n\n            for (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\n                // Push data to the data container\n                obj.options.data[row] = [];\n                for (var col = 0; col < obj.options.columns.length; col++) {\n                    obj.options.data[row][col]  = data[col] ? data[col] : '';\n                }\n                // Create row\n                var tr = obj.createRow(row, obj.options.data[row]);\n                // Append node\n                if (currentRows[0]) {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n                        obj.tbody.insertBefore(tr, currentRows[0]);\n                    }\n                } else {\r\n                    if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n                        obj.tbody.appendChild(tr);\r\n                    }\r\n                }\n                // Record History\n                rowRecords.push(obj.records[row]);\n                rowData.push(obj.options.data[row]);\n                rowNode.push(tr);\n            }\n\n            // Copy the data back to the main data\n            Array.prototype.push.apply(obj.records, currentRecords);\n            Array.prototype.push.apply(obj.options.data, currentData);\n            Array.prototype.push.apply(obj.rows, currentRows);\n\n            // Respect pagination\n            if (obj.options.pagination > 0) {\n                obj.page(obj.pageNumber);\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertRow',\n                rowNumber: rowNumber,\n                numOfRows: numOfRows,\n                insertBefore: insertBefore,\n                rowRecords: rowRecords,\n                rowData: rowData,\n                rowNode: rowNode,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertrow) == 'function') {\n                    obj.options.oninsertrow(el, rowNumber, numOfRows, rowRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a row by number\n     * \n     * @param integer rowNumber - row number to be excluded\n     * @param integer numOfRows - number of lines\n     * @return void\n     */\n    obj.deleteRow = function(rowNumber, numOfRows) {\n        // Global Configuration\n        if (obj.options.allowDeleteRow == true) {\n            if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\n                // Delete row definitions\n                if (rowNumber == undefined) {\n                    var number = obj.getSelectedRows();\n\n                    if (! number[0]) {\n                        rowNumber = obj.options.data.length - 1;\n                        numOfRows = 1;\n                    } else {\n                        rowNumber = parseInt(number[0].getAttribute('data-y'));\n                        numOfRows = number.length;\n                    }\n                }\n\n                // Last column\n                var lastRow = obj.options.data.length - 1;\n\n                if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\n                    rowNumber = lastRow;\n                }\n\n                if (! numOfRows) {\n                    numOfRows = 1;\n                }\n\n                // Do not delete more than the number of recoreds\n                if (rowNumber + numOfRows >= obj.options.data.length) {\n                    numOfRows = obj.options.data.length - rowNumber;\n                }\n\n                // Onbeforedeleterow\n                if (typeof(obj.options.onbeforedeleterow) == 'function') {\n                    if (! obj.options.onbeforedeleterow(el, rowNumber, numOfRows)) {\n                        console.log('onbeforedeleterow returned false');\n                        return false;\n                    }\n                }\n\n                if (parseInt(rowNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                            if (obj.isRowMerged(row, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Clear any search\n                    if (obj.options.search == true) {\n                        if (obj.results && obj.results.length != obj.rows.length) {\n                            if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                                obj.resetSearch();\n                            } else {\n                                return false;\n                            }\n                        }\n\n                        obj.results = null;\n                    }\n\n                    // Remove node\n                    for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\n                            obj.rows[row].className = '';\n                            obj.rows[row].parentNode.removeChild(obj.rows[row]);\n                        }\n                    }\n\n                    // Remove data\n                    var rowRecords = obj.records.splice(rowNumber, numOfRows);\n                    var rowData = obj.options.data.splice(rowNumber, numOfRows);\n                    var rowNode = obj.rows.splice(rowNumber, numOfRows);\n\n                    // Respect pagination\n                    if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n                        obj.page(obj.pageNumber);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\n\n                    // Keep history\n                    obj.setHistory({\n                        action: 'deleteRow',\n                        rowNumber: rowNumber,\n                        numOfRows: numOfRows,\n                        insertBefore: 1,\n                        rowRecords: rowRecords,\n                        rowData: rowData,\n                        rowNode: rowNode\n                    });\n\n                    // Remove table references\n                    obj.updateTableReferences();\n\n                    // Events\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeleterow) == 'function') {\n                            obj.options.ondeleterow(el, rowNumber, numOfRows, rowRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last row');\n            }\n        }\n    }\n\n\n    /**\n     * Move column\n     * \n     * @return void\n     */\n    obj.moveColumn = function(o, d) {\n        if (Object.keys(obj.options.mergeCells).length > 0) {\n            if (o > d) {\r\n                var insertBefore = 1;\r\n            } else {\r\n                var insertBefore = 0;\r\n            }\r\n\r\n            if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\r\n                if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                    return false;\n                } else {\n                    obj.destroyMerged();\n                }\n            }\n        }\n\n        var o = parseInt(o);\n        var d = parseInt(d);\n\n        if (o > d) {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\n            }\n        } else {\n            obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\n            obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\n            }\n        }\n\n        obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\n        obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\n        obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\n\n        for (var j = 0; j < obj.rows.length; j++) {\n            obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\n            obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\n        }\n\n        // Keeping history of changes\n        obj.setHistory({\n            action:'moveColumn',\n            oldValue: o,\n            newValue: d,\n        });\n\n        // Update table references\n        obj.updateTableReferences();\n\n        // Events\n        if (obj.ignoreEvents != true) {\n            if (typeof(obj.options.onmovecolumn) == 'function') {\n                obj.options.onmovecolumn(el, o, d);\n            }\n        }\n    }\n\n\n    /**\n     * Insert a new column\n     * \n     * @param mixed - num of columns to be added or data to be added in one single column\n     * @param int columnNumber - number of columns to be created\n     * @param bool insertBefore\n     * @param object properties - column properties\n     * @return void\n     */\n    obj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\n        // Configuration\n        if (obj.options.allowInsertColumn == true) {\n            // Records\n            var records = [];\n\n            // Data to be insert\n            var data = [];\n\n            // The insert could be lead by number of rows or the array of data\n            if (mixed > 0) {\n                var numOfColumns = mixed;\n            } else {\n                var numOfColumns = 1;\n\n                if (mixed) {\n                    data = mixed;\n                }\n            }\n\n            // Direction\n            var insertBefore = insertBefore ? true : false;\n\n            // Current column number\n            var lastColumn = obj.options.columns.length - 1;\n\n            // Confirm position\n            if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\n                columnNumber = lastColumn;\n            }\n\n            // Onbeforeinsertcolumn\n            if (typeof(obj.options.onbeforeinsertcolumn) == 'function') {\n                if (! obj.options.onbeforeinsertcolumn(el, columnNumber, numOfColumns, insertBefore)) {\n                    console.log('onbeforeinsertcolumn returned false');\n\n                    return false;\n                }\n            }\n\n            // Merged cells\n            if (Object.keys(obj.options.mergeCells).length > 0) {\n                if (obj.isColMerged(columnNumber, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n\n            // Create default properties\n            if (! properties) {\n                properties = [];\n            }\n\n            for (var i = 0; i < numOfColumns; i++) {\n                if (! properties[i]) {\n                    properties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\n                }\n            }\n\n            // Insert before\n            var columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\n\n            // Open space in the containers\n            var currentHeaders = obj.headers.splice(columnIndex);\n            var currentColgroup = obj.colgroup.splice(columnIndex);\n\n            // History\n            var historyHeaders = [];\n            var historyColgroup = [];\n            var historyRecords = [];\n            var historyData = [];\n\n            // Add new headers\n            for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                obj.createCellHeader(col);\n                obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\n                obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\n\n                historyHeaders.push(obj.headers[col]);\n                historyColgroup.push(obj.colgroup[col]);\n            }\n\n            // Adding visual columns\n            for (var row = 0; row < obj.options.data.length; row++) {\n                // Keep the current data\n                var currentData = obj.options.data[row].splice(columnIndex);\n                var currentRecord = obj.records[row].splice(columnIndex);\n\n                // History\n                historyData[row] = [];\n                historyRecords[row] = [];\n\n                for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                    // New value\n                    var value = data[row] ? data[row] : '';\n                    obj.options.data[row][col] = value;\n                    // New cell\n                    var td = obj.createCell(col, row, obj.options.data[row][col]);\n                    obj.records[row][col] = td;\n                    // Add cell to the row\n                    if (obj.rows[row]) {\n                        obj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\n                    }\n\n                    // Record History\n                    historyData[row].push(value);\n                    historyRecords[row].push(td);\n                }\n\n                // Copy the data back to the main data\n                Array.prototype.push.apply(obj.options.data[row], currentData);\n                Array.prototype.push.apply(obj.records[row], currentRecord);\n            }\n\n            Array.prototype.push.apply(obj.headers, currentHeaders);\n            Array.prototype.push.apply(obj.colgroup, currentColgroup);\n\n            // Adjust nested headers\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                // Flexible way to handle nestedheaders\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\n                        obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                        obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                    }\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\n                    obj.options.nestedHeaders[0].colspan = colspan;\n                    obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                }\n            }\n\n            // Keep history\n            obj.setHistory({\n                action: 'insertColumn',\n                columnNumber:columnNumber,\n                numOfColumns:numOfColumns,\n                insertBefore:insertBefore,\n                columns:properties,\n                headers:historyHeaders,\n                colgroup:historyColgroup,\n                records:historyRecords,\n                data:historyData,\n            });\n\n            // Remove table references\n            obj.updateTableReferences();\n\n            // Events\n            if (obj.ignoreEvents != true) {\n                if (typeof(obj.options.oninsertcolumn) == 'function') {\n                    obj.options.oninsertcolumn(el, columnNumber, numOfColumns, historyRecords, insertBefore);\n                }\n            }\n        }\n    }\n\n    /**\n     * Delete a column by number\n     * \n     * @param integer columnNumber - reference column to be excluded\n     * @param integer numOfColumns - number of columns to be excluded from the reference column\n     * @return void\n     */\n    obj.deleteColumn = function(columnNumber, numOfColumns) {\n        // Global Configuration\n        if (obj.options.allowDeleteColumn == true) {\n            if (obj.headers.length > 1) {\n                // Delete column definitions\n                if (columnNumber == undefined) {\n                    var number = obj.getSelectedColumns(true);\n\n                    if (! number.length) {\n                        // Remove last column\n                        columnNumber = obj.headers.length - 1;\n                        numOfColumns = 1;\n                    } else {\n                        // Remove selected\n                        columnNumber = parseInt(number[0]);\n                        numOfColumns = parseInt(number.length);\n                    }\n                }\n\n                // Lasat column\n                var lastColumn = obj.options.data[0].length - 1;\n\n                if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\n                    columnNumber = lastColumn;\n                }\n\n                // Minimum of columns to be delete is 1\n                if (! numOfColumns) {\n                    numOfColumns = 1;\n                }\n\n\n\n                // Can't delete more than the limit of the table\n                if (numOfColumns > obj.options.data[0].length - columnNumber) {\n                    numOfColumns = obj.options.data[0].length - columnNumber;\n                }\n\n                // onbeforedeletecolumn\n                if (typeof(obj.options.onbeforedeletecolumn) == 'function') {\n                   if (! obj.options.onbeforedeletecolumn(el, columnNumber, numOfColumns)) {\n                      console.log('onbeforedeletecolumn returned false');\n                      return false;\n                   }\n                }\n\n                // Can't remove the last column\n                if (parseInt(columnNumber) > -1) {\n                    // Merged cells\n                    var mergeExists = false;\n                    if (Object.keys(obj.options.mergeCells).length > 0) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            if (obj.isColMerged(col, false).length) {\n                                mergeExists = true;\n                            }\n                        }\n                    }\n                    if (mergeExists) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n\n                    // Delete the column properties\n                    var columns = obj.options.columns.splice(columnNumber, numOfColumns);\n\n                    for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                        obj.colgroup[col].className = '';\n                        obj.headers[col].className = '';\n                        obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\n                        obj.headers[col].parentNode.removeChild(obj.headers[col]);\n                    }\n\n                    var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\n                    var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\n                    var historyRecords = [];\n                    var historyData = [];\n\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            obj.records[row][col].className = '';\n                            obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\n                        }\n                    }\n\n                    // Delete headers\n                    for (var row = 0; row < obj.options.data.length; row++) {\n                        // History\n                        historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\n                        historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\n                    }\n\n                    // Remove selection\n                    obj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\n\n                    // Adjust nested headers\n                    if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                        // Flexible way to handle nestedheaders\n                        if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                            for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                                var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\n                                obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                                obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                            }\n                        } else {\n                            var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\n                            obj.options.nestedHeaders[0].colspan = colspan;\n                            obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                        }\n                    }\n\n                    // Keeping history of changes\n                    obj.setHistory({\n                        action:'deleteColumn',\n                        columnNumber:columnNumber,\n                        numOfColumns:numOfColumns,\n                        insertBefore: 1,\n                        columns:columns,\n                        headers:historyHeaders,\n                        colgroup:historyColgroup,\n                        records:historyRecords,\n                        data:historyData,\n                    });\n\n                    // Update table references\n                    obj.updateTableReferences();\n\n                    // Delete\n                    if (obj.ignoreEvents != true) {\n                        if (typeof(obj.options.ondeletecolumn) == 'function') {\n                            obj.options.ondeletecolumn(el, columnNumber, numOfColumns, historyRecords);\n                        }\n                    }\n                }\n            } else {\n                console.error('JEXCEL. It is not possible to delete the last column');\n            }\n        }\n    }\n\n    /**\n     * Get seleted rows numbers\n     * \n     * @return array\n     */\n    obj.getSelectedRows = function(asIds) {\n        var rows = [];\n        // Get all selected rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j].classList.contains('selected')) {\n                if (asIds) {\n                    rows.push(j);\n                } else {\n                    rows.push(obj.rows[j]);\n                }\n            }\n        }\n\n        return rows;\n    },\n\n    /**\n     * Get seleted column numbers\n     * \n     * @return array\n     */\n    obj.getSelectedColumns = function() {\n        var cols = [];\n        // Get all selected cols\n        for (var i = 0; i < obj.headers.length; i++) {\n            if (obj.headers[i].classList.contains('selected')) {\n                cols.push(i);\n            }\n        }\n\n        return cols;\n    }\n\n    /**\n     * Get highlighted\n     * \n     * @return array\n     */\n    obj.getHighlighted = function() {\n        return obj.highlighted;\n    }\n\n    /**\n     * Update cell references\n     * \n     * @return void\n     */\n    obj.updateTableReferences = function() {\n        // Update headers\n        for (var i = 0; i < obj.headers.length; i++) {\n            var x = obj.headers[i].getAttribute('data-x');\n\n            if (x != i) {\n                // Update coords\n                obj.headers[i].setAttribute('data-x', i);\n                // Title\n                if (! obj.headers[i].getAttribute('title')) {\n                    obj.headers[i].innerHTML = jexcel.getColumnName(i);\n                }\n            }\n        }\n\n        // Update all rows\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (obj.rows[j]) {\n                var y = obj.rows[j].getAttribute('data-y');\n\n                if (y != j) {\n                    // Update coords\n                    obj.rows[j].setAttribute('data-y', j);\n                    obj.rows[j].children[0].setAttribute('data-y', j);\n                    // Row number\n                    obj.rows[j].children[0].innerHTML = j + 1;\n                }\n            }\n        }\n\n        // Regular cells affected by this change\n        var affectedTokens = [];\n        var mergeCellUpdates = [];\n\n        // Update cell\n        var updatePosition = function(x,y,i,j) {\n            if (x != i) {\n                obj.records[j][i].setAttribute('data-x', i);\n            }\n            if (y != j) {\n                obj.records[j][i].setAttribute('data-y', j);\n            }\n\n            // Other updates\n            if (x != i || y != j) {\n                var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                affectedTokens[columnIdFrom] = columnIdTo;\n            }\n        }\n\n        for (var j = 0; j < obj.records.length; j++) {\n            for (var i = 0; i < obj.records[0].length; i++) {\n                if (obj.records[j][i]) {\n                    // Current values\n                    var x = obj.records[j][i].getAttribute('data-x');\n                    var y = obj.records[j][i].getAttribute('data-y');\n\n                    // Update column\n                    if (obj.records[j][i].getAttribute('data-merged')) {\n                        var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                        var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                        if (mergeCellUpdates[columnIdFrom] == null) {\n                            if (columnIdFrom == columnIdTo) {\n                                mergeCellUpdates[columnIdFrom] = false;\n                            } else {\n                                var totalX = parseInt(i - x);\n                                var totalY = parseInt(j - y);\n                                mergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\n                            }\n                        }\n                    } else {\n                        updatePosition(x,y,i,j);\n                    }\n                }\n            }\n        }\n\n        // Update merged if applicable\n        var keys = Object.keys(mergeCellUpdates);\n        if (keys.length) {\n            for (var i = 0; i < keys.length; i++) {\n                if (mergeCellUpdates[keys[i]]) {\n                    var info = jexcel.getIdFromColumnName(keys[i], true)\n                    var x = info[0];\n                    var y = info[1];\n                    updatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\n\n                    var columnIdFrom = keys[i];\n                    var columnIdTo = mergeCellUpdates[keys[i]][0];\n                    for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\n                        var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\n                        var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\n                        obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\n                    }\n\n                    obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\n                    delete(obj.options.mergeCells[columnIdFrom]);\n                }\n            }\n        }\n\n        // Update formulas\n        obj.updateFormulas(affectedTokens);\n\n        // Update meta data\n        obj.updateMeta(affectedTokens);\n\n        // Refresh selection\n        obj.refreshSelection();\n\n        // Update table with custom configuration if applicable\n        obj.updateTable();\n    }\n\n    /**\n     * Custom settings for the cells\n     */\n    obj.updateTable = function() {\n        // Check for spare\n        if (obj.options.minSpareRows > 0) {\n            var numBlankRows = 0;\n            for (var j = obj.rows.length - 1; j >= 0; j--) {\n                var test = false;\n                for (var i = 0; i < obj.headers.length; i++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankRows++;\n                }\n            }\n\n            if (obj.options.minSpareRows - numBlankRows > 0) {\n                obj.insertRow(obj.options.minSpareRows - numBlankRows)\n            }\n        }\n\n        if (obj.options.minSpareCols > 0) {\n            var numBlankCols = 0;\n            for (var i = obj.headers.length - 1; i >= 0 ; i--) {\n                var test = false;\n                for (var j = 0; j < obj.rows.length; j++) {\n                    if (obj.options.data[j][i]) {\n                        test = true;\n                    }\n                }\n                if (test) {\n                    break;\n                } else {\n                    numBlankCols++;\n                }\n            }\n\n            if (obj.options.minSpareCols - numBlankCols > 0) {\n                obj.insertColumn(obj.options.minSpareCols - numBlankCols)\n            }\n        }\n\n        // Customizations by the developer\n        if (typeof(obj.options.updateTable) == 'function') {\n            if (obj.options.detachForUpdates) {\r\n                el.removeChild(obj.content);\r\n            }\r\n\n            for (var j = 0; j < obj.rows.length; j++) {\n                for (var i = 0; i < obj.headers.length; i++) {\n                    obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, jexcel.getColumnNameFromId([i, j]));\n                }\n            }\n\r\n            if (obj.options.detachForUpdates) {\r\n                el.insertBefore(obj.content, obj.pagination);\r\n            }\n        }\n\n        // Update corner position\n        setTimeout(function() {\n            obj.updateCornerPosition();\n        },0);\n    }\n\r\n    /**\r\n     * Show column\r\n     */\r\n    obj.showColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = '';\r\n        obj.colgroup[colNumber].style.display = '';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Hide column\r\n     */\r\n    obj.hideColumn = function(colNumber) {\r\n        obj.headers[colNumber].style.display = 'none';\r\n        obj.colgroup[colNumber].style.display = 'none';\r\n        for (var j = 0; j < obj.options.data.length; j++) {\r\n            obj.records[j][colNumber].style.display = 'none';\r\n        }\r\n    }\r\n\n    /**\n     * Show index column\n     */\n    obj.showIndex = function() {\n        obj.table.classList.remove('jexcel_hidden_index');\n    }\n\n    /**\n     * Hide index column\n     */\n    obj.hideIndex = function() {\n        obj.table.classList.add('jexcel_hidden_index');\n    }\n\n    /**\n     * Update all related cells in the chain\n     */\n    var chainLoopProtection = [];\n\n    obj.updateFormulaChain = function(x, y, records) {\n        var cellId = jexcel.getColumnNameFromId([x, y]);\n        if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\n            if (chainLoopProtection[cellId]) {\n                obj.records[y][x].innerHTML = '#ERROR';\n                obj.formula[cellId] = '';\n            } else {\n                // Protection\n                chainLoopProtection[cellId] = true;\n\n                for (var i = 0; i < obj.formula[cellId].length; i++) {\n                    var cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\n                    // Update cell\n                    var value = ''+obj.options.data[cell[1]][cell[0]];\n                    if (value.substr(0,1) == '=') {\n                        records.push(obj.updateCell(cell[0], cell[1], value, true));\n                    } else {\n                        // No longer a formula, remove from the chain\n                        Object.keys(obj.formula)[i] = null;\n                    }\n                    obj.updateFormulaChain(cell[0], cell[1], records);\n                }\n            }\n        }\n\n        chainLoopProtection = [];\n    }\n\n    /**\n     * Update formulas\n     */\n    obj.updateFormulas = function(referencesToUpdate) {\n        // Update formulas\n        for (var j = 0; j < obj.options.data.length; j++) {\n            for (var i = 0; i < obj.options.data[0].length; i++) {\n                var value = '' + obj.options.data[j][i];\n                // Is formula\n                if (value.substr(0,1) == '=') {\n                    // Replace tokens\n                    var newFormula = obj.updateFormula(value, referencesToUpdate);\n                    if (newFormula != value) {\n                        obj.options.data[j][i] = newFormula;\n                    }\n                }\n            }\n        }\n\n        // Update formula chain\n        var formula = [];\n        var keys = Object.keys(obj.formula);\n        for (var j = 0; j < keys.length; j++) {\n            // Current key and values\n            var key = keys[j];\n            var value = obj.formula[key];\n            // Update key\n            if (referencesToUpdate[key]) {\n                key = referencesToUpdate[key];\n            }\n            // Update values\n            formula[key] = [];\n            for (var i = 0; i < value.length; i++) {\n                var letter = value[i];\n                if (referencesToUpdate[letter]) {\n                    letter = referencesToUpdate[letter];\n                }\n                formula[key].push(letter);\n            }\n        }\n        obj.formula = formula;\n    }\n\n    /**\n     * Update formula\n     */\n    obj.updateFormula = function(formula, referencesToUpdate) {\n        var testLetter = /[A-Z]/;\n        var testNumber = /[0-9]/;\n\n        var newFormula = '';\n        var letter = null;\n        var number = null;\n        var token = '';\n\n        for (var index = 0; index < formula.length; index++) {\n            if (testLetter.exec(formula[index])) {\n                letter = 1;\n                number = 0;\n                token += formula[index];\n            } else if (testNumber.exec(formula[index])) {\n                number = letter ? 1 : 0;\n                token += formula[index];\n            } else {\n                if (letter && number) {\n                    token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n                }\n                newFormula += token;\n                newFormula += formula[index];\n                letter = 0;\n                number = 0;\n                token = '';\n            }\n        }\n\n        if (token) {\n            if (letter && number) {\n                token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n            }\n            newFormula += token;\n        }\n\n        return newFormula;\n    }\n\n    /**\n     * Parse formulas\n     */\n    obj.executeFormula = function(expression, x, y) {\n\n        var formulaResults = [];\n        var formulaLoopProtection = [];\n\n        // Execute formula with loop protection\n        var execute = function(expression, x, y) {\n         // Parent column identification\n            var parentId = jexcel.getColumnNameFromId([x, y]);\n\n            // Code protection\n            if (formulaLoopProtection[parentId]) {\n                console.error('Reference loop detected');\n                return '#ERROR';\n            }\n\n            formulaLoopProtection[parentId] = true;\n\n            // Convert range tokens\n            var tokensUpdate = function(tokens) {\n                for (var index = 0; index < tokens.length; index++) {\n                    var f = [];\n                    var token = tokens[index].split(':');\n                    var e1 = jexcel.getIdFromColumnName(token[0], true);\n                    var e2 = jexcel.getIdFromColumnName(token[1], true);\n\n                    if (e1[0] <= e2[0]) {\n                        var x1 = e1[0];\n                        var x2 = e2[0];\n                    } else {\n                        var x1 = e2[0];\n                        var x2 = e1[0];\n                    }\n\n                    if (e1[1] <= e2[1]) {\n                        var y1 = e1[1];\n                        var y2 = e2[1];\n                    } else {\n                        var y1 = e2[1];\n                        var y2 = e1[1];\n                    }\n\n                    for (var j = y1; j <= y2; j++) {\n                        for (var i = x1; i <= x2; i++) {\n                            f.push(jexcel.getColumnNameFromId([i, j]));\n                        }\n                    }\n\n                    expression = expression.replace(tokens[index], f.join(','));\n                }\n            }\n\n            var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\n            if (tokens && tokens.length) {\n                tokensUpdate(tokens);\n            }\n\n            // String\n            var evalstring = '';\n\n            // Get tokens\n            var tokens = expression.match(/([A-Z]+[0-9]+)/g);\n\n            // Direct self-reference protection\n            if (tokens && tokens.indexOf(parentId) > -1) {\n                console.error('Self Reference detected');\n                return '#ERROR';\n            } else {\n                if (tokens) {\n                    for (var i = 0; i < tokens.length; i++) {\n                        // Keep chain\n                        if (! obj.formula[tokens[i]]) {\n                            obj.formula[tokens[i]] = [];\n                        }\n                        // Is already in the register\n                        if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\n                            obj.formula[tokens[i]].push(parentId);\n                        }\n\n                        // Do not calculate again\n                        if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\n                            // Coords\n                            var position = jexcel.getIdFromColumnName(tokens[i], 1);\n                            // Get value\n                            if (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\n                                var value = obj.options.data[position[1]][position[0]];\n                            } else {\n                                var value = '';\n                            }\n                            // Get column data\n                            if ((''+value).substr(0,1) == '=') {\n                                if (formulaResults[tokens[i]]) {\n                                    value = formulaResults[tokens[i]];\n                                } else {\n                                    value = execute(value, position[0], position[1]);\n                                    formulaResults[tokens[i]] = value;\n                                }\n                            }\n                            // Type!\n                            if ((''+value).trim() == '') {\n                                // Null\n                                evalstring += \"var \" + tokens[i] + \" = null;\";\n                            } else {\n                                if (value == Number(value) && obj.options.autoCasting == true) {\n                                    // Number\n                                    evalstring += \"var \" + tokens[i] + \" = \" + Number(value) + \";\";\n                                } else {\n                                    // Trying any formatted number\n                                    var number = obj.parseNumber(value, position[0])\n                                    if (obj.options.autoCasting == true && number) {\n                                        // Render as number\n                                        evalstring += \"var \" + tokens[i] + \" = \" + number + \";\";\n                                    } else {\n                                        // Render as string\n                                        evalstring += \"var \" + tokens[i] + \" = '\" + value + \"';\";\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n\n                // Convert formula to javascript\n                try {\n                    evalstring += \"function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; };\";\n\n                    var res = eval(evalstring + expression.substr(1));\n                } catch (e) {\n                    var res = '#ERROR';\n                }\n\n                return res;\n            }\n        }\n\n        return execute(expression, x, y);\n    }\n\n    /**\n     * Trying to extract a number from a string\n     */\n    obj.parseNumber = function(value, columnNumber) {\n        // Decimal point\n        var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\n\n        // Parse both parts of the number\n        var number = ('' + value);\n        number = number.split(decimal);\n        number[0] = number[0].match(/[+-]?[0-9]/g);\n        if (number[0]) {\n            number[0] = number[0].join('');\n        }\n        if (number[1]) {\n            number[1] = number[1].match(/[0-9]*/g).join('');\n        }\n\n        // Is a valid number\n        if (number[0] && Number(number[0]) >= 0) {\n            if (! number[1]) {\n                var value = Number(number[0] + '.00');\n            } else {\n                var value = Number(number[0] + '.' + number[1]);\n            }\n        } else {\n            var value = null;\n        }\n\n        return value;\n    }\n\n    /**\n     * Get row number\n     */\n    obj.row = function(cell) {\n    }\n\n    /**\n     * Get col number\n     */\n    obj.col = function(cell) {\n    }\n\n    obj.up = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] > 0) {\n                obj.up.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] > 0) {\n                obj.up.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Update selection\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\n                obj.loadPage(0);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n                    if (obj.selectedCell[1] - item < 30) {\n                        obj.loadUp();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(1);\n    }\n\n    obj.up.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = 0; j < y; j++) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.up.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.up.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y - 1); j >= 0; j--) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.down = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[3] < obj.records.length - 1) {\n                obj.down.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[1] < obj.records.length - 1) {\n                obj.down.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n\n        // Change page\n        if (obj.options.lazyLoading == true) {\n            if ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n                obj.loadPage(-1);\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            } else {\n                if (obj.loadValidation()) {\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n                    if (item - obj.selectedCell[3] < 30) {\n                        obj.loadDown();\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    }\n                }\n            }\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateScroll(3);\n    }\n\n    obj.down.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var j = obj.rows.length - 1; j > y; j--) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    y = j;\n                    break;\n                }\n            }\n        } else {\n            y = obj.down.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.down.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var j = (y + 1); j < obj.rows.length; j++) {\n            if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                if (obj.records[j][x].getAttribute('data-merged')) {\n                    if (obj.records[j][x] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                y = j;\n                break;\n            }\n        }\n\n        return y;\n    }\n\n    obj.right = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] < obj.headers.length - 1) {\n                obj.right.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] < obj.headers.length - 1) {\n                obj.right.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(2);\n    }\n\n    obj.right.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = obj.headers.length - 1; i > x; i--) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.right.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.right.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n\n        for (var i = (x + 1); i < obj.headers.length; i++) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.left = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (obj.selectedCell[2] > 0) {\n                obj.left.visible(1, ctrlKey ? 0 : 1)\n            }\n        } else {\n            if (obj.selectedCell[0] > 0) {\n                obj.left.visible(0, ctrlKey ? 0 : 1)\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(0);\n    }\n\n    obj.left.visible = function(group, direction) {\n        if (group == 0) {\n            var x = parseInt(obj.selectedCell[0]);\n            var y = parseInt(obj.selectedCell[1]);\n        } else {\n            var x = parseInt(obj.selectedCell[2]);\n            var y = parseInt(obj.selectedCell[3]);\n        }\n\n        if (direction == 0) {\n            for (var i = 0; i < x; i++) {\n                if (obj.records[y][i].style.display != 'none') {\n                    x = i;\n                    break;\n                }\n            }\n        } else {\n            x = obj.left.get(x, y);\n        }\n\n        if (group == 0) {\n            obj.selectedCell[0] = x;\n            obj.selectedCell[1] = y;\n        } else {\n            obj.selectedCell[2] = x;\n            obj.selectedCell[3] = y;\n        }\n    }\n\n    obj.left.get = function(x, y) {\n        var x = parseInt(x);\n        var y = parseInt(y);\n        for (var i = (x - 1); i >= 0; i--) {\n            if (obj.records[y][i].style.display != 'none') {\n                if (obj.records[y][i].getAttribute('data-merged')) {\n                    if (obj.records[y][i] == obj.records[y][x]) {\n                        continue;\n                    }\n                }\n                x = i;\n                break;\n            }\n        }\n\n        return x;\n    }\n\n    obj.first = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = 0;\n            } else {\n                obj.left.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = 0;\n            } else {\n                obj.left.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\n            obj.loadPage(0);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(1);\n    }\n\n    obj.last = function(shiftKey, ctrlKey) {\n        if (shiftKey) {\n            if (ctrlKey) {\n                obj.selectedCell[3] = obj.records.length - 1;\n            } else {\n                obj.right.visible(1, 0);\n            }\n        } else {\n            if (ctrlKey) {\n                obj.selectedCell[1] = obj.records.length - 1;\n            } else {\n                obj.right.visible(0, 0);\n            }\n            obj.selectedCell[2] = obj.selectedCell[0];\n            obj.selectedCell[3] = obj.selectedCell[1];\n        }\n\n        // Change page\n        if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n            obj.loadPage(-1);\n        } else if (obj.options.pagination > 0) {\n            var pageNumber = obj.whichPage(obj.selectedCell[3]);\n            if (pageNumber != obj.pageNumber) {\n                obj.page(pageNumber);\n            }\n        }\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        obj.updateScroll(3);\n    }\n\n    obj.selectAll = function() {\n        if (! obj.selectedCell) {\n            obj.selectedCell = [];\n        }\n\n        obj.selectedCell[0] = 0;\n        obj.selectedCell[1] = 0;\n        obj.selectedCell[2] = obj.headers.length - 1;\n        obj.selectedCell[3] = obj.records.length - 1;\n\n        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    }\n\n    /**\n     * Go to a page in a lazyLoading\n     */\n    obj.loadPage = function(pageNumber) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = 100;\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        startRow = finalRow - 100;\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n\n            if (obj.tbody.children.length > quantityPerPage) {\n                obj.tbody.removeChild(obj.tbody.firstChild);\n            }\n        }\n    }\n\n    obj.loadUp = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the first element in the page\n            var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item > 0) {\n                for (var j = 0; j < 30; j++) {\n                    item = item - 1;\n                    if (item > -1) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\n                        } else {\n                            obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.lastChild);\n                            test = 1;\n                        }\n                    }\n                }\n            }\n        }\n        return test;\n    }\n\n    obj.loadDown = function() {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n        var test = 0;\n        if (results.length > 100) {\n            // Get the last element in the page\n            var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n            if (obj.options.search == true && obj.results) {\n                item = results.indexOf(item);\n            }\n            if (item < obj.rows.length - 1) {\n                for (var j = 0; j <= 30; j++) {\n                    if (item < results.length) {\n                        if (obj.options.search == true && obj.results) {\n                            obj.tbody.appendChild(obj.rows[results[item]]);\n                        } else {\n                            obj.tbody.appendChild(obj.rows[item]);\n                        }\n                        if (obj.tbody.children.length > 100) {\n                            obj.tbody.removeChild(obj.tbody.firstChild);\n                            test = 1;\n                        }\n                    }\n                    item = item + 1;\n                }\n            }\n        }\n\n        return test;\n    }\n\n    obj.loadValidation = function() {\n        if (obj.selectedCell) {\n            var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\n            var selectedPage = parseInt(obj.selectedCell[3] / 100);\n            var totalPages = parseInt(obj.rows.length / 100);\n\n            if (currentPage != selectedPage && selectedPage <= totalPages) {\n                if (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\n                    obj.loadPage(selectedPage);\n                    return true;\n                }\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Reset search\n     */\n    obj.resetSearch = function() {\n        obj.searchInput.value = '';\n        obj.search('');\n        obj.results = null;\n    }\n\n    /**\n     * Search\n     */\n    obj.search = function(query) {\n        // Query\n        if (query) {\n            var query = query.toLowerCase();\n        }\n\n        // Reset selection\n        obj.resetSelection();\n\n        // Total of results\n        obj.pageNumber = 0;\n        obj.results = [];\n\n        if (query) {\n            // Search filter\n            var search = function(item, query, index) {\n                for (var i = 0; i < item.length; i++) {\n                    if ((''+item[i]).toLowerCase().search(query) >= 0 ||\n                        (''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n\n            // Result\n            var addToResult = function(k) {\n                if (obj.results.indexOf(k) == -1) {\n                    obj.results.push(k);\n                }\n            }\n\n            // Filter\n            var data = obj.options.data.filter(function(v, k) {\n                if (search(v, query, k)) {\n                    // Merged rows found\n                    var rows = obj.isRowMerged(k);\n                    if (rows.length) {\n                        for (var i = 0; i < rows.length; i++) {\n                            var row = jexcel.getIdFromColumnName(rows[i], true);\n                            for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\n                                addToResult(row[1]+j);\n                            }\n                        }\n                    } else {\n                        // Normal row found\n                        addToResult(k);\n                    }\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n        } else {\n            obj.results = null;\n        }\n\n        var total = 0;\n        var index = 0;\n\n        // Page 1\n        if (obj.options.lazyLoading == true) {\n            total = 100;\n        } else if (obj.options.pagination > 0) {\n            total = obj.options.pagination;\n        } else {\n            if (obj.results) {\n                total = obj.results.length;\n            } else {\n                total = obj.rows.length;\n            }\n        }\n\n        // Reset current nodes\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Hide all records from the table\n        for (var j = 0; j < obj.rows.length; j++) {\n            if (! obj.results || obj.results.indexOf(j) > -1) {\n                if (index < total) {\n                    obj.tbody.appendChild(obj.rows[j]);\n                    index++;\n                }\n                obj.rows[j].style.display = '';\n            } else {\n                obj.rows[j].style.display = 'none';\n            }\n        }\n\n        // Update pagination\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        return total;\n    }\n\n    /**\n     * Which page the cell is\n     */\n    obj.whichPage = function(cell) {\n        // Search\n        if (obj.options.search == true && obj.results) {\n            cell = obj.results.indexOf(cell);\n        }\n\n        return (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\n    }\n\n    /**\n     * Go to page\n     */\n    obj.page = function(pageNumber) {\n        var oldPage = obj.pageNumber;\r\n\n        // Search\n        if (obj.options.search == true && obj.results) {\n            var results = obj.results;\n        } else {\n            var results = obj.rows;\n        }\n\n        // Per page\n        var quantityPerPage = parseInt(obj.options.pagination);\n\n        // pageNumber\n        if (pageNumber == null || pageNumber == -1) {\n            // Last page\n            pageNumber = Math.ceil(results.length / quantityPerPage); \n        }\n\n        // Page number\n        obj.pageNumber = pageNumber;\n\n        var startRow = (pageNumber * quantityPerPage);\n        var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n        if (finalRow > results.length) {\n            finalRow = results.length;\n        }\n        if (startRow < 0) {\n            startRow = 0;\n        }\n\n        // Reset container\n        while (obj.tbody.firstChild) {\n            obj.tbody.removeChild(obj.tbody.firstChild);\n        }\n\n        // Appeding items\n        for (var j = startRow; j < finalRow; j++) {\n            if (obj.options.search == true && obj.results) {\n                obj.tbody.appendChild(obj.rows[results[j]]);\n            } else {\n                obj.tbody.appendChild(obj.rows[j]);\n            }\n        }\n\n        if (obj.options.pagination > 0) {\n            obj.updatePagination();\n        }\n\n        // Update corner position\n        obj.updateCornerPosition();\n\r\n        if (typeof(obj.options.onchangepage) == 'function') {\r\n            obj.options.onchangepage(el, pageNumber, oldPage);\r\n        }\n    }\n\n    /**\n     * Update the pagination\n     */\n    obj.updatePagination = function() {\n        // Reset container\n        obj.pagination.children[0].innerHTML = '';\n        obj.pagination.children[1].innerHTML = '';\n\n        // Start pagination\n        if (obj.options.pagination) {\n            // Searchable\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results.length;\n            } else {\n                var results = obj.rows.length;\n            }\n\n            if (! results) {\n                // No records found\n                obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\n            } else {\n                // Pagination container\n                var quantyOfPages = Math.ceil(results / obj.options.pagination);\n\n                if (obj.pageNumber < 6) {\n                    var startNumber = 1;\n                    var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\n                } else if (quantyOfPages - obj.pageNumber < 5) {\n                    var startNumber = quantyOfPages - 9;\n                    var finalNumber = quantyOfPages;\n                    if (startNumber < 1) {\n                        startNumber = 1;\n                    }\n                } else {\n                    var startNumber = obj.pageNumber - 4;\n                    var finalNumber = obj.pageNumber + 5;\n                }\n\n                // First\n                if (startNumber > 1) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '<';\n                    paginationItem.title = 1;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Get page links\n                for (var i = startNumber; i <= finalNumber; i++) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = i;\n                    obj.pagination.children[1].appendChild(paginationItem);\n\n                    if (obj.pageNumber == (i-1)) {\n                        paginationItem.classList.add('jexcel_page_selected');\n                    }\n                }\n\n                // Last\n                if (finalNumber < quantyOfPages) {\n                    var paginationItem = document.createElement('div');\n                    paginationItem.className = 'jexcel_page';\n                    paginationItem.innerHTML = '>';\n                    paginationItem.title = quantyOfPages;\n                    obj.pagination.children[1].appendChild(paginationItem);\n                }\n\n                // Text\n                var format = function(format) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    return format.replace(/{(\\d+)}/g, function(match, number) {\n                      return typeof args[number] != 'undefined'\n                        ? args[number]\n                        : match\n                      ;\n                    });\n                };\n\n                obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\n            }\n        }\n    }\n\n    /**\n     * Download CSV table\n     * \n     * @return null\n     */\n    obj.download = function(includeHeaders) {\n        if (obj.options.allowExport == false) {\n            console.error('Export not allowed');\n        } else {\n            // Data\n            var data = '';\n            if (includeHeaders == true || obj.options.includeHeadersOnDownload == true) {\n                data += obj.getHeaders();\n                data += \"\\r\\n\";\n            }\n\r\n            // Get data\n            data += obj.copy(false, obj.options.csvDelimiter, true);\r\n\n            // Download element\n            var blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\n\r\n            // IE Compatibility\r\n            if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                window.navigator.msSaveOrOpenBlob(blob, options.csvFileName + '.csv');\r\n            } else {\n                // Download element\n                var pom = document.createElement('a');\n                var url = URL.createObjectURL(blob);\n                pom.href = url;\n                pom.setAttribute('download', obj.options.csvFileName + '.csv');\n                document.body.appendChild(pom);\n                pom.click();\n                pom.parentNode.removeChild(pom);\n            }\n        }\n    }\n\n    /**\n     * Initializes a new history record for undo/redo\n     * \n     * @return null\n     */\n    obj.setHistory = function(changes) {\n        if (obj.ignoreHistory != true) {\n            // Increment and get the current history index\n            var index = ++obj.historyIndex;\n\n            // Slice the array to discard undone changes\n            obj.history = (obj.history = obj.history.slice(0, index + 1));\n\n            // Keep history\n            obj.history[index] = changes;\n        }\n    }\n\n    /**\n     * Copy method\n     * \n     * @param bool highlighted - Get only highlighted cells\n     * @param delimiter - \\t default to keep compatibility with excel\n     * @return string value\n     */\n    obj.copy = function(highlighted, delimiter, returnData) {\n        if (! delimiter) {\n            delimiter = \"\\t\";\n        }\n\n        // Controls\n        var col = [];\n        var colLabel = [];\n        var row = [];\n        var rowLabel = [];\n        var x = obj.options.data[0].length\n        var y = obj.options.data.length\n        var tmp = '';\n\n        // Reset container\n        obj.style = [];\n\n        // Go through the columns to get the data\n        for (var j = 0; j < y; j++) {\n            col = [];\n            colLabel = [];\n\n            for (var i = 0; i < x; i++) {\n                // If cell is highlighted\n                if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                    // Values\n                    var value = obj.options.data[j][i];\n                    if (value.match && (value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\n                        value = value.replace(new RegExp('\"', 'g'), '\"\"');\n                        value = '\"' + value + '\"';\n                    }\n                    col.push(value);\n\n                    // Labels\n                    if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                        var label = value;\n                    } else {\r\n                        var label = obj.records[j][i].innerHTML;\n                        if (label.match && (label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\n                            // Scape double quotes\n                            label = label.replace(new RegExp('\"', 'g'), '\"\"');\n                            label = '\"' + label + '\"';\n                        }\r\n                    }\n                    colLabel.push(label);\n\n                    // Get style\n                    tmp = obj.records[j][i].getAttribute('style');\n                    obj.style.push(tmp ? tmp : '');\n                }\n            }\n\n            if (col.length) {\n                row.push(col.join(delimiter));\n            }\n            if (colLabel.length) {\n                rowLabel.push(colLabel.join(delimiter));\n            }\n        }\n\n        // Final string\n        var str = row.join(\"\\r\\n\");\n        var strLabel = rowLabel.join(\"\\r\\n\");\n\n        // Create a hidden textarea to copy the values\n        if (! returnData) {\n            if (obj.options.copyCompatibility == true) {\n                obj.textarea.value = strLabel;\n            } else {\n                obj.textarea.value = str;\n            }\n            obj.textarea.select();\n            document.execCommand(\"copy\");\n        }\n\n        // Keep data\n        if (obj.options.copyCompatibility == true) {\n            obj.data = strLabel;\n        } else {\n        obj.data = str;\n        }\n        // Keep non visible information\n        obj.hashString = obj.hash(obj.data);\n\n        return obj.data;\n    }\n\n    /**\n     * jExcel paste method\n     * \n     * @param integer row number\n     * @return string value\n     */\n    obj.paste = function(x, y, data) {\n        // Paste filter\n        if (typeof(obj.options.onbeforepaste) == 'function') {\n            var data = obj.options.onbeforepaste(el, data);\n        }\n\n        // Controls\n        var hash = obj.hash(data);\n        var style = (hash == obj.hashString) ? obj.style : null;\n\n        // Depending on the behavior\n        if (obj.options.copyCompatibility == true && hash == obj.hashString) {\n            var data = obj.data;\n        }\n\n        // Split new line\n        var data = obj.parseCSV(data, \"\\t\");\n\n        if (x != null && y != null && data) {\n            // Records\n            var i = 0;\n            var j = 0;\n            var records = [];\n            var newStyle = {};\n            var oldStyle = {};\n            var styleIndex = 0;\n\n            // Index\n            var colIndex = parseInt(x);\n            var rowIndex = parseInt(y);\n            var row = null;\n\n            // Go through the columns to get the data\n            while (row = data[j]) {\n                i = 0;\n                colIndex = parseInt(x);\n\n                while (row[i] != null) {\n                    // Update and keep history\n                    var record = obj.updateCell(colIndex, rowIndex, row[i]);\n                    // Keep history\n                    records.push(record);\n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(colIndex, rowIndex, records);\n                    // Style\n                    if (style && style[styleIndex]) {\n                        var columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\n                        newStyle[columnName] = style[styleIndex];\n                        oldStyle[columnName] = obj.getStyle(columnName);\n                        obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\n                        styleIndex++\n                    }\n                    i++;\n                    if (row[i] != null) {\n                        if (colIndex >= obj.headers.length - 1) {\n                            obj.insertColumn();\n                        }\n                        colIndex = obj.right.get(colIndex, rowIndex);\n                    }\n                }\n\n                j++;\n                if (data[j]) {\n                    if (rowIndex >= obj.rows.length-1) {\n                        obj.insertRow();\n                    }\n                    rowIndex = obj.down.get(x, rowIndex);\n                }\n            }\n\n            // Select the new cells\n            obj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\n\n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n                newStyle:newStyle,\n                oldStyle:oldStyle,\n            });\n\n            // Update table\n            obj.updateTable();\n\n            // Paste event\n            if (typeof(obj.options.onpaste) == 'function') {\n                obj.options.onpaste(el, records);\n            }\n\n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    }\n\n    /**\n     * Process row\n     */\n    obj.historyProcessRow = function(type, historyRecord) {\n        var rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : historyRecord.rowNumber;\n\n        if (obj.options.search == true) {\n            if (obj.results && obj.results.length != obj.rows.length) {\n                obj.resetSearch();\n            }\n        }\n\n        // Remove row\n        if (type == 1) {\n            var numOfRows = historyRecord.numOfRows;\n            // Remove nodes\n            for (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\n                obj.rows[j].parentNode.removeChild(obj.rows[j]);\n            }\n            // Remove references\n            obj.records.splice(rowIndex, numOfRows);\n            obj.options.data.splice(rowIndex, numOfRows);\n            obj.rows.splice(rowIndex, numOfRows);\n\n            obj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\n        } else {\n            // Insert data\n            obj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\n            obj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\n            obj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\n            // Insert nodes\n            var index = 0\n            for (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\n                obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\n                index++;\n            }\n        }\n\n        // Respect pagination\n        if (obj.options.pagination > 0) {\n            obj.page(obj.pageNumber);\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Process column\n     */\n    obj.historyProcessColumn = function(type, historyRecord) {\n        var columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\n\n        // Remove column\n        if (type == 1) {\n            var numOfColumns = historyRecord.numOfColumns;\n\n            obj.options.columns.splice(columnIndex, numOfColumns);\n            for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                obj.headers[i].parentNode.removeChild(obj.headers[i]);\n                obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\n            }\n            obj.headers.splice(columnIndex, numOfColumns);\n            obj.colgroup.splice(columnIndex, numOfColumns);\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                    obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\n                }\n                obj.records[j].splice(columnIndex, numOfColumns);\n                obj.options.data[j].splice(columnIndex, numOfColumns);\n            }\n\n            obj.conditionalSelectionUpdate(0, columnIndex, (numOfColumns + columnIndex) - 1);\n        } else {\n            // Insert data\n            obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\n            obj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\n            obj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\n\n            var index = 0\n            for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\n                obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\n                index++;\n            }\n\n            for (var j = 0; j < historyRecord.data.length; j++) {\n                obj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\n                obj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\n                var index = 0\n                for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                    obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\n                    index++;\n                }\n            }\n        }\n\n        // Adjust nested headers\n        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n            // Flexible way to handle nestedheaders\n            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                    if (type == 1) {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\n                    } else {\n                        var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\n                    }\n                    obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                    obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                }\n            } else {\n                if (type == 1) {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\n                } else {\n                    var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\n                }\n                obj.options.nestedHeaders[0].colspan = colspan;\n                obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n            }\n        }\n\n        obj.updateTableReferences();\n    }\n\n    /**\n     * Undo last action\n     */\n    obj.undo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex >= 0) {\n            // History\n            var historyRecord = obj.history[obj.historyIndex--];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.removeMerge(historyRecord.column, historyRecord.data);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.oldValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.oldValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                var rows = [];\n                for (var j = 0; j < historyRecord.rows.length; j++) {\n                    rows[historyRecord.rows[j]] = j;\n                }\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\n                obj.updateOrder(rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].oldValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.oldStyle) {\n                        obj.resetStyle(historyRecord.oldStyle, true);\n                    }\n                }\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onundo) == 'function') {\n            obj.options.onundo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Redo previously undone action\n     */\n    obj.redo = function() {\n        // Ignore events and history\n        var ignoreEvents = obj.ignoreEvents ? true : false;\n        var ignoreHistory = obj.ignoreHistory ? true : false;\n\n        obj.ignoreEvents = true;\n        obj.ignoreHistory = true;\n\n        // Records\n        var records = [];\n\n        // Update cells\n        if (obj.historyIndex < obj.history.length - 1) {\n            // History\n            var historyRecord = obj.history[++obj.historyIndex];\n\n            if (historyRecord.action == 'insertRow') {\n                obj.historyProcessRow(0, historyRecord);\n            } else if (historyRecord.action == 'deleteRow') {\n                obj.historyProcessRow(1, historyRecord);\n            } else if (historyRecord.action == 'insertColumn') {\n                obj.historyProcessColumn(0, historyRecord);\n            } else if (historyRecord.action == 'deleteColumn') {\n                obj.historyProcessColumn(1, historyRecord);\n            } else if (historyRecord.action == 'moveRow') {\n                obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'moveColumn') {\n                obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\n            } else if (historyRecord.action == 'setMerge') {\n                obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\n            } else if (historyRecord.action == 'setStyle') {\n                obj.setStyle(historyRecord.newValue, null, null, 1);\n            } else if (historyRecord.action == 'setWidth') {\n                obj.setWidth(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeight') {\n                obj.setHeight(historyRecord.row, historyRecord.newValue);\n            } else if (historyRecord.action == 'setHeader') {\n                obj.setHeader(historyRecord.column, historyRecord.newValue);\n            } else if (historyRecord.action == 'setComments') {\n                obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\n            } else if (historyRecord.action == 'orderBy') {\n                obj.updateOrderArrow(historyRecord.column, historyRecord.order);\n                obj.updateOrder(historyRecord.rows);\n            } else if (historyRecord.action == 'setValue') {\n                // Redo for changes in cells\n                for (var i = 0; i < historyRecord.records.length; i++) {\n                    obj.updateCell(historyRecord.records[i].col, historyRecord.records[i].row, historyRecord.records[i].newValue);\n                    obj.updateFormulaChain(historyRecord.records[i].col, historyRecord.records[i].row, records);\n                    if (historyRecord.newStyle) {\n                        obj.resetStyle(historyRecord.newStyle, true);\n                    }\n                }\n\n                // Update selection\n                if (! historyRecord.selection) {\n                    historyRecord.selection = [historyRecord.records[0].col, historyRecord.records[0].row];\n                }\n                obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\n                // Update table\n                obj.updateTable();\n            }\n        }\n        obj.ignoreEvents = ignoreEvents;\n        obj.ignoreHistory = ignoreHistory;\n\n        if (typeof(obj.options.onredo) == 'function') {\n            obj.options.onredo(el, historyRecord);\n        }\n    }\n\n    /**\n     * Get dropdown value from key\n     */\n    obj.getDropDownValue = function(column, key) {\n        var value = [];\n\n        if (obj.options.columns[column] && obj.options.columns[column].source) {\n            // Create array from source\n            var combo = [];\n            var source = obj.options.columns[column].source;\n\n            for (var i = 0; i < source.length; i++) {\n                if (typeof(source[i]) == 'object') {\n                    combo[source[i].id] = source[i].name;\n                } else {\n                    combo[source[i]] = source[i];\n                }\n            }\n\n            // Garante single multiple compatibily\n            var keys = ('' + key).split(';')\n\n            for (var i = 0; i < keys.length; i++) {\n                if (combo[keys[i]]) {\n                    value.push(combo[keys[i]]);\n                }\n            }\n        } else {\n            console.error('Invalid column');\n        }\n\n        return (value.length > 0) ? value.join('; ') : '';\n    }\n\n    /**\n     * From starckoverflow contributions\n     */\n    obj.parseCSV = function(str, delimiter) {\n        // Remove last line break\n        str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\n        // Last caracter is the delimiter\n        if (str.charCodeAt(str.length-1) == 9) {\n            str += \"\\0\";\n        }\n        // user-supplied delimeter or default comma\n        delimiter = (delimiter || \",\");\n\n        var arr = [];\n        var quote = false;  // true means we're inside a quoted field\n        // iterate over each character, keep track of current row and column (of the returned array)\n        for (var row = 0, col = 0, c = 0; c < str.length; c++) {\n            var cc = str[c], nc = str[c+1];\n            arr[row] = arr[row] || [];\n            arr[row][col] = arr[row][col] || '';\n\n            // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\n            if (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }  \n\n            // If it's just one quotation mark, begin/end quoted field\n            if (cc == '\"') { quote = !quote; continue; }\n\n            // If it's a comma and we're not in a quoted field, move on to the next column\n            if (cc == delimiter && !quote) { ++col; continue; }\n\n            // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\n            if (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\n\n            // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\n            if (cc == '\\n' && !quote) { ++row; col = 0; continue; }\n            if (cc == '\\r' && !quote) { ++row; col = 0; continue; }\n\n            // Otherwise, append the current character to the current column\n            arr[row][col] += cc;\n        }\n        return arr;\n    }\n\n    obj.hash = function(str) {\n        var hash = 0, i, chr;\n\n        if (str.length === 0) {\n            return hash;\n        } else {\n            for (i = 0; i < str.length; i++) {\n              chr = str.charCodeAt(i);\n              hash = ((hash << 5) - hash) + chr;\n              hash |= 0;\n            }\n        }\n        return hash;\n    }\n\n    obj.onafterchanges = function(el, records) {\n        if (! obj.ignoreEvents) {\n            // On after changes\n            if (typeof(obj.options.onafterchanges) == 'function') {\n                obj.options.onafterchanges(el, records);\n            }\n        }\n    }\r\n\n    obj.destroy = function() {\r\n        jexcel.destroy(el);\r\n    }\r\n\n    /**\n     * Initialization method\n     */\n    obj.init = function() {\n        jexcel.current = obj;\n\n        // Build handlers\n        if (typeof(jexcel.build) == 'function') {\n            jexcel.build();\n            jexcel.build = null;\n        }\n\n        // Load the table data based on an CSV file\n        if (obj.options.csv) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            // Load CSV file\n            jSuites.ajax({\n                url: obj.options.csv,\n                method: 'GET',\n                dataType: 'text',\n                success: function(result) {\n                    // Convert data\n                    var newData = obj.parseCSV(result, obj.options.csvDelimiter)\n\n                    // Headers\n                    if (obj.options.csvHeaders == true && newData.length > 0) {\n                        var headers = newData.shift();\n                        for(var i = 0; i < headers.length; i++) {\n                            if (! obj.options.columns[i]) {\n                                obj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\n                            }\n                            // Precedence over pre-configurated titles\n                            if (typeof obj.options.columns[i].title === 'undefined') {\n                              obj.options.columns[i].title = headers[i];\n                            }\n                        }\n                    }\n                    // Data\n                    obj.options.data = newData;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else if (obj.options.url) {\n            // Loading\n            if (obj.options.loadingSpin == true) {\n                jSuites.loading.show();\n            }\n\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Data\n                    obj.options.data = (result.data) ? result.data : result;\n                    // Prepare table\n                    obj.prepareTable();\n                    // Hide spin\n                    if (obj.options.loadingSpin == true) {\n                        jSuites.loading.hide();\n                    }\n                }\n            });\n        } else {\n            // Prepare table\n            obj.prepareTable();\n        }\n    }\n\n    // Context menu\n    if (options && options.contextMenu != null) {\n        obj.options.contextMenu = options.contextMenu;\n    } else {\n        obj.options.contextMenu = function(el, x, y, e) {\n            var items = [];\n\n            if (y == null) {\n                // Insert a new column\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnBefore,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 1);\n                        }\n                    });\n                }\n\n                if (obj.options.allowInsertColumn == true) {\n                    items.push({\n                        title:obj.options.text.insertANewColumnAfter,\n                        onclick:function() {\n                            obj.insertColumn(1, parseInt(x), 0);\n                        }\n                    });\n                }\n\n                // Delete a column\n                if (obj.options.allowDeleteColumn == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedColumns,\n                        onclick:function() {\n                            obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n                        }\n                    });\n                }\n\n                // Rename column\n                if (obj.options.allowRenameColumn == true) {\n                    items.push({\n                        title:obj.options.text.renameThisColumn,\n                        onclick:function() {\n                            obj.setHeader(x);\n                        }\n                    });\n                }\n\n                // Sorting\n                if (obj.options.columnSorting == true) {\n                    // Line\n                    items.push({ type:'line' });\n\n                    items.push({\n                        title:obj.options.text.orderAscending,\n                        onclick:function() {\n                            obj.orderBy(x, 0);\n                        }\n                    });\n                    items.push({\n                        title:obj.options.text.orderDescending,\n                        onclick:function() {\n                            obj.orderBy(x, 1);\n                        }\n                    });\n                }\n            } else {\n                // Insert new row\n                if (obj.options.allowInsertRow == true) {\n                    items.push({\n                        title:obj.options.text.insertANewRowBefore,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y), 1);\n                        }\n                    });\n\n                    items.push({\n                        title:obj.options.text.insertANewRowAfter,\n                        onclick:function() {\n                            obj.insertRow(1, parseInt(y));\n                        }\n                    });\n                }\n\n                if (obj.options.allowDeleteRow == true) {\n                    items.push({\n                        title:obj.options.text.deleteSelectedRows,\n                        onclick:function() {\n                            obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n                        }\n                    });\n                }\n\n                if (x) {\n                    if (obj.options.allowComments == true) {\n                        items.push({ type:'line' });\n\n                        var title = obj.records[y][x].getAttribute('title') || '';\n\n                        items.push({\n                            title: title ? obj.options.text.editComments : obj.options.text.addComments,\n                            onclick:function() {\n                                var comment = prompt(obj.options.text.comments, title);\r\n                                if (comment) {\r\n                                    obj.setComments([ x, y ], comment);\r\n                                }\n                            }\n                        });\n\n                        if (title) {\n                            items.push({\n                                title:obj.options.text.clearComments,\n                                onclick:function() {\n                                    obj.setComments([ x, y ], '');\n                                }\n                            });\n                        }\n                    }\n                }\n            }\n\n            // Line\n            items.push({ type:'line' });\n\n            // Copy\n            items.push({\n                title:obj.options.text.copy,\n                shortcut:'Ctrl + C',\n                onclick:function() {\n                    obj.copy(true);\n                }\n            });\n\n            // Paste\n            if (navigator && navigator.clipboard) {\n                items.push({\n                    title:obj.options.text.paste,\n                    shortcut:'Ctrl + V',\n                    onclick:function() {\n                        if (obj.selectedCell) {\n                            navigator.clipboard.readText().then(function(text) {\n                                if (text) {\n                                    jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\n                                }\n                            });\n                        }\n                    }\n                });\n            }\n\n            // Save\n            if (obj.options.allowExport) {\n                items.push({\n                    title: obj.options.text.saveAs,\n                    shortcut: 'Ctrl + S',\n                    onclick: function () {\n                        obj.download();\n                    }\n                });\n            }\n\n            // About\n            if (obj.options.about) {\n                items.push({\n                    title:obj.options.text.about,\n                    onclick:function() {\n                        alert(obj.options.about);\n                    }\n                });\n            }\n\n            return items;\n        }\n    }\n\n    obj.scrollControls = function(e) {\n        if (obj.options.lazyLoading == true) {\n            if (jexcel.timeControlLoading == null) {\n                jexcel.timeControlLoading = setTimeout(function() {\n                    if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight) {\n                        if (obj.loadDown()) {\n                            if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\n                                obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    } else if (obj.content.scrollTop <= obj.content.clientHeight) {\n                        if (obj.loadUp()) {\n                            if (obj.content.scrollTop < 10) {\n                                obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\n                            }\n                            obj.updateCornerPosition();\n                        }\n                    }\n\n                    jexcel.timeControlLoading = null;\n                }, 100);\n            }\n        }\n\n        // Close editor\n        if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\n            if (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\n                obj.closeEditor(obj.edition[0], true);\n            }\n        }\n    }\n\n    el.addEventListener(\"DOMMouseScroll\", obj.scrollControls);\n    el.addEventListener(\"mousewheel\", obj.scrollControls);\n\n    el.jexcel = obj;\n\n    obj.init();\n\n    return obj;\n});\n\njexcel.current = null;\njexcel.timeControl = null;\njexcel.timeControlLoading = null;\n\njexcel.destroy = function(element, destroyEventHandlers) {\n    if (element.jexcel) {\n        element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\n        element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\n        element.jexcel = null;\n        element.innerHTML = '';\n\n        if (destroyEventHandlers) {\n            document.removeEventListener(\"keydown\", jexcel.keyDownControls);\n            document.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\n            document.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\n            document.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\n            document.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\n            document.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\n            document.removeEventListener(\"paste\", jexcel.pasteControls);\n            document.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\n            document.removeEventListener(\"touchstart\", jexcel.touchStartControls);\n            document.removeEventListener(\"touchend\", jexcel.touchEndControls);\n            document.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\n            jexcel = null;\n        }\n    }\n}\n\njexcel.build = function() {\n    document.addEventListener(\"keydown\", jexcel.keyDownControls);\n    document.addEventListener(\"mouseup\", jexcel.mouseUpControls);\n    document.addEventListener(\"mousedown\", jexcel.mouseDownControls);\n    document.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\n    document.addEventListener(\"mouseover\", jexcel.mouseOverControls);\n    document.addEventListener(\"dblclick\", jexcel.doubleClickControls);\n    document.addEventListener(\"paste\", jexcel.pasteControls);\n    document.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\n    document.addEventListener(\"touchstart\", jexcel.touchStartControls);\n    document.addEventListener(\"touchend\", jexcel.touchEndControls);\n    document.addEventListener(\"touchcancel\", jexcel.touchEndControls);\n    document.addEventListener(\"touchmove\", jexcel.touchEndControls);\n}\n\n/**\n * Events\n */\njexcel.keyDownControls = function(e) {\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            if (e.which == 27) {\n                // Escape\n                if (jexcel.current.edition) {\n                    // Exit without saving\n                    jexcel.current.closeEditor(jexcel.current.edition[0], false);\n                }\n                e.preventDefault();\n            } else if (e.which == 13) {\n                // Enter\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.editor[0].children[0].calendar.close(1);\n                } else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\n                           jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\n                    // Do nothing\n                } else {\n                    // Alt enter -> do not close editor\n                    if ((jexcel.current.options.wordWrap == true ||\n                         jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\n                         jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\n                        // Add new line to the editor\n                        var editorTextarea = jexcel.current.edition[0].children[0];\n                        var editorValue = jexcel.current.edition[0].children[0].value;\n                        var editorIndexOf = editorTextarea.selectionStart;\n                        editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\n                        editorTextarea.value = editorValue;\n                        editorTextarea.focus();\n                        editorTextarea.selectionStart = editorIndexOf + 1;\n                        editorTextarea.selectionEnd = editorIndexOf + 1;\n                    } else {\n                        jexcel.current.edition[0].children[0].blur();\n                    }\n                }\n            } else if (e.which == 9) {\n                // Tab\n                if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                    jexcel.current.edition[0].children[0].calendar.close(1);\n                } else {\n                    jexcel.current.edition[0].children[0].blur();\n                }\n            }\n        }\n\n        if (! jexcel.current.edition && jexcel.current.selectedCell) {\n            // Which key\n            if (e.which == 37) {\n                jexcel.current.left(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 39) {\n                jexcel.current.right(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 38) {\n                jexcel.current.up(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 40) {\n                jexcel.current.down(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 36) {\n                jexcel.current.first(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 35) {\n                jexcel.current.last(e.shiftKey, e.ctrlKey);\n                e.preventDefault();\n            } else if (e.which == 32) {\n                if (jexcel.current.options.editable == true) {\n                    jexcel.current.setCheckRadioValue();\n                }\n                e.preventDefault();\n            } else if (e.which == 46) {\n                // Delete\n                if (jexcel.current.options.editable == true) {\n                    if (jexcel.current.selectedRow) {\n                        if (jexcel.current.options.allowDeleteRow == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\n                                jexcel.current.deleteRow();\n                            }\n                        }\n                    } else if (jexcel.current.selectedHeader) {\n                        if (jexcel.current.options.allowDeleteColumn == true) {\n                            if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\n                                jexcel.current.deleteColumn();\n                            }\n                        }\n                    } else {\n                        // Change value\n                        jexcel.current.setValue(jexcel.current.highlighted, '');\n                    }\n                }\n            } else if (e.which == 13) {\n                // Move cursor\n                if (e.shiftKey) {\n                    jexcel.current.up();\n                } else {\n                    if (jexcel.current.options.allowInsertRow == true) {\n                        if (jexcel.current.options.allowManualInsertRow == true) {\n                            if (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\n                                // New record in case selectedCell in the last row\n                                jexcel.current.insertRow();\n                            }\n                        }\n                    }\n\n                    jexcel.current.down();\n                }\n                e.preventDefault();\n            } else if (e.which == 9) {\n                // Tab\n                if (e.shiftKey) {\n                    jexcel.current.left();\n                } else {\n                    if (jexcel.current.options.allowInsertColumn == true) {\n                        if (jexcel.current.options.allowManualInsertColumn == true) {\n                            if (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\n                                // New record in case selectedCell in the last column\n                                jexcel.current.insertColumn();\n                            }\n                        }\n                    }\n\n                    jexcel.current.right();\n                }\n                e.preventDefault();\n            } else {\n                if ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\n                    if (e.which == 65) {\n                        // Ctrl + A\n                        jexcel.current.selectAll();\n                        e.preventDefault();\n                    } else if (e.which == 83) {\n                        // Ctrl + S\n                        jexcel.current.download();\n                        e.preventDefault();\n                    } else if (e.which == 89) {\n                        // Ctrl + Y\n                        jexcel.current.redo();\n                        e.preventDefault();\n                    } else if (e.which == 90) {\n                        // Ctrl + Z\n                        jexcel.current.undo();\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 67) {\n                        // Ctrl + C\n                        jexcel.current.copy(true);\n                        e.preventDefault();\n                    } else if (e.which == 88) {\n                        // Ctrl + X\n                        if (jexcel.current.options.editable == true) {\n                            jexcel.cutControls();\n                        } else {\n                            jexcel.copyControls();\n                        }\n                        e.preventDefault();\n                    } else if (e.which == 86) {\n                        // Ctrl + V\n                        jexcel.pasteControls();\n                    }\n                } else {\n                    if (jexcel.current.selectedCell) {\n                        if (jexcel.current.options.editable == true) {\n                            var rowId = jexcel.current.selectedCell[1];\n                            var columnId = jexcel.current.selectedCell[0];\n\n                            // If is not readonly\n                            if (jexcel.current.options.columns[columnId].type != 'readonly') {\n                                // Characters able to start a edition\n                                if (e.keyCode == 32) {\n                                    // Space\n                                    if (jexcel.current.options.columns[columnId].type == 'checkbox' ||\n                                        jexcel.current.options.columns[columnId].type == 'radio') {\n                                        e.preventDefault();\n                                    } else {\n                                        // Start edition\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    }\n                                } else if (e.keyCode == 113) {\n                                    // Start edition with current content F2\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\n                                } else if ((e.keyCode == 8) ||\n                                           (e.keyCode >= 48 && e.keyCode <= 57) ||\n                                           (e.keyCode >= 96 && e.keyCode <= 111) ||\n                                           (e.keyCode == 187) ||\n                                           (e.keyCode == 189) ||\n                                           ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\n                                    // Start edition\n                                    jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                    // Prevent entries in the calendar\n                                    if (jexcel.current.options.columns[columnId].type == 'calendar') {\n                                        e.preventDefault();\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        } else {\n            if (e.target.classList.contains('jexcel_search')) {\n                if (jexcel.timeControl) {\n                    clearTimeout(jexcel.timeControl);\n                }\n\n                jexcel.timeControl = setTimeout(function() {\n                    jexcel.current.search(e.target.value);\n                }, 200);\n            }\n        }\n    }\n}\n\njexcel.isMouseAction = false;\n\njexcel.mouseDownControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    // Get elements\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection(true);\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current && mouseButton == 1) {\n        if (e.target.classList.contains('jexcel_selectall')) {\n            if (jexcel.current) {\n                jexcel.current.selectAll();\n            }\n        } else if (e.target.classList.contains('jexcel_corner')) {\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.selectedCorner = true;\n            }\n        } else {\n            // Header found\n            if (jexcelTable[1] == 1) {\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    // Update cursor\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            mousePosition: e.pageX,\n                            column: columnId,\n                            width: info.width,\n                        };\n\n                        // Border indication\n                        jexcel.current.headers[columnId].classList.add('resizing');\n                        for (var j = 0; j < jexcel.current.records.length; j++) {\n                            if (jexcel.current.records[j][columnId]) {\n                                jexcel.current.records[j][columnId].classList.add('resizing');\n                            }\n                        }\n                    } else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target,\n                                column:columnId,\n                                destination:columnId,\n                            };\n                            // Border indication\n                            jexcel.current.headers[columnId].classList.add('dragging');\n                            for (var j = 0; j < jexcel.current.records.length; j++) {\n                                if (jexcel.current.records[j][columnId]) {\n                                    jexcel.current.records[j][columnId].classList.add('dragging');\n                                }\n                            }\n                        }\n                    } else {\n                        if (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedHeader;\n                            var d = columnId;\n                        } else {\n                            // Press to rename\n                            if (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\n                                jexcel.timeControl = setTimeout(function() {\n                                    jexcel.current.setHeader(columnId);\n                                }, 800);\n                            }\n\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedHeader = columnId;\n\n                            // Update selection single column\n                            var o = columnId;\n                            var d = columnId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                } else {\n                    if (e.target.parentNode.classList.contains('jexcel_nested')) {\n                        if (e.target.getAttribute('data-column')) {\n                            var column = e.target.getAttribute('data-column').split(',');\n                            var c1 = parseInt(column[0]);\n                            var c2 = parseInt(column[column.length-1]);\n                        } else {\r\n                            var c1 = 0;\r\n                            var c2 = jexcel.current.options.columns.length - 1;\r\n                        }\n                        jexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\n                    }\n                }\n            } else {\n                jexcel.current.selectedHeader = false;\n            }\n\n            // Body found\n            if (jexcelTable[1] == 2) {\n                var rowId = e.target.getAttribute('data-y');\n\n                if (e.target.classList.contains('jexcel_row')) {\n                    var info = e.target.getBoundingClientRect();\n                    if (jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\n                        // Resize helper\n                        jexcel.current.resizing = {\n                            element: e.target.parentNode,\n                            mousePosition: e.pageY,\n                            row: rowId,\n                            height: info.height,\n                        };\n                        // Border indication\n                        e.target.parentNode.classList.add('resizing');\n                    } else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell');\n                        } else if (jexcel.current.options.search == true && jexcel.current.results) {\n                            console.error('JEXCEL: Please clear your search before perform this action');\n                        } else {\n                            // Reset selection\n                            jexcel.current.resetSelection();\n                            // Drag helper\n                            jexcel.current.dragging = {\n                                element: e.target.parentNode,\n                                row:rowId,\n                                destination:rowId,\n                            };\n                            // Border indication\n                            e.target.parentNode.classList.add('dragging');\n                        }\n                    } else {\n                        if (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                        } else {\n                            // Keep track of which header was selected first\n                            jexcel.current.selectedRow = rowId;\n\n                            // Update selection single column\n                            var o = rowId;\n                            var d = rowId;\n                        }\n\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                    }\n                } else {\n                    // Jclose\n                    if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                    } else {\n                        var getCellCoords = function(element) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return [x, y];\n                            } else {\n                                if (element.parentNode) {\n                                    return getCellCoords(element.parentNode);\n                                }\n                            }\n                        };\n\n                        var position = getCellCoords(e.target);\n                        if (position) {\n                            var columnId = position[0];\n                            var rowId = position[1];\n                            // Close edition\n                            if (jexcel.current.edition) {\n                                if (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\n                                    jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                                }\n                            }\n\n                            if (! jexcel.current.edition) {\n                                // Update cell selection\n                                if (e.shiftKey) {\n                                    jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                } else {\n                                    jexcel.current.updateSelectionFromCoords(columnId, rowId);\n                                }\n                            }\n\n                            // No full row selected\n                            jexcel.current.selectedHeader = null;\n                            jexcel.current.selectedRow = null;\n                        }\n                    }\n                }\n            } else {\n                jexcel.current.selectedRow = false;\n            }\n\n            // Pagination\n            if (e.target.classList.contains('jexcel_page')) {\n                if (e.target.innerText == '<') {\n                    jexcel.current.page(0);\n                } else if (e.target.innerText == '>') {\n                    jexcel.current.page(e.target.getAttribute('title') - 1);\n                } else {\n                    jexcel.current.page(e.target.innerText - 1);\n                }\n            }\n        }\n\n        if (jexcel.current.edition) {\n            jexcel.isMouseAction = false;\n        } else {\n            jexcel.isMouseAction = true;\n        }\n    } else {\n        jexcel.isMouseAction = false;\n    }\n}\n\njexcel.mouseUpControls = function(e) {\n    if (jexcel.current) {\n        // Update cell size\n        if (jexcel.current.resizing) {\n            // Columns to be updated\n            if (jexcel.current.resizing.column) {\n                // Remove Class\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                var newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\n                jexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\n                // Remove border\n                jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\n                for (var j = 0; j < jexcel.current.records.length; j++) {\n                    if (jexcel.current.records[j][jexcel.current.resizing.column]){\n                        jexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\n                    }\n                }\n            } else {\n                // Remove Class\n                jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\n                var newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\n                jexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\n                // Remove border\n                jexcel.current.resizing.element.classList.remove('resizing');\n            }\n            // Reset resizing helper\n            jexcel.current.resizing = null;\n        } else if (jexcel.current.dragging) {\n            // Reset dragging helper\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    // Target\n                    var columnId = e.target.getAttribute('data-x');\n                    // Remove move style\n                    jexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\n                    for (var j = 0; j < jexcel.current.rows.length; j++) {\n                        if (jexcel.current.records[j][jexcel.current.dragging.column]) {\n                            jexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\n                        }\n                    }\n                    for (var i = 0; i < jexcel.current.headers.length; i++) {\n                        jexcel.current.headers[i].classList.remove('dragging-left');\n                        jexcel.current.headers[i].classList.remove('dragging-right');\n                    }\n                    // Update position\n                    if (columnId) {\n                        if (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\n                            jexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\n                        }\n                    }\n                } else {\n                    var position = Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children, jexcel.current.dragging.element);\n                    if (jexcel.current.dragging.row != position) {\n                        jexcel.current.moveRow(jexcel.current.dragging.row, position, true);\n                    }\n                    jexcel.current.dragging.element.classList.remove('dragging');\n                }\n                jexcel.current.dragging = null;\n            }\n        } else {\n            // Close any corner selection\n            if (jexcel.current.selectedCorner) {\n                jexcel.current.selectedCorner = false;\n\n                // Data to be copied\n                if (jexcel.current.selection.length > 0) {\n                    // Copy data\n                    jexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\n\n                    // Remove selection\n                    jexcel.current.removeCopySelection();\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n\n    // Mouse up\n    jexcel.isMouseAction = false;\n}\n\n// Mouse move controls\njexcel.mouseMoveControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.isMouseAction == true) {\n            // Resizing is ongoing\n            if (jexcel.current.resizing) {\n                if (jexcel.current.resizing.column) {\n                    var width = e.pageX - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.width + width > 0) {\n                        var tempWidth = jexcel.current.resizing.width + width;\n                        jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                } else {\n                    var height = e.pageY - jexcel.current.resizing.mousePosition;\n\n                    if (jexcel.current.resizing.height + height > 0) {\n                        var tempHeight = jexcel.current.resizing.height + height;\n                        jexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\n\n                        jexcel.current.updateCornerPosition();\n                    }\n                }\n            }\n        } else {\n            var x = e.target.getAttribute('data-x');\n            var y = e.target.getAttribute('data-y');\n            var rect = e.target.getBoundingClientRect();\n\n            if (jexcel.current.cursor) {\n                jexcel.current.cursor.style.cursor = '';\n                jexcel.current.cursor = null;\n            }\n\n            if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\n                if (e.target.parentNode.parentNode.classList.contains('resizable')) {\n                    if (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'col-resize';\n                    } else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'row-resize';\n                    }\n                }\n\n                if (e.target.parentNode.parentNode.classList.contains('draggable')) {\n                    if (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    } else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 6)) {\n                        jexcel.current.cursor = e.target;\n                        jexcel.current.cursor.style.cursor = 'move';\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.mouseOverControls = function(e) {\n    e = e || window.event;\n    if (e.buttons) {\n        var mouseButton = e.buttons;\n    } else if (e.button) {\n        var mouseButton = e.button;\n    } else {\n        var mouseButton = e.which;\n    }\n\n    if (! mouseButton) {\n        jexcel.isMouseAction = false;\n    }\n\n    if (jexcel.current && jexcel.isMouseAction == true) {\n        // Get elements\n        var jexcelTable = jexcel.getElement(e.target);\n\n        if (jexcelTable[0]) {\n            // Avoid cross reference\n            if (jexcel.current != jexcelTable[0].jexcel) {\n                if (jexcel.current) {\n                    return false;\n                }\n            }\n\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (jexcel.current.dragging) {\n                if (jexcel.current.dragging.column) {\n                    if (columnId) {\n                        if (jexcel.current.isColMerged(columnId).length) {\n                            console.error('JEXCEL: This column is part of a merged cell.');\n                        } else {\n                            for (var i = 0; i < jexcel.current.headers.length; i++) {\n                                jexcel.current.headers[i].classList.remove('dragging-left');\n                                jexcel.current.headers[i].classList.remove('dragging-right');\n                            }\n\n                            if (jexcel.current.dragging.column == columnId) {\n                                jexcel.current.dragging.destination = parseInt(columnId);\n                            } else {\n                                if (e.target.clientWidth / 2 > e.offsetX) {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId) - 1;\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-left');\n                                } else {\n                                    if (jexcel.current.dragging.column < columnId) {\n                                        jexcel.current.dragging.destination = parseInt(columnId);\n                                    } else {\n                                        jexcel.current.dragging.destination = parseInt(columnId) + 1;\n                                    }\n                                    jexcel.current.headers[columnId].classList.add('dragging-right');\n                                }\n                            }\n                        }\n                    }\n                } else {\n                    if (rowId) {\n                        if (jexcel.current.isRowMerged(rowId).length) {\n                            console.error('JEXCEL: This row is part of a merged cell.');\n                        } else {\n                            var target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\n                            e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\n                        }\n                    }\n                }\n            } else if (jexcel.current.resizing) {\n            } else {\n                // Header found\n                if (jexcelTable[1] == 1) {\n                    if (jexcel.current.selectedHeader) {\n                        var columnId = e.target.getAttribute('data-x');\n                        var o = jexcel.current.selectedHeader;\n                        var d = columnId;\n                        // Update selection\n                        jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                    }\n                }\n\n                // Body found\n                if (jexcelTable[1] == 2) {\n                    if (e.target.classList.contains('jexcel_row')) {\n                        if (jexcel.current.selectedRow) {\n                            var o = jexcel.current.selectedRow;\n                            var d = rowId;\n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                        }\n                    } else {\n                        // Do not select edtion is in progress\n                        if (! jexcel.current.edition) {\n                            if (columnId && rowId) {\n                                if (jexcel.current.selectedCorner) {\n                                    jexcel.current.updateCopySelection(columnId, rowId);\n                                } else {\n                                    if (jexcel.current.selectedCell) {\n                                        jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n    }\n}\n\n/**\n * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\n */\njexcel.doubleClickControls = function(e) {\n    // Jexcel is selected\n    if (jexcel.current) {\n        // Corner action\n        if (e.target.classList.contains('jexcel_corner')) {\n            // Any selected cells\n            if (jexcel.current.highlighted.length > 0) {\n                // Copy from this\n                var x1 = jexcel.current.highlighted[0].getAttribute('data-x');\n                var y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\n                // Until this\n                var x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\n                var y2 = jexcel.current.records.length - 1\n                // Execute copy\n                jexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\n            }\n        } else {\n            // Get table\n            var jexcelTable = jexcel.getElement(e.target);\n\n            // Double click over header\n            if (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\n                // Check valid column header coords\n                var columnId = e.target.getAttribute('data-x');\n                if (columnId) {\n                    jexcel.current.orderBy(columnId);\n                }\n            }\n\n            // Double click over body\n            if (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\n                if (! jexcel.current.edition) {\n                    var getCellCoords = function(element) {\n                        if (element.parentNode) {\n                            var x = element.getAttribute('data-x');\n                            var y = element.getAttribute('data-y');\n                            if (x && y) {\n                                return element;\n                            } else {\n                                return getCellCoords(element.parentNode);\n                            }\n                        }\n                    }\n                    var cell = getCellCoords(e.target);\n                    if (cell && cell.classList.contains('highlight')) {\n                        jexcel.current.openEditor(cell);\n                    }\n                }\n            }\n        }\n    }\n}\n\njexcel.copyControls = function(e) {\n    if (jexcel.current && jexcel.copyControls.enabled) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n        }\n    }\n}\n\njexcel.cutControls = function(e) {\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            jexcel.current.copy(true);\n            if (jexcel.current.options.editable == true) {\n                jexcel.current.setValue(jexcel.current.highlighted, '');\n            }\n        }\n    }\n}\n\njexcel.pasteControls = function(e) {\n    if (jexcel.current && jexcel.current.selectedCell) {\n        if (! jexcel.current.edition) {\n            if (jexcel.current.options.editable == true) {\n                if (e && e.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\n                    e.preventDefault();\n                } else if (window.clipboardData) {\n                    jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\n                }\n            }\n        }\n    }\n}\n\njexcel.contextMenuControls = function(e) {\n    e = e || window.event;\n    if (\"buttons\" in e) {\n        var mouseButton = e.buttons;\n    } else {\n        var mouseButton = e.which || e.button;\n    }\n\n    if (jexcel.current) {\n        if (jexcel.current.edition) {\n            e.preventDefault();\n        } else if (jexcel.current.options.contextMenu) {\n            jexcel.current.contextMenu.contextmenu.close();\n\n            if (jexcel.current) {\n                var x = e.target.getAttribute('data-x');\n                var y = e.target.getAttribute('data-y');\n\n                if (x || y) {\n                    // Table found\n                    var items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\n                    // The id is depending on header and body\n                    jexcel.current.contextMenu.contextmenu.open(e, items);\n                    // Avoid the real one\n                    e.preventDefault();\n                }\n            }\n        }\n    }\n}\n\njexcel.touchStartControls = function(e) {\n    var jexcelTable = jexcel.getElement(e.target);\n\n    if (jexcelTable[0]) {\n        if (jexcel.current != jexcelTable[0].jexcel) {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n            }\n            jexcel.current = jexcelTable[0].jexcel;\n        }\n    } else {\n        if (jexcel.current) {\n            jexcel.current.resetSelection();\n            jexcel.current = null;\n        }\n    }\n\n    if (jexcel.current) {\n        if (! jexcel.current.edition) {\n            var columnId = e.target.getAttribute('data-x');\n            var rowId = e.target.getAttribute('data-y');\n\n            if (columnId && rowId) {\n                jexcel.current.updateSelectionFromCoords(columnId, rowId);\n\n                jexcel.timeControl = setTimeout(function() {\n                    // Keep temporary reference to the element\r\n                    if (jexcel.current.options.columns[columnId].type == 'color') {\r\n                        jexcel.tmpElement = null;\r\n                    } else {\r\n                        jexcel.tmpElement = e.target;\r\n                    }\r\n                    jexcel.current.openEditor(e.target, false, e);\n                }, 500);\n            }\n        }\n    }\n}\n\njexcel.touchEndControls = function(e) {\n    // Clear any time control\n    if (jexcel.timeControl) {\n        clearTimeout(jexcel.timeControl);\n        jexcel.timeControl = null;\n        // Element\r\n        if (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n            jexcel.tmpElement.children[0].focus();\r\n        }\n        jexcel.tmpElement = null;\n    }\r\n}\r\n\r\n/**\r\n * Jexcel extensions\r\n */\r\n\r\njexcel.createTabs = function(tabs, result) {\r\n    // Create tab container\r\n    tabs.innerHTML = '';\r\n    tabs.classList.add('jexcel_tabs');\r\n    var spreadsheet = []\r\n    var link = [];\r\n    for (var i = 0; i < result.length; i++) {\r\n        // Spreadsheet container\r\n        spreadsheet[i] = document.createElement('div');\r\n        spreadsheet[i].classList.add('jexcel_tab');\r\n        // Tab link\r\n        link[i] = document.createElement('div');\r\n        link[i].classList.add('jexcel_tab_link');\r\n        link[i].setAttribute('data-spreadsheet', i);\r\n        link[i].innerHTML = result[i].sheetName;\r\n        link[i].onclick = function() {\r\n            for (var j = 0; j < spreadsheet.length; j++) {\r\n                spreadsheet[j].style.display = 'none';\r\n                link[j].classList.remove('selected');\r\n            }\r\n            var i = this.getAttribute('data-spreadsheet');\r\n            spreadsheet[i].style.display = 'block';\r\n            link[i].classList.add('selected')\r\n        }\r\n        tabs.appendChild(link[i]);\r\n    }\r\n\r\n    // Append spreadsheet\r\n    for (var i = 0; i < spreadsheet.length - 1; i++) {\r\n        tabs.appendChild(spreadsheet[i]);\r\n        jexcel(spreadsheet[i], result[i]);\r\n    }\r\n\r\n    // First tab\r\n    spreadsheet[0].style.display = 'block';\r\n    link[0].classList.add('selected')\r\n}\r\n\r\njexcel.fromSpreadsheet = function(file, __callback) {\r\n    var convert = function(workbook) {\r\n        var spreadsheets = [];\r\n        workbook.SheetNames.forEach(function(sheetName) {\r\n            var spreadsheet = {};\r\n            spreadsheet.rows = [];\r\n            spreadsheet.columns = [];\r\n            spreadsheet.data = [];\r\n            spreadsheet.style = {};\r\n            spreadsheet.sheetName = sheetName;\r\n\r\n            // Column widths\r\n            var temp = workbook.Sheets[sheetName]['!cols'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    spreadsheet.columns[i] = {};\r\n                    if (temp[i] && temp[i].wpx) {\r\n                        spreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Rows heights\r\n            var temp = workbook.Sheets[sheetName]['!rows'];\r\n            if (temp && temp.length) {\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] && temp[i].hpx) {\r\n                        spreadsheet.rows[i] = {};\r\n                        spreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n                    }\r\n                }\r\n            }\r\n            // Merge cells\r\n            var temp = workbook.Sheets[sheetName]['!merges'];\r\n            if (temp && temp.length > 0) {\r\n                spreadsheet.mergeCells = [];\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    var x1 = temp[i].s.c;\r\n                    var y1 = temp[i].s.r;\r\n                    var x2 = temp[i].e.c;\r\n                    var y2 = temp[i].e.r;\r\n                    var key = jexcel.getColumnNameFromId([x1,y1]);\r\n                    spreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n                }\r\n            }\r\n            // Data container\r\n            var max_x = 0;\r\n            var max_y = 0;\r\n            var temp = Object.keys(workbook.Sheets[sheetName]);\r\n            for (var i = 0; i < temp.length; i++) {\r\n                if (temp[i].substr(0,1) != '!') {\r\n                    var cell = workbook.Sheets[sheetName][temp[i]];\r\n                    var info = jexcel.getIdFromColumnName(temp[i], true);\r\n                    if (! spreadsheet.data[info[1]]) {\r\n                        spreadsheet.data[info[1]] = [];\r\n                    }\r\n                    spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n                    if (max_x < info[0]) {\r\n                        max_x = info[0];\r\n                    }\r\n                    if (max_y < info[1]) {\r\n                        max_y = info[1];\r\n                    }\r\n                    // Style\r\n                    if (cell.style && Object.keys(cell.style).length > 0) {\r\n                        spreadsheet.style[temp[i]] = cell.style;\r\n                    }\r\n                    if (cell.s && cell.s.fgColor) {\r\n                        if (spreadsheet.style[temp[i]]) {\r\n                            spreadsheet.style[temp[i]] += ';';\r\n                        }\r\n                        spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n                    }\r\n                }\r\n            }\r\n            var numColumns = spreadsheet.columns;\r\n            for (var j = 0; j <= max_y; j++) {\r\n                for (var i = 0; i <= max_x; i++) {\r\n                    if (! spreadsheet.data[j]) {\r\n                        spreadsheet.data[j] = [];\r\n                    }\r\n                    if (! spreadsheet.data[j][i]) {\r\n                        if (numColumns < i) {\r\n                            spreadsheet.data[j][i] = '';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            spreadsheets.push(spreadsheet);\r\n        });\r\n\r\n        return spreadsheets;\r\n    }\r\n\r\n    var oReq;\r\n    oReq = new XMLHttpRequest();\r\n    oReq.open(\"GET\", file, true);\r\n\r\n    if(typeof Uint8Array !== 'undefined') {\r\n        oReq.responseType = \"arraybuffer\";\r\n        oReq.onload = function(e) {\r\n            var arraybuffer = oReq.response;\r\n            var data = new Uint8Array(arraybuffer);\r\n            var wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        };\r\n    } else {\r\n        oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");  \r\n        oReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n            var ff = convertResponseBodyToText(oReq.responseBody);\r\n            var wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n            __callback(convert(wb))\r\n        }};\r\n    }\r\n\r\n    oReq.send();\r\n}\r\n\r\n/**\r\n * Valid international letter\r\n */\r\n\r\njexcel.validLetter = function (text) {\r\n    var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n    return text.match(regex) ? 1 : 0;\r\n}\r\n\r\n/**\r\n * Helper injectArray\r\n */\r\njexcel.injectArray = function(o, idx, arr) {\r\n    return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n}\r\n\r\n/**\r\n * Get letter based on a number\r\n * \r\n * @param integer i\r\n * @return string letter\r\n */\r\njexcel.getColumnName = function(i) {\r\n    var letter = '';\r\n    if (i > 701) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 676));\r\n        letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n    } else if (i > 25) {\r\n        letter += String.fromCharCode(64 + parseInt(i / 26));\r\n    }\r\n    letter += String.fromCharCode(65 + (i % 26));\r\n\r\n    return letter;\r\n}\r\n\r\n/**\r\n * Convert excel like column to jexcel id\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getIdFromColumnName = function (id, arr) {\r\n    // Get the letters\r\n    var t = /^[a-zA-Z]+/.exec(id);\r\n\r\n    if (t) {\r\n        // Base 26 calculation\r\n        var code = 0;\r\n        for (var i = 0; i < t[0].length; i++) {\r\n            code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n        }\r\n        code--;\r\n        // Make sure jexcel starts on zero\r\n        if (code < 0) {\r\n            code = 0;\r\n        }\r\n\r\n        // Number\r\n        var number = parseInt(/[0-9]+$/.exec(id));\r\n        if (number > 0) {\r\n            number--;\r\n        }\r\n\r\n        if (arr == true) {\r\n            id = [ code, number ];\r\n        } else {\r\n            id = code + '-' + number;\r\n        }\r\n    }\r\n\r\n    return id;\r\n}\r\n\r\n/**\r\n * Convert jexcel id to excel like column name\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getColumnNameFromId = function (cellId) {\r\n    if (! Array.isArray(cellId)) {\r\n        cellId = cellId.split('-');\r\n    }\r\n\r\n    return jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n}\r\n\r\n/**\r\n * Verify element inside jexcel table\r\n * \r\n * @param string id\r\n * @return string id\r\n */\r\njexcel.getElement = function(element) {\r\n    var jexcelSection = 0;\r\n    var jexcelElement = 0;\r\n\r\n    function path (element) {\r\n        if (element.className) {\r\n            if (element.classList.contains('jexcel_container')) {\r\n                jexcelElement = element;\r\n            }\r\n        }\r\n\r\n        if (element.tagName == 'THEAD') {\r\n            jexcelSection = 1;\r\n        } else if (element.tagName == 'TBODY') {\r\n            jexcelSection = 2;\r\n        }\r\n\r\n        if (element.parentNode) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return [ jexcelElement, jexcelSection ];\r\n}\r\n\r\njexcel.doubleDigitFormat = function(v) {\r\n    v = ''+v;\r\n    if (v.length == 1) {\r\n        v = '0'+v;\r\n    }\r\n    return v;\r\n}\r\n\r\n/**\r\n * Jquery Support\r\n */\r\nif (typeof(jQuery) != 'undefined') {\r\n    (function($){\r\n        $.fn.jexcel = function(method) {\r\n            var spreadsheetContainer = $(this).get(0);\r\n            if (! spreadsheetContainer.jexcel) {\r\n                return jexcel($(this).get(0), arguments[0]);\r\n            } else {\r\n                return spreadsheetContainer.jexcel[method].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n            }\r\n        };\r\n\r\n    })(jQuery);\r\n}\r\n\r\n\r\n// Based on sutoiku work (https://github.com/sutoiku)\r\n\r\nvar error = (function() {\r\n    var exports = {};\r\n\r\n    exports.nil = new Error('#NULL!');\r\n    exports.div0 = new Error('#DIV/0!');\r\n    exports.value = new Error('#VALUE!');\r\n    exports.ref = new Error('#REF!');\r\n    exports.name = new Error('#NAME?');\r\n    exports.num = new Error('#NUM!');\r\n    exports.na = new Error('#N/A');\r\n    exports.error = new Error('#ERROR!');\r\n    exports.data = new Error('#GETTING_DATA');\r\n\r\n    return exports;\r\n})();\r\n\r\nvar utils = (function() {\r\n    var exports = {};\r\n\r\n    exports.flattenShallow = function(array) {\r\n        if (!array || !array.reduce) {\r\n            return array;\r\n        }\r\n\r\n        return array.reduce(function(a, b) {\r\n            var aIsArray = Array.isArray(a);\r\n            var bIsArray = Array.isArray(b);\r\n\r\n            if (aIsArray && bIsArray) {\r\n                return a.concat(b);\r\n            }\r\n            if (aIsArray) {\r\n                a.push(b);\r\n\r\n                return a;\r\n            }\r\n            if (bIsArray) {\r\n                return [ a ].concat(b);\r\n            }\r\n\r\n            return [ a, b ];\r\n        });\r\n    };\r\n\r\n    exports.isFlat = function(array) {\r\n        if (!array) {\r\n            return false;\r\n        }\r\n\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (Array.isArray(array[i])) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    exports.flatten = function() {\r\n        var result = exports.argsToArray.apply(null, arguments);\r\n\r\n        while (!exports.isFlat(result)) {\r\n            result = exports.flattenShallow(result);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.argsToArray = function(args) {\r\n        var result = [];\r\n\r\n        exports.arrayEach(args, function(value) {\r\n            result.push(value);\r\n        });\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.numbers = function() {\r\n        var possibleNumbers = this.flatten.apply(null, arguments);\r\n        return possibleNumbers.filter(function(el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.cleanFloat = function(number) {\r\n        var power = 1e14;\r\n        return Math.round(number * power) / power;\r\n    };\r\n\r\n    exports.parseBool = function(bool) {\r\n        if (typeof bool === 'boolean') {\r\n            return bool;\r\n        }\r\n\r\n        if (bool instanceof Error) {\r\n            return bool;\r\n        }\r\n\r\n        if (typeof bool === 'number') {\r\n            return bool !== 0;\r\n        }\r\n\r\n        if (typeof bool === 'string') {\r\n            var up = bool.toUpperCase();\r\n            if (up === 'TRUE') {\r\n                return true;\r\n            }\r\n\r\n            if (up === 'FALSE') {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (bool instanceof Date && !isNaN(bool)) {\r\n            return true;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumber = function(string) {\r\n        if (string === undefined || string === '') {\r\n            return error.value;\r\n        }\r\n        if (!isNaN(string)) {\r\n            return parseFloat(string);\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseNumberArray = function(arr) {\r\n        var len;\r\n\r\n        if (!arr || (len = arr.length) === 0) {\r\n            return error.value;\r\n        }\r\n\r\n        var parsed;\r\n\r\n        while (len--) {\r\n            parsed = exports.parseNumber(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n\r\n        return arr;\r\n    };\r\n\r\n    exports.parseMatrix = function(matrix) {\r\n        var n;\r\n\r\n        if (!matrix || (n = matrix.length) === 0) {\r\n            return error.value;\r\n        }\r\n        var pnarr;\r\n\r\n        for (var i = 0; i < matrix.length; i++) {\r\n            pnarr = exports.parseNumberArray(matrix[i]);\r\n            matrix[i] = pnarr;\r\n\r\n            if (pnarr instanceof Error) {\r\n                return pnarr;\r\n            }\r\n        }\r\n\r\n        return matrix;\r\n    };\r\n\r\n    var d1900 = new Date(Date.UTC(1900, 0, 1));\r\n    exports.parseDate = function(date) {\r\n        if (!isNaN(date)) {\r\n            if (date instanceof Date) {\r\n                return new Date(date);\r\n            }\r\n            var d = parseInt(date, 10);\r\n            if (d < 0) {\r\n                return error.num;\r\n            }\r\n            if (d <= 60) {\r\n                return new Date(d1900.getTime() + (d - 1) * 86400000);\r\n            }\r\n            return new Date(d1900.getTime() + (d - 2) * 86400000);\r\n        }\r\n        if (typeof date === 'string') {\r\n            date = new Date(date);\r\n            if (!isNaN(date)) {\r\n                return date;\r\n            }\r\n        }\r\n        return error.value;\r\n    };\r\n\r\n    exports.parseDateArray = function(arr) {\r\n        var len = arr.length;\r\n        var parsed;\r\n        while (len--) {\r\n            parsed = this.parseDate(arr[len]);\r\n            if (parsed === error.value) {\r\n                return parsed;\r\n            }\r\n            arr[len] = parsed;\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.anyIsError = function() {\r\n        var n = arguments.length;\r\n        while (n--) {\r\n            if (arguments[n] instanceof Error) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    exports.arrayValuesToNumbers = function(arr) {\r\n        var n = arr.length;\r\n        var el;\r\n        while (n--) {\r\n            el = arr[n];\r\n            if (typeof el === 'number') {\r\n                continue;\r\n            }\r\n            if (el === true) {\r\n                arr[n] = 1;\r\n                continue;\r\n            }\r\n            if (el === false) {\r\n                arr[n] = 0;\r\n                continue;\r\n            }\r\n            if (typeof el === 'string') {\r\n                var number = this.parseNumber(el);\r\n                if (number instanceof Error) {\r\n                    arr[n] = 0;\r\n                } else {\r\n                    arr[n] = number;\r\n                }\r\n            }\r\n        }\r\n        return arr;\r\n    };\r\n\r\n    exports.rest = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(idx);\r\n    };\r\n\r\n    exports.initial = function(array, idx) {\r\n        idx = idx || 1;\r\n        if (!array || typeof array.slice !== 'function') {\r\n            return array;\r\n        }\r\n        return array.slice(0, array.length - idx);\r\n    };\r\n\r\n    exports.arrayEach = function(array, iteratee) {\r\n        var index = -1, length = array.length;\r\n\r\n        while (++index < length) {\r\n            if (iteratee(array[index], index, array) === false) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return array;\r\n    };\r\n\r\n    exports.transpose = function(matrix) {\r\n        if (!matrix) {\r\n            return error.value;\r\n        }\r\n\r\n        return matrix[0].map(function(col, i) {\r\n            return matrix.map(function(row) {\r\n                return row[i];\r\n            });\r\n        });\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods = {};\r\n\r\njexcel.methods.datetime = (function() {\r\n    var exports = {};\r\n\r\n    var d1900 = new Date(1900, 0, 1);\r\n    var WEEK_STARTS = [\r\n        undefined,\r\n        0,\r\n        1,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        1,\r\n        2,\r\n        3,\r\n        4,\r\n        5,\r\n        6,\r\n        0\r\n    ];\r\n    var WEEK_TYPES = [\r\n        [],\r\n        [1, 2, 3, 4, 5, 6, 7],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 0, 1, 2, 3, 4, 5],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [],\r\n        [7, 1, 2, 3, 4, 5, 6],\r\n        [6, 7, 1, 2, 3, 4, 5],\r\n        [5, 6, 7, 1, 2, 3, 4],\r\n        [4, 5, 6, 7, 1, 2, 3],\r\n        [3, 4, 5, 6, 7, 1, 2],\r\n        [2, 3, 4, 5, 6, 7, 1],\r\n        [1, 2, 3, 4, 5, 6, 7]\r\n    ];\r\n    var WEEKEND_TYPES = [\r\n        [],\r\n        [6, 0],\r\n        [0, 1],\r\n        [1, 2],\r\n        [2, 3],\r\n        [3, 4],\r\n        [4, 5],\r\n        [5, 6],\r\n        undefined,\r\n        undefined,\r\n        undefined, [0, 0],\r\n        [1, 1],\r\n        [2, 2],\r\n        [3, 3],\r\n        [4, 4],\r\n        [5, 5],\r\n        [6, 6]\r\n    ];\r\n\r\n    exports.DATE = function(year, month, day) {\r\n        year = utils.parseNumber(year);\r\n        month = utils.parseNumber(month);\r\n        day = utils.parseNumber(day);\r\n        if (utils.anyIsError(year, month, day)) {\r\n            return error.value;\r\n        }\r\n        if (year < 0 || month < 0 || day < 0) {\r\n            return error.num;\r\n        }\r\n        var date = new Date(year, month - 1, day);\r\n        return date;\r\n    };\r\n\r\n    exports.DATEVALUE = function(date_text) {\r\n        if (typeof date_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        var date = Date.parse(date_text);\r\n        if (isNaN(date)) {\r\n            return error.value;\r\n        }\r\n        if (date <= -2203891200000) {\r\n            return (date - d1900) / 86400000 + 1;\r\n        }\r\n        return (date - d1900) / 86400000 + 2;\r\n    };\r\n\r\n    exports.DAY = function(serial_number) {\r\n        var date = utils.parseDate(serial_number);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n        return date.getDate();\r\n    };\r\n\r\n    exports.DAYS = function(end_date, start_date) {\r\n        end_date = utils.parseDate(end_date);\r\n        start_date = utils.parseDate(start_date);\r\n        if (end_date instanceof Error) {\r\n            return end_date;\r\n        }\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        return serial(end_date) - serial(start_date);\r\n    };\r\n\r\n    exports.DAYS360 = function(start_date, end_date, method) {\r\n    };\r\n\r\n    exports.EDATE = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        start_date.setMonth(start_date.getMonth() + months);\r\n        return serial(start_date);\r\n    };\r\n\r\n    exports.EOMONTH = function(start_date, months) {\r\n        start_date = utils.parseDate(start_date);\r\n        if (start_date instanceof Error) {\r\n            return start_date;\r\n        }\r\n        if (isNaN(months)) {\r\n            return error.value;\r\n        }\r\n        months = parseInt(months, 10);\r\n        return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\r\n    };\r\n\r\n    exports.HOUR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getHours();\r\n    };\r\n\r\n    exports.INTERVAL = function(second) {\r\n        if (typeof second !== 'number' && typeof second !== 'string') {\r\n            return error.value;\r\n        } else {\r\n            second = parseInt(second, 10);\r\n        }\r\n\r\n        var year  = Math.floor(second/946080000);\r\n        second    = second%946080000;\r\n        var month = Math.floor(second/2592000);\r\n        second    = second%2592000;\r\n        var day   = Math.floor(second/86400);\r\n        second    = second%86400;\r\n\r\n        var hour  = Math.floor(second/3600);\r\n        second    = second%3600;\r\n        var min   = Math.floor(second/60);\r\n        second    = second%60;\r\n        var sec   = second;\r\n\r\n        year  = (year  > 0) ? year  + 'Y' : '';\r\n        month = (month > 0) ? month + 'M' : '';\r\n        day   = (day   > 0) ? day   + 'D' : '';\r\n        hour  = (hour  > 0) ? hour  + 'H' : '';\r\n        min   = (min   > 0) ? min   + 'M' : '';\r\n        sec   = (sec   > 0) ? sec   + 'S' : '';\r\n\r\n        return 'P' + year + month + day + 'T' + hour + min + sec;\r\n    };\r\n\r\n    exports.ISOWEEKNUM = function(date) {\r\n        date = utils.parseDate(date);\r\n        if (date instanceof Error) {\r\n            return date;\r\n        }\r\n\r\n        date.setHours(0, 0, 0);\r\n        date.setDate(date.getDate() + 4 - (date.getDay() || 7));\r\n        var yearStart = new Date(date.getFullYear(), 0, 1);\r\n        return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\r\n    };\r\n\r\n    exports.MINUTE = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMinutes();\r\n    };\r\n\r\n    exports.MONTH = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getMonth() + 1;\r\n    };\r\n\r\n    exports.NETWORKDAYS = function(start_date, end_date, holidays) {\r\n    };\r\n\r\n    exports.NETWORKDAYS.INTL = function(start_date, end_date, weekend, holidays) {\r\n    };\r\n\r\n    exports.NOW = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.SECOND = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getSeconds();\r\n    };\r\n\r\n    exports.TIME = function(hour, minute, second) {\r\n        hour = utils.parseNumber(hour);\r\n        minute = utils.parseNumber(minute);\r\n        second = utils.parseNumber(second);\r\n        if (utils.anyIsError(hour, minute, second)) {\r\n            return error.value;\r\n        }\r\n        if (hour < 0 || minute < 0 || second < 0) {\r\n            return error.num;\r\n        }\r\n        return (3600 * hour + 60 * minute + second) / 86400;\r\n    };\r\n\r\n    exports.TIMEVALUE = function(time_text) {\r\n        time_text = utils.parseDate(time_text);\r\n        if (time_text instanceof Error) {\r\n            return time_text;\r\n        }\r\n        return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\r\n    };\r\n\r\n    exports.TODAY = function() {\r\n        return new Date();\r\n    };\r\n\r\n    exports.WEEKDAY = function(serial_number, return_type) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        if (return_type === undefined) {\r\n            return_type = 1;\r\n        }\r\n        var day = serial_number.getDay();\r\n        return WEEK_TYPES[return_type][day];\r\n    };\r\n\r\n    exports.WEEKNUM = function(serial_number, return_type) {\r\n    };\r\n\r\n    exports.WORKDAY = function(start_date, days, holidays) {\r\n    };\r\n\r\n    exports.WORKDAY.INTL = function(start_date, days, weekend, holidays) {\r\n    };\r\n\r\n    exports.YEAR = function(serial_number) {\r\n        serial_number = utils.parseDate(serial_number);\r\n        if (serial_number instanceof Error) {\r\n            return serial_number;\r\n        }\r\n        return serial_number.getFullYear();\r\n    };\r\n\r\n    function isLeapYear(year) {\r\n        return new Date(year, 1, 29).getMonth() === 1;\r\n    }\r\n\r\n    exports.YEARFRAC = function(start_date, end_date, basis) {\r\n    };\r\n\r\n    function serial(date) {\r\n        var addOn = (date > -2203891200000)?2:1;\r\n        return (date - d1900) / 86400000 + addOn;\r\n    }\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.database = (function() {\r\n    var exports = {};\r\n\r\n    function compact(array) {\r\n        if (!array) {\r\n            return array;\r\n        }\r\n        var result = [];\r\n        for (var i = 0; i < array.length; ++i) {\r\n            if (!array[i]) {\r\n                continue;\r\n            }\r\n            result.push(array[i]);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    exports.FINDFIELD = function(database, title) {\r\n        var index = null;\r\n        for (var i = 0; i < database.length; i++) {\r\n            if (database[i][0] === title) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Return error if the input field title is incorrect\r\n        if (index == null) {\r\n            return error.value;\r\n        }\r\n        return index;\r\n    };\r\n\r\n    function findResultIndex(database, criterias) {\r\n        var matches = {};\r\n        for (var i = 1; i < database[0].length; ++i) {\r\n            matches[i] = true;\r\n        }\r\n        var maxCriteriaLength = criterias[0].length;\r\n        for (i = 1; i < criterias.length; ++i) {\r\n            if (criterias[i].length > maxCriteriaLength) {\r\n                maxCriteriaLength = criterias[i].length;\r\n            }\r\n        }\r\n\r\n        for (var k = 1; k < database.length; ++k) {\r\n            for (var l = 1; l < database[k].length; ++l) {\r\n                var currentCriteriaResult = false;\r\n                var hasMatchingCriteria = false;\r\n                for (var j = 0; j < criterias.length; ++j) {\r\n                    var criteria = criterias[j];\r\n                    if (criteria.length < maxCriteriaLength) {\r\n                        continue;\r\n                    }\r\n\r\n                    var criteriaField = criteria[0];\r\n                    if (database[k][0] !== criteriaField) {\r\n                        continue;\r\n                    }\r\n                    hasMatchingCriteria = true;\r\n                    for (var p = 1; p < criteria.length; ++p) {\r\n                        currentCriteriaResult = currentCriteriaResult\r\n                                || eval(database[k][l] + criteria[p]); // jshint\r\n                                                                        // ignore:line\r\n                    }\r\n                }\r\n                if (hasMatchingCriteria) {\r\n                    matches[l] = matches[l] && currentCriteriaResult;\r\n                }\r\n            }\r\n        }\r\n\r\n        var result = [];\r\n        for (var n = 0; n < database[0].length; ++n) {\r\n            if (matches[n]) {\r\n                result.push(n - 1);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Database functions\r\n    exports.DAVERAGE = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var sum = 0;\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            sum += targetFields[resultIndexes[i]];\r\n        }\r\n        return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\r\n    };\r\n\r\n    exports.DCOUNT = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DCOUNTA = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DGET = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        // Return error if no record meets the criteria\r\n        if (resultIndexes.length === 0) {\r\n            return error.value;\r\n        }\r\n        // Returns the #NUM! error value because more than one record meets the\r\n        // criteria\r\n        if (resultIndexes.length > 1) {\r\n            return error.num;\r\n        }\r\n\r\n        return targetFields[resultIndexes[0]];\r\n    };\r\n\r\n    exports.DMAX = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var maxValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (maxValue < targetFields[resultIndexes[i]]) {\r\n                maxValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return maxValue;\r\n    };\r\n\r\n    exports.DMIN = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var minValue = targetFields[resultIndexes[0]];\r\n        for (var i = 1; i < resultIndexes.length; i++) {\r\n            if (minValue > targetFields[resultIndexes[i]]) {\r\n                minValue = targetFields[resultIndexes[i]];\r\n            }\r\n        }\r\n        return minValue;\r\n    };\r\n\r\n    exports.DPRODUCT = function(database, field, criteria) {\r\n        // Return error if field is not a number and not a string\r\n        if (isNaN(field) && (typeof field !== \"string\")) {\r\n            return error.value;\r\n        }\r\n        var resultIndexes = findResultIndex(database, criteria);\r\n        var targetFields = [];\r\n        if (typeof field === \"string\") {\r\n            var index = exports.FINDFIELD(database, field);\r\n            targetFields = utils.rest(database[index]);\r\n        } else {\r\n            targetFields = utils.rest(database[field]);\r\n        }\r\n        var targetValues = [];\r\n        for (var i = 0; i < resultIndexes.length; i++) {\r\n            targetValues[i] = targetFields[resultIndexes[i]];\r\n        }\r\n        targetValues = compact(targetValues);\r\n        var result = 1;\r\n        for (i = 0; i < targetValues.length; i++) {\r\n            result *= targetValues[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.DSTDEV = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSTDEVP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DSUM = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVAR = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.DVARP = function(database, field, criteria) {\r\n    };\r\n\r\n    exports.MATCH = function(lookupValue, lookupArray, matchType) {\r\n        if (!lookupValue && !lookupArray) {\r\n            return error.na;\r\n        }\r\n        if (arguments.length === 2) {\r\n            matchType = 1;\r\n        }\r\n        if (!(lookupArray instanceof Array)) {\r\n            return error.na;\r\n        }\r\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\r\n            return error.na;\r\n        }\r\n\r\n        var index;\r\n        var indexValue;\r\n\r\n        for (var idx = 0; idx < lookupArray.length; idx++) {\r\n            if (matchType === 1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] < lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] > indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            } else if (matchType === 0) {\r\n                if (typeof lookupValue === 'string') {\r\n                    lookupValue = lookupValue.replace(/\\?/g, '.');\r\n                    if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\r\n                        return idx + 1;\r\n                    }\r\n                } else {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    }\r\n                }\r\n            } else if (matchType === -1) {\r\n                if (lookupArray[idx] === lookupValue) {\r\n                    return idx + 1;\r\n                } else if (lookupArray[idx] > lookupValue) {\r\n                    if (!indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    } else if (lookupArray[idx] < indexValue) {\r\n                        index = idx + 1;\r\n                        indexValue = lookupArray[idx];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return index ? index : error.na;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.engineering = (function() {\r\n    var exports = {};\r\n\r\n    function isValidBinaryNumber(number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    }\r\n\r\n    exports.BESSELI = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELJ = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELK = function(x, n) {\r\n    };\r\n\r\n    exports.BESSELY = function(x, n) {\r\n    };\r\n\r\n    exports.BIN2DEC = function(number) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert binary number to decimal\r\n        var result = parseInt(number, 2);\r\n\r\n        // Handle negative numbers\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return parseInt(stringified.substring(1), 2) - 512;\r\n        } else {\r\n            return result;\r\n        }\r\n    };\r\n\r\n    exports.BIN2HEX = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\r\n        }\r\n\r\n        // Convert binary number to hexadecimal\r\n        var result = parseInt(number, 2).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BIN2OCT = function(number, places) {\r\n        // Return error if number is not binary or contains more than 10\r\n        // characters (10 digits)\r\n        if (!isValidBinaryNumber(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        var stringified = number.toString();\r\n        if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n            return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\r\n        }\r\n\r\n        // Convert binary number to octal\r\n        var result = parseInt(number, 2).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.BITAND = function(number1, number2) {\r\n        // Return error if either number is a non-numeric value\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise AND of two numbers\r\n        return number1 & number2;\r\n    };\r\n\r\n    exports.BITLSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the left or to the right if\r\n        // shift is negative\r\n        return (shift >= 0) ? number << shift : number >> -shift;\r\n    };\r\n\r\n    exports.BITOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise OR of two numbers\r\n        return number1 | number2;\r\n    };\r\n\r\n    exports.BITRSHIFT = function(number, shift) {\r\n        number = utils.parseNumber(number);\r\n        shift = utils.parseNumber(shift);\r\n        if (utils.anyIsError(number, shift)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if number is less than 0\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is a non-integer\r\n        if (Math.floor(number) !== number) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if number is greater than (2^48)-1\r\n        if (number > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if the absolute value of shift is greater than 53\r\n        if (Math.abs(shift) > 53) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number shifted by shift bits to the right or to the left if\r\n        // shift is negative\r\n        return (shift >= 0) ? number >> shift : number << -shift;\r\n    };\r\n\r\n    exports.BITXOR = function(number1, number2) {\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either number is less than 0\r\n        if (number1 < 0 || number2 < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is a non-integer\r\n        if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if either number is greater than (2^48)-1\r\n        if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bitwise XOR of two numbers\r\n        return number1 ^ number2;\r\n    };\r\n\r\n    exports.COMPLEX = function(real, imaginary, suffix) {\r\n        real = utils.parseNumber(real);\r\n        imaginary = utils.parseNumber(imaginary);\r\n        if (utils.anyIsError(real, imaginary)) {\r\n            return real;\r\n        }\r\n\r\n        // Set suffix\r\n        suffix = (suffix === undefined) ? 'i' : suffix;\r\n\r\n        // Return error if suffix is neither \"i\" nor \"j\"\r\n        if (suffix !== 'i' && suffix !== 'j') {\r\n            return error.value;\r\n        }\r\n\r\n        // Return complex number\r\n        if (real === 0 && imaginary === 0) {\r\n            return 0;\r\n        } else if (real === 0) {\r\n            return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\r\n        } else if (imaginary === 0) {\r\n            return real.toString();\r\n        } else {\r\n            var sign = (imaginary > 0) ? '+' : '';\r\n            return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\r\n        }\r\n    };\r\n\r\n    exports.CONVERT = function(number, from_unit, to_unit) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // List of units supported by CONVERT and units defined by the\r\n        // International System of Units\r\n        // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\r\n        // ratio]\r\n        var units = [\r\n            [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\r\n            [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\r\n            [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\r\n            [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\r\n            [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\r\n            [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\r\n            [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\r\n            [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\r\n            [\"are\", \"ar\", null, \"area\", false, true, 100],\r\n            [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\r\n            [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\r\n            [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\r\n            [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\r\n            [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\r\n            [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\r\n            [\"byte\", \"byte\", null, \"information\", false, true, 8],\r\n            [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\r\n            [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\r\n            [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\r\n            [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\r\n            [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\r\n            [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\r\n            [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\r\n            [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\r\n            [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\r\n            [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\r\n            [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\r\n            [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\r\n            [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\r\n            [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\r\n            [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\r\n            [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\r\n            [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\r\n            [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\r\n            [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\r\n            [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\r\n            [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\r\n            [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\r\n            [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\r\n            [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\r\n            [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\r\n            [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\r\n            [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\r\n            [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\r\n            [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\r\n            [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\r\n            [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\r\n            [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\r\n            [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\r\n            [\"henry\", \"H\", null, \"inductance\", true, false, 1],\r\n            [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\r\n            [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\r\n            [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\r\n            [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\r\n            [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\r\n            [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\r\n            [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\r\n            [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\r\n            [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\r\n            [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\r\n            [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\r\n            [\"joule\", \"J\", null, \"energy\", true, true, 1],\r\n            [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\r\n            [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\r\n            [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\r\n            [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\r\n            [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\r\n            [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\r\n            [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\r\n            [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\r\n            [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\r\n            [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\r\n            [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\r\n            [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\r\n            [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\r\n            [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\r\n            [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\r\n            [\"metre\", \"m\", null, \"length\", true, true, 1],\r\n            [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\r\n            [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\r\n            [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\r\n            [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\r\n            [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\r\n            [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\r\n            [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\r\n            [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n            [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n            [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\r\n            [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\r\n            [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852],\r\n            [\"newton\", \"N\", null, \"force\", true, true, 1],\r\n            [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\r\n            [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\r\n            [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\r\n            [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\r\n            [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\r\n            [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\r\n            [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\r\n            [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\r\n            [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\r\n            [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\r\n            [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\r\n            [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\r\n            [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\r\n            [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\r\n            [\"radian\", \"rad\", null, \"angle\", true, false, 1],\r\n            [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\r\n            [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\r\n            [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\r\n            [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\r\n            [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\r\n            [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\r\n            [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\r\n            [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\r\n            [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\r\n            [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\r\n            [\"square meter\", \"m?\", null, \"area\", true, true, 1],\r\n            [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\r\n            [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\r\n            [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\r\n            [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\r\n            [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\r\n            [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\r\n            [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\r\n            [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\r\n            [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\r\n            [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\r\n            [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\r\n            [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\r\n            [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\r\n            [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\r\n            [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\r\n            [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\r\n            [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\r\n            [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\r\n            [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\r\n            [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\r\n            [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\r\n            [\"volt\", \"V\", null, \"voltage\", true, false, 1],\r\n            [\"watt\", \"W\", null, \"power\", true, true, 1],\r\n            [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\r\n            [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\r\n            [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\r\n            [\"year\", \"yr\", null, \"time\", false, true, 31557600]\r\n        ];\r\n\r\n        // Binary prefixes\r\n        // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\r\n        // from]\r\n        var binary_prefixes = {\r\n            Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\r\n            Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\r\n            Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\r\n            Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\r\n            Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\r\n            Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\r\n            Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\r\n            ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\r\n        };\r\n\r\n        // Unit prefixes\r\n        // [Name, Multiplier, Abbreviation]\r\n        var unit_prefixes = {\r\n            Y: [\"yotta\", 1e+24, \"Y\"],\r\n            Z: [\"zetta\", 1e+21, \"Z\"],\r\n            E: [\"exa\", 1e+18, \"E\"],\r\n            P: [\"peta\", 1e+15, \"P\"],\r\n            T: [\"tera\", 1e+12, \"T\"],\r\n            G: [\"giga\", 1e+09, \"G\"],\r\n            M: [\"mega\", 1e+06, \"M\"],\r\n            k: [\"kilo\", 1e+03, \"k\"],\r\n            h: [\"hecto\", 1e+02, \"h\"],\r\n            e: [\"dekao\", 1e+01, \"e\"],\r\n            d: [\"deci\", 1e-01, \"d\"],\r\n            c: [\"centi\", 1e-02, \"c\"],\r\n            m: [\"milli\", 1e-03, \"m\"],\r\n            u: [\"micro\", 1e-06, \"u\"],\r\n            n: [\"nano\", 1e-09, \"n\"],\r\n            p: [\"pico\", 1e-12, \"p\"],\r\n            f: [\"femto\", 1e-15, \"f\"],\r\n            a: [\"atto\", 1e-18, \"a\"],\r\n            z: [\"zepto\", 1e-21, \"z\"],\r\n            y: [\"yocto\", 1e-24, \"y\"]\r\n        };\r\n\r\n        // Initialize units and multipliers\r\n        var from = null;\r\n        var to = null;\r\n        var base_from_unit = from_unit;\r\n        var base_to_unit = to_unit;\r\n        var from_multiplier = 1;\r\n        var to_multiplier = 1;\r\n        var alt;\r\n\r\n        // Lookup from and to units\r\n        for (var i = 0; i < units.length; i++) {\r\n            alt = (units[i][2] === null) ? [] : units[i][2];\r\n            if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n              from = units[i];\r\n            }\r\n            if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n              to = units[i];\r\n            }\r\n        }\r\n\r\n        // Lookup from prefix\r\n        if (from === null) {\r\n            var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\r\n            var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (from_unit.substring(0, 2) === 'da') {\r\n              from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (from_binary_prefix) {\r\n              from_multiplier = from_binary_prefix[2];\r\n              base_from_unit = from_unit.substring(2);\r\n            } else if (from_unit_prefix) {\r\n              from_multiplier = from_unit_prefix[1];\r\n              base_from_unit = from_unit.substring(from_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup from unit\r\n            for (var j = 0; j < units.length; j++) {\r\n              alt = (units[j][2] === null) ? [] : units[j][2];\r\n              if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                  from = units[j];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Lookup to prefix\r\n        if (to === null) {\r\n            var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\r\n            var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\r\n\r\n            // Handle dekao unit prefix (only unit prefix with two characters)\r\n            if (to_unit.substring(0, 2) === 'da') {\r\n              to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n            }\r\n\r\n            // Handle binary prefixes first (so that 'Yi' is processed before\r\n            // 'Y')\r\n            if (to_binary_prefix) {\r\n              to_multiplier = to_binary_prefix[2];\r\n              base_to_unit = to_unit.substring(2);\r\n            } else if (to_unit_prefix) {\r\n              to_multiplier = to_unit_prefix[1];\r\n              base_to_unit = to_unit.substring(to_unit_prefix[2].length);\r\n            }\r\n\r\n            // Lookup to unit\r\n            for (var k = 0; k < units.length; k++) {\r\n              alt = (units[k][2] === null) ? [] : units[k][2];\r\n              if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                  to = units[k];\r\n              }\r\n            }\r\n        }\r\n\r\n        // Return error if a unit does not exist\r\n        if (from === null || to === null) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return error if units represent different quantities\r\n        if (from[3] !== to[3]) {\r\n            return error.na;\r\n        }\r\n\r\n        // Return converted number\r\n        return number * from[6] * from_multiplier / (to[6] * to_multiplier);\r\n    };\r\n\r\n    exports.DEC2BIN = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -512, or is\r\n        // greater than 511\r\n        if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = parseInt(number, 10).toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2HEX = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character hexadecimal number if number\r\n        // is negative\r\n        if (number < 0) {\r\n            return (1099511627776 + number).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = parseInt(number, 10).toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DEC2OCT = function(number, places) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n\r\n        // Return error if number is not decimal, is lower than -549755813888,\r\n        // or is greater than 549755813887\r\n        if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (number < 0) {\r\n            return (1073741824 + number).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = parseInt(number, 10).toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.DELTA = function(number1, number2) {\r\n        // Set number2 to zero if undefined\r\n        number2 = (number2 === undefined) ? 0 : number2;\r\n        number1 = utils.parseNumber(number1);\r\n        number2 = utils.parseNumber(number2);\r\n        if (utils.anyIsError(number1, number2)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return delta\r\n        return (number1 === number2) ? 1 : 0;\r\n    };\r\n\r\n    exports.ERF = function(lower_bound, upper_bound) {\r\n    };\r\n\r\n    exports.ERF.PRECISE = function() {\r\n    };\r\n\r\n    exports.ERFC = function(x) {\r\n    };\r\n\r\n    exports.ERFC.PRECISE = function() {\r\n    };\r\n\r\n    exports.GESTEP = function(number, step) {\r\n        step = step || 0;\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(step, number)) {\r\n            return number;\r\n        }\r\n\r\n        // Return delta\r\n        return (number >= step) ? 1 : 0;\r\n    };\r\n\r\n    exports.HEX2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.HEX2DEC = function(number) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\r\n    };\r\n\r\n    exports.HEX2OCT = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert hexadecimal number to decimal\r\n        var decimal = parseInt(number, 16);\r\n\r\n        // Return error if number is positive and greater than 0x1fffffff\r\n        // (536870911)\r\n        if (decimal > 536870911 && decimal < 1098974756864) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 1098974756864) {\r\n            return (decimal - 1098437885952).toString(8);\r\n        }\r\n\r\n        // Convert decimal number to octal\r\n        var result = decimal.toString(8);\r\n\r\n        // Return octal number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.IMABS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return absolute value of complex number\r\n        return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n    };\r\n\r\n    exports.IMAGINARY = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', 'j'].indexOf(inumber) >= 0) {\r\n            return 1;\r\n        }\r\n\r\n        // Normalize imaginary coefficient\r\n        inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return imaginary coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(plus + 1, inumber.length - 1));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  -Number(inumber.substring(minus + 1, inumber.length - 1));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : 0;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMARGUMENT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if inumber is equal to zero\r\n        if (x === 0 && y === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Return PI/2 if x is equal to zero and y is positive\r\n        if (x === 0 && y > 0) {\r\n            return Math.PI / 2;\r\n        }\r\n\r\n        // Return -PI/2 if x is equal to zero and y is negative\r\n        if (x === 0 && y < 0) {\r\n            return -Math.PI / 2;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x > 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Return zero if x is negative and y is equal to zero\r\n        if (y === 0 && x < 0) {\r\n            return -Math.PI;\r\n        }\r\n\r\n        // Return argument of complex number\r\n        if (x > 0) {\r\n            return Math.atan(y / x);\r\n        } else if (x < 0 && y >= 0) {\r\n            return Math.atan(y / x) + Math.PI;\r\n        } else {\r\n            return Math.atan(y / x) - Math.PI;\r\n        }\r\n    };\r\n\r\n    exports.IMCONJUGATE = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return conjugate of complex number\r\n        return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\r\n    };\r\n\r\n    exports.IMCOS = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return cosine of complex number\r\n        return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOSH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using exports.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic cosine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMCOT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return cotangent of complex number\r\n        return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMDIV = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = exports.IMREAL(inumber1);\r\n        var b = exports.IMAGINARY(inumber1);\r\n        var c = exports.IMREAL(inumber2);\r\n        var d = exports.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return error if inumber2 is null\r\n        if (c === 0 && d === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return exponential of complex number\r\n        var den = c * c + d * d;\r\n        return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\r\n    };\r\n\r\n    exports.IMEXP = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        var e = Math.exp(x);\r\n        return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\r\n    };\r\n\r\n    exports.IMLN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\r\n    };\r\n\r\n    exports.IMLOG10 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\r\n    };\r\n\r\n    exports.IMLOG2 = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\r\n    };\r\n\r\n    exports.IMPOWER = function(inumber, number) {\r\n        number = utils.parseNumber(number);\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n        if (utils.anyIsError(number, x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var p = Math.pow(exports.IMABS(inumber), number);\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\r\n    };\r\n\r\n    exports.IMPRODUCT = function() {\r\n        // Initialize result\r\n        var result = arguments[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = exports.IMREAL(result);\r\n            var b = exports.IMAGINARY(result);\r\n            var c = exports.IMREAL(arguments[i]);\r\n            var d = exports.IMAGINARY(arguments[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = exports.COMPLEX(a * c - b * d, a * d + b * c);\r\n        }\r\n\r\n        // Return product of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMREAL = function(inumber) {\r\n        if (inumber === undefined || inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return 0 if inumber is equal to 0\r\n        if (inumber === 0 || inumber === '0') {\r\n            return 0;\r\n        }\r\n\r\n        // Handle special cases\r\n        if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\r\n            return 0;\r\n        }\r\n\r\n        // Lookup sign\r\n        var plus = inumber.indexOf('+');\r\n        var minus = inumber.indexOf('-');\r\n        if (plus === 0) {\r\n            plus = inumber.indexOf('+', 1);\r\n        }\r\n        if (minus === 0) {\r\n            minus = inumber.indexOf('-', 1);\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var last = inumber.substring(inumber.length - 1, inumber.length);\r\n        var unit = (last === 'i' || last === 'j');\r\n\r\n        if (plus >= 0 || minus >= 0) {\r\n            // Return error if imaginary unit is neither i nor j\r\n            if (!unit) {\r\n              return error.num;\r\n            }\r\n\r\n            // Return real coefficient of complex number\r\n            if (plus >= 0) {\r\n              return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, plus));\r\n            } else {\r\n              return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                  error.num :\r\n                  Number(inumber.substring(0, minus));\r\n            }\r\n        } else {\r\n            if (unit) {\r\n              return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\r\n            } else {\r\n              return (isNaN(inumber)) ? error.num : inumber;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.IMSEC = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOS(inumber));\r\n    };\r\n\r\n    exports.IMSECH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return hyperbolic secant of complex number\r\n        return exports.IMDIV('1', exports.IMCOSH(inumber));\r\n    };\r\n\r\n    exports.IMSIN = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return sine of complex number\r\n        return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSINH = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Return hyperbolic sine of complex number\r\n        return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\r\n    };\r\n\r\n    exports.IMSQRT = function(inumber) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit = inumber.substring(inumber.length - 1);\r\n        unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n        // Calculate power of modulus\r\n        var s = Math.sqrt(exports.IMABS(inumber));\r\n\r\n        // Calculate argument\r\n        var t = exports.IMARGUMENT(inumber);\r\n\r\n        // Return exponential of complex number\r\n        return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\r\n    };\r\n\r\n    exports.IMCSC = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSIN(inumber));\r\n    };\r\n\r\n    exports.IMCSCH = function (inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        // Return error if either coefficient is not a number\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return hyperbolic cosecant of complex number\r\n        return exports.IMDIV('1', exports.IMSINH(inumber));\r\n    };\r\n\r\n    exports.IMSUB = function(inumber1, inumber2) {\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var a = this.IMREAL(inumber1);\r\n        var b = this.IMAGINARY(inumber1);\r\n        var c = this.IMREAL(inumber2);\r\n        var d = this.IMAGINARY(inumber2);\r\n\r\n        if (utils.anyIsError(a, b, c, d)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup imaginary unit\r\n        var unit1 = inumber1.substring(inumber1.length - 1);\r\n        var unit2 = inumber2.substring(inumber2.length - 1);\r\n        var unit = 'i';\r\n        if (unit1 === 'j') {\r\n            unit = 'j';\r\n        } else if (unit2 === 'j') {\r\n            unit = 'j';\r\n        }\r\n\r\n        // Return _ of two complex numbers\r\n        return this.COMPLEX(a - c, b - d, unit);\r\n    };\r\n\r\n    exports.IMSUM = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        // Initialize result\r\n        var result = args[0];\r\n\r\n        // Loop on all numbers\r\n        for (var i = 1; i < args.length; i++) {\r\n            // Lookup coefficients of two complex numbers\r\n            var a = this.IMREAL(result);\r\n            var b = this.IMAGINARY(result);\r\n            var c = this.IMREAL(args[i]);\r\n            var d = this.IMAGINARY(args[i]);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Complute product of two complex numbers\r\n            result = this.COMPLEX(a + c, b + d);\r\n        }\r\n\r\n        // Return sum of complex numbers\r\n        return result;\r\n    };\r\n\r\n    exports.IMTAN = function(inumber) {\r\n        // Return error if inumber is a logical value\r\n        if (inumber === true || inumber === false) {\r\n            return error.value;\r\n        }\r\n\r\n        // Lookup real and imaginary coefficients using Formula.js\r\n        // [http://formulajs.org]\r\n        var x = exports.IMREAL(inumber);\r\n        var y = exports.IMAGINARY(inumber);\r\n\r\n        if (utils.anyIsError(x, y)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return tangent of complex number\r\n        return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\r\n    };\r\n\r\n    exports.OCT2BIN = function(number, places) {\r\n        // Return error if number is not hexadecimal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Check if number is negative\r\n        var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\r\n\r\n        // Return error if number is lower than -512 or greater than 511\r\n        if (decimal < -512 || decimal > 511) {\r\n            return error.num;\r\n        }\r\n\r\n        // Ignore places and return a 10-character binary number if number is\r\n        // negative\r\n        if (negative) {\r\n            return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n        }\r\n\r\n        // Convert decimal number to binary\r\n        var result = decimal.toString(2);\r\n\r\n        // Return binary number using the minimum number of characters necessary\r\n        // if places is undefined\r\n        if (typeof places === 'undefined') {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    exports.OCT2DEC = function(number) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Return decimal number\r\n        return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\r\n    };\r\n\r\n    exports.OCT2HEX = function(number, places) {\r\n        // Return error if number is not octal or contains more than ten\r\n        // characters (10 digits)\r\n        if (!/^[0-7]{1,10}$/.test(number)) {\r\n            return error.num;\r\n        }\r\n\r\n        // Convert octal number to decimal\r\n        var decimal = parseInt(number, 8);\r\n\r\n        // Ignore places and return a 10-character octal number if number is\r\n        // negative\r\n        if (decimal >= 536870912) {\r\n            return 'ff' + (decimal + 3221225472).toString(16);\r\n        }\r\n\r\n        // Convert decimal number to hexadecimal\r\n        var result = decimal.toString(16);\r\n\r\n        // Return hexadecimal number using the minimum number of characters\r\n        // necessary if places is undefined\r\n        if (places === undefined) {\r\n            return result;\r\n        } else {\r\n            // Return error if places is nonnumeric\r\n            if (isNaN(places)) {\r\n              return error.value;\r\n            }\r\n\r\n            // Return error if places is negative\r\n            if (places < 0) {\r\n              return error.num;\r\n            }\r\n\r\n            // Truncate places in case it is not an integer\r\n            places = Math.floor(places);\r\n\r\n            // Pad return value with leading 0s (zeros) if necessary (using\r\n            // Underscore.string)\r\n            return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.financial = (function() {\r\n    var exports = {};\r\n\r\n    function validDate(d) {\r\n        return d && d.getTime && !isNaN(d.getTime());\r\n    }\r\n\r\n    function ensureDate(d) {\r\n        return (d instanceof Date)?d:new Date(d);\r\n    }\r\n\r\n    exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\r\n        // Return error if either date is invalid\r\n        issue        = ensureDate(issue);\r\n        first        = ensureDate(first);\r\n        settlement = ensureDate(settlement);\r\n        if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\r\n            return '#VALUE!';\r\n        }\r\n\r\n        // Return error if either rate or par are lower than or equal to zero\r\n        if (rate <= 0 || par <= 0) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if frequency is neither 1, 2, or 4\r\n        if ([1, 2, 4].indexOf(frequency) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if basis is neither 0, 1, 2, 3, or 4\r\n        if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Return error if settlement is before or equal to issue\r\n        if (settlement <= issue) {\r\n            return '#NUM!';\r\n        }\r\n\r\n        // Set default values\r\n        par   = par   || 0;\r\n        basis = basis || 0;\r\n\r\n        // Compute accrued interest\r\n        return par * rate * YEARFRAC(issue, settlement, basis);\r\n    };\r\n\r\n    exports.ACCRINTM = null;\r\n\r\n    exports.AMORDEGRC = null;\r\n\r\n    exports.AMORLINC = null;\r\n\r\n    exports.COUPDAYBS = null;\r\n\r\n    exports.COUPDAYS = null;\r\n\r\n    exports.COUPDAYSNC = null;\r\n\r\n    exports.COUPNCD = null;\r\n\r\n    exports.COUPNUM = null;\r\n\r\n    exports.COUPPCD = null;\r\n\r\n    exports.CUMIPMT = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n        // Requires exports.FV() and exports.PMT() from exports.js\r\n            // [http://stoic.com/exports/]\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative interest\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var interest = 0;\r\n\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                interest = -value;\r\n                start++;\r\n            }\r\n        }\r\n\r\n        for (var i = start; i <= end; i++) {\r\n            if (type === 1) {\r\n                interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\r\n            } else {\r\n                interest += exports.FV(rate, i - 1, payment, value, 0);\r\n            }\r\n        }\r\n        interest *= rate;\r\n\r\n        // Return cumulative interest\r\n        return interest;\r\n    };\r\n\r\n    exports.CUMPRINC = function(rate, periods, value, start, end, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n        // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n        if (rate <= 0 || periods <= 0 || value <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if start < 1, end < 1, or start > end\r\n        if (start < 1 || end < 1 || start > end) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if type is neither 0 nor 1\r\n        if (type !== 0 && type !== 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Compute cumulative principal\r\n        var payment = exports.PMT(rate, periods, value, 0, type);\r\n        var principal = 0;\r\n        if (start === 1) {\r\n            if (type === 0) {\r\n                principal = payment + value * rate;\r\n            } else {\r\n                principal = payment;\r\n            }\r\n            start++;\r\n        }\r\n        for (var i = start; i <= end; i++) {\r\n            if (type > 0) {\r\n                principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\r\n            } else {\r\n                principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\r\n            }\r\n        }\r\n\r\n        // Return cumulative principal\r\n        return principal;\r\n    };\r\n\r\n    exports.DB = function(cost, salvage, life, period, month) {\r\n        // Initialize month\r\n        month = (month === undefined) ? 12 : month;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        month = utils.parseNumber(month);\r\n        if (utils.anyIsError(cost, salvage, life, period, month)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if month is not an integer between 1 and 12\r\n        if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Rate is rounded to three decimals places\r\n        var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\r\n\r\n        // Compute initial depreciation\r\n        var initial = cost * rate * month / 12;\r\n\r\n        // Compute total depreciation\r\n        var total = initial;\r\n        var current = 0;\r\n        var ceiling = (period === life) ? life - 1 : period;\r\n        for (var i = 2; i <= ceiling; i++) {\r\n            current = (cost - total) * rate;\r\n            total += current;\r\n        }\r\n\r\n        // Depreciation for the first and last periods are special cases\r\n        if (period === 1) {\r\n            // First period\r\n            return initial;\r\n        } else if (period === life) {\r\n            // Last period\r\n            return (cost - total) * rate;\r\n        } else {\r\n            return current;\r\n        }\r\n    };\r\n\r\n    exports.DDB = function(cost, salvage, life, period, factor) {\r\n        // Initialize factor\r\n        factor = (factor === undefined) ? 2 : factor;\r\n\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        factor = utils.parseNumber(factor);\r\n        if (utils.anyIsError(cost, salvage, life, period, factor)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if any of the parameters is negative or if factor is\r\n            // null\r\n        if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is greater than life\r\n        if (period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return 0 (zero) if salvage is greater than or equal to cost\r\n        if (salvage >= cost) {\r\n            return 0;\r\n        }\r\n\r\n        // Compute depreciation\r\n        var total = 0;\r\n        var current = 0;\r\n        for (var i = 1; i <= period; i++) {\r\n            current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\r\n            total += current;\r\n        }\r\n\r\n        // Return depreciation\r\n        return current;\r\n    };\r\n\r\n    exports.DISC = null;\r\n\r\n    exports.DOLLARDE = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\r\n\r\n        // Round result\r\n        var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\r\n        result = Math.round(result * power) / power;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DOLLARFR = function(dollar, fraction) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        dollar = utils.parseNumber(dollar);\r\n        fraction = utils.parseNumber(fraction);\r\n        if (utils.anyIsError(dollar, fraction)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if fraction is negative\r\n        if (fraction < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n        if (fraction >= 0 && fraction < 1) {\r\n            return error.div0;\r\n        }\r\n\r\n        // Truncate fraction if it is not an integer\r\n        fraction = parseInt(fraction, 10);\r\n\r\n        // Compute integer part\r\n        var result = parseInt(dollar, 10);\r\n\r\n        // Add decimal part\r\n        result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\r\n\r\n        // Return converted dollar price\r\n        return result;\r\n    };\r\n\r\n    exports.DURATION = null;\r\n\r\n    exports.EFFECT = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return effective annual interest rate\r\n        return Math.pow(1 + rate / periods, periods) - 1;\r\n    };\r\n\r\n    exports.FV = function(rate, periods, payment, value, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        value = value || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        value = utils.parseNumber(value);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, value, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return future value\r\n        var result;\r\n        if (rate === 0) {\r\n            result = value + payment * periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = value * term + payment * (1 + rate) * (term - 1) / rate;\r\n            } else {\r\n                result = value * term + payment * (term - 1) / rate;\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.FVSCHEDULE = function(principal, schedule) {\r\n        principal = utils.parseNumber(principal);\r\n        schedule = utils.parseNumberArray(utils.flatten(schedule));\r\n        if (utils.anyIsError(principal, schedule)) {\r\n            return error.value;\r\n        }\r\n\r\n        var n = schedule.length;\r\n        var future = principal;\r\n\r\n        // Apply all interests in schedule\r\n        for (var i = 0; i < n; i++) {\r\n            // Apply scheduled interest\r\n            future *= 1 + schedule[i];\r\n        }\r\n\r\n        // Return future value\r\n        return future;\r\n    };\r\n\r\n    exports.INTRATE = null;\r\n\r\n    exports.IPMT = function(rate, period, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, period, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Compute payment\r\n        var payment = exports.PMT(rate, periods, present, future, type);\r\n\r\n        // Compute interest\r\n        var interest;\r\n        if (period === 1) {\r\n            if (type === 1) {\r\n                interest = 0;\r\n            } else {\r\n                interest = -present;\r\n            }\r\n        } else {\r\n            if (type === 1) {\r\n                interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\r\n            } else {\r\n                interest = exports.FV(rate, period - 1, payment, present, 0);\r\n            }\r\n        }\r\n\r\n        // Return interest\r\n        return interest * rate;\r\n    };\r\n\r\n    exports.IRR = function(values, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        guess = guess || 0;\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = (dates[i] - dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Initialize dates and check that values contains at least one positive\r\n            // value and one negative value\r\n        var dates = [];\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = (guess === undefined) ? 0.1 : guess;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.ISPMT = function(rate, period, periods, value) {\r\n        rate = utils.parseNumber(rate);\r\n        period = utils.parseNumber(period);\r\n        periods = utils.parseNumber(periods);\r\n        value = utils.parseNumber(value);\r\n        if (utils.anyIsError(rate, period, periods, value)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return interest\r\n        return value * rate * (period / periods - 1);\r\n    };\r\n\r\n    exports.MDURATION = null;\r\n\r\n    exports.MIRR = function(values, finance_rate, reinvest_rate) {\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        finance_rate = utils.parseNumber(finance_rate);\r\n        reinvest_rate = utils.parseNumber(reinvest_rate);\r\n        if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Initialize number of values\r\n        var n = values.length;\r\n\r\n        // Lookup payments (negative values) and incomes (positive values)\r\n        var payments = [];\r\n        var incomes = [];\r\n        for (var i = 0; i < n; i++) {\r\n            if (values[i] < 0) {\r\n                payments.push(values[i]);\r\n            } else {\r\n                incomes.push(values[i]);\r\n            }\r\n        }\r\n\r\n        // Return modified internal rate of return\r\n        var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\r\n        var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\r\n        return Math.pow(num / den, 1 / (n - 1)) - 1;\r\n    };\r\n\r\n    exports.NOMINAL = function(rate, periods) {\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        if (utils.anyIsError(rate, periods)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0 or periods < 1\r\n        if (rate <= 0 || periods < 1) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate periods if it is not an integer\r\n        periods = parseInt(periods, 10);\r\n\r\n        // Return nominal annual interest rate\r\n        return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\r\n    };\r\n\r\n    exports.NPER = function(rate, payment, present, future, type) {\r\n        type = (type === undefined) ? 0 : type;\r\n        future = (future === undefined) ? 0 : future;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, payment, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return number of periods\r\n        var num = payment * (1 + rate * type) - future * rate;\r\n        var den = (present * rate + payment * (1 + rate * type));\r\n        return Math.log(num / den) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.NPV = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n\r\n        // Lookup rate\r\n        var rate = args[0];\r\n\r\n        // Initialize net present value\r\n        var value = 0;\r\n\r\n        // Loop on all values\r\n        for (var j = 1; j < args.length; j++) {\r\n            value += args[j] / Math.pow(1 + rate, j);\r\n        }\r\n\r\n        // Return net present value\r\n        return value;\r\n    };\r\n\r\n    exports.ODDFPRICE = null;\r\n\r\n    exports.ODDFYIELD = null;\r\n\r\n    exports.ODDLPRICE = null;\r\n\r\n    exports.ODDLYIELD = null;\r\n\r\n    exports.PDURATION = function(rate, present, future) {\r\n        rate = utils.parseNumber(rate);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(rate, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if rate <=0\r\n        if (rate <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return number of periods\r\n        return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\r\n    };\r\n\r\n    exports.PMT = function(rate, periods, present, future, type) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return payment\r\n        var result;\r\n        if (rate === 0) {\r\n            result = (present + future) / periods;\r\n        } else {\r\n            var term = Math.pow(1 + rate, periods);\r\n            if (type === 1) {\r\n                result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\r\n            } else {\r\n                result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\r\n            }\r\n        }\r\n        return -result;\r\n    };\r\n\r\n    exports.PPMT = function(rate, period, periods, present, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, present, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\r\n    };\r\n\r\n    exports.PRICE = null;\r\n\r\n    exports.PRICEDISC = null;\r\n\r\n    exports.PRICEMAT = null;\r\n\r\n    exports.PV = function(rate, periods, payment, future, type) {\r\n        future = future || 0;\r\n        type = type || 0;\r\n\r\n        rate = utils.parseNumber(rate);\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        if (utils.anyIsError(rate, periods, payment, future, type)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return present value\r\n        if (rate === 0) {\r\n            return -payment * periods - future;\r\n        } else {\r\n            return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\r\n        }\r\n    };\r\n\r\n    exports.RATE = function(periods, payment, present, future, type, guess) {\r\n        // Credits: rabugento\r\n\r\n        guess = (guess === undefined) ? 0.01 : guess;\r\n        future = (future === undefined) ? 0 : future;\r\n        type = (type === undefined) ? 0 : type;\r\n\r\n        periods = utils.parseNumber(periods);\r\n        payment = utils.parseNumber(payment);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        type = utils.parseNumber(type);\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(periods, payment, present, future, type, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-6;\r\n\r\n        // Set maximum number of iterations\r\n        var iterMax = 100;\r\n        var iter = 0;\r\n        var close = false;\r\n        var rate = guess;\r\n\r\n        while (iter < iterMax && !close) {\r\n            var t1 = Math.pow(rate + 1, periods);\r\n            var t2 = Math.pow(rate + 1, periods - 1);\r\n\r\n            var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\r\n            var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\r\n            var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\r\n\r\n            var newRate = rate - f1 / (f2 + f3);\r\n\r\n            if (Math.abs(newRate - rate) < epsMax) close = true;\r\n            iter++\r\n            rate = newRate;\r\n        }\r\n\r\n        if (!close) return Number.NaN + rate;\r\n        return rate;\r\n    };\r\n\r\n    // TODO\r\n    exports.RECEIVED = null;\r\n\r\n    exports.RRI = function(periods, present, future) {\r\n        periods = utils.parseNumber(periods);\r\n        present = utils.parseNumber(present);\r\n        future = utils.parseNumber(future);\r\n        if (utils.anyIsError(periods, present, future)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if periods or present is equal to 0 (zero)\r\n        if (periods === 0 || present === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return equivalent interest rate\r\n        return Math.pow(future / present, 1 / periods) - 1;\r\n    };\r\n\r\n    exports.SLN = function(cost, salvage, life) {\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        if (utils.anyIsError(cost, salvage, life)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return straight-line depreciation\r\n        return (cost - salvage) / life;\r\n    };\r\n\r\n    exports.SYD = function(cost, salvage, life, period) {\r\n        // Return error if any of the parameters is not a number\r\n        cost = utils.parseNumber(cost);\r\n        salvage = utils.parseNumber(salvage);\r\n        life = utils.parseNumber(life);\r\n        period = utils.parseNumber(period);\r\n        if (utils.anyIsError(cost, salvage, life, period)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if life equal to 0 (zero)\r\n        if (life === 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if period is lower than 1 or greater than life\r\n        if (period < 1 || period > life) {\r\n            return error.num;\r\n        }\r\n\r\n        // Truncate period if it is not an integer\r\n        period = parseInt(period, 10);\r\n\r\n        // Return straight-line depreciation\r\n        return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\r\n    };\r\n\r\n    exports.TBILLEQ = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (365 * discount) / (360 - discount * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.TBILLPRICE = function(settlement, maturity, discount) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        discount = utils.parseNumber(discount);\r\n        if (utils.anyIsError(settlement, maturity, discount)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if discount is lower than or equal to zero\r\n        if (discount <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\r\n    };\r\n\r\n    exports.TBILLYIELD = function(settlement, maturity, price) {\r\n        settlement = utils.parseDate(settlement);\r\n        maturity = utils.parseDate(maturity);\r\n        price = utils.parseNumber(price);\r\n        if (utils.anyIsError(settlement, maturity, price)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Return error if price is lower than or equal to zero\r\n        if (price <= 0) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if settlement is greater than maturity\r\n        if (settlement > maturity) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return error if maturity is more than one year after settlement\r\n        if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n            return error.num;\r\n        }\r\n\r\n        // Return bond-equivalent yield\r\n        return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\r\n    };\r\n\r\n    exports.VDB = null;\r\n\r\n    exports.XIRR = function(values, dates, guess) {\r\n        // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        guess = utils.parseNumber(guess);\r\n        if (utils.anyIsError(values, dates, guess)) {\r\n            return error.value;\r\n        }\r\n\r\n        // Calculates the resulting amount\r\n        var irrResult = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = values[0];\r\n            for (var i = 1; i < values.length; i++) {\r\n                result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Calculates the first derivation\r\n        var irrResultDeriv = function(values, dates, rate) {\r\n            var r = rate + 1;\r\n            var result = 0;\r\n            for (var i = 1; i < values.length; i++) {\r\n                var frac = DAYS(dates[i], dates[0]) / 365;\r\n                result -= frac * values[i] / Math.pow(r, frac + 1);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        // Check that values contains at least one positive value and one\r\n            // negative value\r\n        var positive = false;\r\n        var negative = false;\r\n        for (var i = 0; i < values.length; i++) {\r\n            if (values[i] > 0) {\r\n                positive = true;\r\n            }\r\n            if (values[i] < 0) {\r\n                negative = true;\r\n            }\r\n        }\r\n\r\n        // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n        if (!positive || !negative) {\r\n            return error.num;\r\n        }\r\n\r\n        // Initialize guess and resultRate\r\n        guess = guess || 0.1;\r\n        var resultRate = guess;\r\n\r\n        // Set maximum epsilon for end of iteration\r\n        var epsMax = 1e-10;\r\n\r\n        // Implement Newton's method\r\n        var newRate, epsRate, resultValue;\r\n        var contLoop = true;\r\n        do {\r\n            resultValue = irrResult(values, dates, resultRate);\r\n            newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n            epsRate = Math.abs(newRate - resultRate);\r\n            resultRate = newRate;\r\n            contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n        } while (contLoop);\r\n\r\n        // Return internal rate of return\r\n        return resultRate;\r\n    };\r\n\r\n    exports.XNPV = function(rate, values, dates) {\r\n        rate = utils.parseNumber(rate);\r\n        values = utils.parseNumberArray(utils.flatten(values));\r\n        dates = utils.parseDateArray(utils.flatten(dates));\r\n        if (utils.anyIsError(rate, values, dates)) {\r\n            return error.value;\r\n        }\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < values.length; i++) {\r\n            result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.YIELD = null;\r\n\r\n    exports.YIELDDISC = null;\r\n\r\n    exports.YIELDMAT = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.information = (function() {\r\n    var exports = {};\r\n    exports.CELL = null;\r\n\r\n    exports.ERROR = {};\r\n    exports.ERROR.TYPE = function(error_val) {\r\n        switch (error_val) {\r\n            case error.nil: return 1;\r\n            case error.div0: return 2;\r\n            case error.value: return 3;\r\n            case error.ref: return 4;\r\n            case error.name: return 5;\r\n            case error.num: return 6;\r\n            case error.na: return 7;\r\n            case error.data: return 8;\r\n        }\r\n        return error.na;\r\n    };\r\n\r\n    exports.INFO = null;\r\n\r\n    exports.ISBLANK = function(value) {\r\n        return value === null;\r\n    };\r\n\r\n    exports.ISBINARY = function (number) {\r\n        return (/^[01]{1,10}$/).test(number);\r\n    };\r\n\r\n    exports.ISERR = function(value) {\r\n        return ([error.value, error.ref, error.div0, error.num, error.name, error.nil]).indexOf(value) >= 0 ||\r\n            (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\r\n    };\r\n\r\n    exports.ISERROR = function(value) {\r\n        return exports.ISERR(value) || value === error.na;\r\n    };\r\n\r\n    exports.ISEVEN = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? false : true;\r\n    };\r\n\r\n    // TODO\r\n    exports.ISFORMULA = null;\r\n\r\n    exports.ISLOGICAL = function(value) {\r\n        return value === true || value === false;\r\n    };\r\n\r\n    exports.ISNA = function(value) {\r\n        return value === error.na;\r\n    };\r\n\r\n    exports.ISNONTEXT = function(value) {\r\n        return typeof(value) !== 'string';\r\n    };\r\n\r\n    exports.ISNUMBER = function(value) {\r\n        return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\r\n    };\r\n\r\n    exports.ISODD = function(number) {\r\n        return (Math.floor(Math.abs(number)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.ISREF = null;\r\n\r\n    exports.ISTEXT = function(value) {\r\n        return typeof(value) === 'string';\r\n    };\r\n\r\n    exports.N = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return value;\r\n        }\r\n        if (value instanceof Date) {\r\n            return value.getTime();\r\n        }\r\n        if (value === true) {\r\n            return 1;\r\n        }\r\n        if (value === false) {\r\n            return 0;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return value;\r\n        }\r\n        return 0;\r\n    };\r\n\r\n    exports.NA = function() {\r\n        return error.na;\r\n    };\r\n\r\n    exports.SHEET = null;\r\n\r\n    exports.SHEETS = null;\r\n\r\n    exports.TYPE = function(value) {\r\n        if (this.ISNUMBER(value)) {\r\n            return 1;\r\n        }\r\n        if (this.ISTEXT(value)) {\r\n            return 2;\r\n        }\r\n        if (this.ISLOGICAL(value)) {\r\n            return 4;\r\n        }\r\n        if (this.ISERROR(value)) {\r\n            return 16;\r\n        }\r\n        if (Array.isArray(value)) {\r\n            return 64;\r\n        }\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.logical = (function() {\r\n    var exports = {};\r\n\r\n    exports.AND = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = true;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (!args[i]) {\r\n                result = false;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.CHOOSE = function() {\r\n        if (arguments.length < 2) {\r\n            return error.na;\r\n        }\r\n\r\n        var index = arguments[0];\r\n        if (index < 1 || index > 254) {\r\n            return error.value;\r\n        }\r\n\r\n        if (arguments.length < index + 1) {\r\n            return error.value;\r\n        }\r\n\r\n        return arguments[index];\r\n    };\r\n\r\n    exports.FALSE = function() {\r\n        return false;\r\n    };\r\n\r\n    exports.IF = function(test, then_value, otherwise_value) {\r\n        return test ? then_value : otherwise_value;\r\n    };\r\n\r\n    exports.IFERROR = function(value, valueIfError) {\r\n        if (ISERROR(value)) {\r\n            return valueIfError;\r\n        }\r\n        return value;\r\n    };\r\n\r\n    exports.IFNA = function(value, value_if_na) {\r\n        return value === error.na ? value_if_na : value;\r\n    };\r\n\r\n    exports.NOT = function(logical) {\r\n        return !logical;\r\n    };\r\n\r\n    exports.OR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = false;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result = true;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TRUE = function() {\r\n        return true;\r\n    };\r\n\r\n    exports.XOR = function() {\r\n        var args = utils.flatten(arguments);\r\n        var result = 0;\r\n        for (var i = 0; i < args.length; i++) {\r\n            if (args[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return (Math.floor(Math.abs(result)) & 1) ? true : false;\r\n    };\r\n\r\n    exports.SWITCH = function() {\r\n        var result;\r\n        if (arguments.length > 0)  {\r\n            var targetValue = arguments[0];\r\n            var argc = arguments.length - 1;\r\n            var switchCount = Math.floor(argc / 2);\r\n            var switchSatisfied = false;\r\n            var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\r\n\r\n            if (switchCount) {\r\n                for (var index = 0; index < switchCount; index++) {\r\n                    if (targetValue === arguments[index * 2 + 1]) {\r\n                      result = arguments[index * 2 + 2];\r\n                      switchSatisfied = true;\r\n                      break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (!switchSatisfied && defaultClause) {\r\n                result = defaultClause;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.math = (function() {\r\n    var exports = {};\r\n\r\n    exports.ABS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.abs(utils.parseNumber(number));\r\n    };\r\n\r\n    exports.ACOS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.acos(number);\r\n    };\r\n\r\n    exports.ACOSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number - 1));\r\n    };\r\n\r\n    exports.ACOT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(1 / number);\r\n    };\r\n\r\n    exports.ACOTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 0.5 * Math.log((number + 1) / (number - 1));\r\n    };\r\n\r\n    exports.AGGREGATE = null\r\n\r\n    exports.ARABIC = function(text) {\r\n        // Credits: Rafa? Kukawski\r\n        if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\r\n            return error.value;\r\n        }\r\n        var r = 0;\r\n        text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {\r\n            r += {\r\n                M: 1000,\r\n                CM: 900,\r\n                D: 500,\r\n                CD: 400,\r\n                C: 100,\r\n                XC: 90,\r\n                L: 50,\r\n                XL: 40,\r\n                X: 10,\r\n                IX: 9,\r\n                V: 5,\r\n                IV: 4,\r\n                I: 1\r\n            }[i];\r\n        });\r\n        return r;\r\n    };\r\n\r\n    exports.ASIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.asin(number);\r\n    };\r\n\r\n    exports.ASINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number + Math.sqrt(number * number + 1));\r\n    };\r\n\r\n    exports.ATAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.atan(number);\r\n    };\r\n\r\n    exports.ATAN2 = function(number_x, number_y) {\r\n        number_x = utils.parseNumber(number_x);\r\n        number_y = utils.parseNumber(number_y);\r\n        if (utils.anyIsError(number_x, number_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.atan2(number_x, number_y);\r\n    };\r\n\r\n    exports.ATANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log((1 + number) / (1 - number)) / 2;\r\n    };\r\n\r\n    exports.BASE = function(number, radix, min_length) {\r\n        min_length = min_length || 0;\r\n\r\n        number = utils.parseNumber(number);\r\n        radix = utils.parseNumber(radix);\r\n        min_length = utils.parseNumber(min_length);\r\n        if (utils.anyIsError(number, radix, min_length)) {\r\n            return error.value;\r\n        }\r\n        min_length = (min_length === undefined) ? 0 : min_length;\r\n        var result = number.toString(radix);\r\n        return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\r\n    };\r\n\r\n    exports.CEILING = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.ceil(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.CEILING.MATH = exports.CEILING;\r\n\r\n    exports.CEILING.PRECISE = exports.CEILING;\r\n\r\n    exports.COMBIN = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\r\n    };\r\n\r\n    exports.COMBINA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\r\n    };\r\n\r\n    exports.COS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.cos(number);\r\n    };\r\n\r\n    exports.COSH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) + Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.COT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.tan(number);\r\n    };\r\n\r\n    exports.COTH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 + 1) / (e2 - 1);\r\n    };\r\n\r\n    exports.CSC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.sin(number);\r\n    };\r\n\r\n    exports.CSCH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) - Math.exp(-number));\r\n    };\r\n\r\n    exports.DECIMAL = function(number, radix) {\r\n        if (arguments.length < 1) {\r\n            return error.value;\r\n        }\r\n\r\n\r\n        return parseInt(number, radix);\r\n    };\r\n\r\n    exports.DEGREES = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * 180 / Math.PI;\r\n    };\r\n\r\n    exports.EVEN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return exports.CEILING(number, -2, -1);\r\n    };\r\n\r\n    exports.EXP = Math.exp;\r\n\r\n    var MEMOIZED_FACT = [];\r\n    exports.FACT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n === 0 || n === 1) {\r\n            return 1;\r\n        } else if (MEMOIZED_FACT[n] > 0) {\r\n            return MEMOIZED_FACT[n];\r\n        } else {\r\n            MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\r\n            return MEMOIZED_FACT[n];\r\n        }\r\n    };\r\n\r\n    exports.FACTDOUBLE = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var n = Math.floor(number);\r\n        if (n <= 0) {\r\n            return 1;\r\n        } else {\r\n            return n * exports.FACTDOUBLE(n - 2);\r\n        }\r\n    };\r\n\r\n    exports.FLOOR = function(number, significance, mode) {\r\n        significance = (significance === undefined) ? 1 : significance;\r\n        mode = (mode === undefined) ? 0 : mode;\r\n\r\n        number = utils.parseNumber(number);\r\n        significance = utils.parseNumber(significance);\r\n        mode = utils.parseNumber(mode);\r\n        if (utils.anyIsError(number, significance, mode)) {\r\n            return error.value;\r\n        }\r\n        if (significance === 0) {\r\n            return 0;\r\n        }\r\n\r\n        significance = Math.abs(significance);\r\n        if (number >= 0) {\r\n            return Math.floor(number / significance) * significance;\r\n        } else {\r\n            if (mode === 0) {\r\n                return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n            } else {\r\n                return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.FLOOR.MATH = exports.FLOOR;\r\n\r\n    exports.GCD = null;\r\n\r\n    exports.INT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.floor(number);\r\n    };\r\n\r\n    exports.LCM = function() {\r\n        // Credits: Jonas Raoni Soares Silva\r\n        var o = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (o instanceof Error) {\r\n            return o;\r\n        }\r\n        for (var i, j, n, d, r = 1;\r\n            (n = o.pop()) !== undefined;) {\r\n            while (n > 1) {\r\n                if (n % 2) {\r\n                    for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\r\n                      //empty\r\n                    }\r\n                    d = (i <= j) ? i : n;\r\n                } else {\r\n                    d = 2;\r\n                }\r\n                for (n /= d, r *= d, i = o.length; i;\r\n                    (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\r\n                    //empty\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number);\r\n    };\r\n\r\n    exports.LOG = function(number, base) {\r\n        number = utils.parseNumber(number);\r\n        base = (base === undefined) ? 10 : utils.parseNumber(base);\r\n\r\n        if (utils.anyIsError(number, base)) {\r\n            return error.value;\r\n        }\r\n\r\n        return Math.log(number) / Math.log(base);\r\n    };\r\n\r\n    exports.LOG10 = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.log(number) / Math.log(10);\r\n    };\r\n\r\n    exports.MDETERM = null;\r\n\r\n    exports.MINVERSE = null;\r\n\r\n    exports.MMULT = null;\r\n\r\n    exports.MOD = function(dividend, divisor) {\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n        var modulus = Math.abs(dividend % divisor);\r\n        return (divisor > 0) ? modulus : -modulus;\r\n    };\r\n\r\n    exports.MROUND = function(number, multiple) {\r\n        number = utils.parseNumber(number);\r\n        multiple = utils.parseNumber(multiple);\r\n        if (utils.anyIsError(number, multiple)) {\r\n            return error.value;\r\n        }\r\n        if (number * multiple < 0) {\r\n            return error.num;\r\n        }\r\n\r\n        return Math.round(number / multiple) * multiple;\r\n    };\r\n\r\n    exports.MULTINOMIAL = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var sum = 0;\r\n        var divisor = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            sum += args[i];\r\n            divisor *= exports.FACT(args[i]);\r\n        }\r\n        return exports.FACT(sum) / divisor;\r\n    };\r\n\r\n    exports.MUNIT = null;\r\n\r\n    exports.ODD = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var temp = Math.ceil(Math.abs(number));\r\n        temp = (temp & 1) ? temp : temp + 1;\r\n        return (number > 0) ? temp : -temp;\r\n    };\r\n\r\n    exports.PI = function() {\r\n        return Math.PI;\r\n    };\r\n\r\n    exports.POWER = function(number, power) {\r\n        number = utils.parseNumber(number);\r\n        power = utils.parseNumber(power);\r\n        if (utils.anyIsError(number, power)) {\r\n            return error.value;\r\n        }\r\n        var result = Math.pow(number, power);\r\n        if (isNaN(result)) {\r\n            return error.num;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.PRODUCT = function() {\r\n        var args = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (args instanceof Error) {\r\n            return args;\r\n        }\r\n        var result = 1;\r\n        for (var i = 0; i < args.length; i++) {\r\n            result *= args[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUOTIENT = function(numerator, denominator) {\r\n        numerator = utils.parseNumber(numerator);\r\n        denominator = utils.parseNumber(denominator);\r\n        if (utils.anyIsError(numerator, denominator)) {\r\n            return error.value;\r\n        }\r\n        return parseInt(numerator / denominator, 10);\r\n    };\r\n\r\n    exports.RADIANS = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return number * Math.PI / 180;\r\n    };\r\n\r\n    exports.RAND = function() {\r\n        return Math.random();\r\n    };\r\n\r\n    exports.RANDBETWEEN = function(bottom, top) {\r\n        bottom = utils.parseNumber(bottom);\r\n        top = utils.parseNumber(top);\r\n        if (utils.anyIsError(bottom, top)) {\r\n            return error.value;\r\n        }\r\n        // Creative Commons Attribution 3.0 License\r\n        // Copyright (c) 2012 eqcode\r\n        return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\r\n    };\r\n\r\n    exports.ROMAN = null;\r\n\r\n    exports.ROUND = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDDOWN = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.ROUNDUP = function(number, digits) {\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    exports.SEC = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 1 / Math.cos(number);\r\n    };\r\n\r\n    exports.SECH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return 2 / (Math.exp(number) + Math.exp(-number));\r\n    };\r\n\r\n    exports.SERIESSUM = function(x, n, m, coefficients) {\r\n        x = utils.parseNumber(x);\r\n        n = utils.parseNumber(n);\r\n        m = utils.parseNumber(m);\r\n        coefficients = utils.parseNumberArray(coefficients);\r\n        if (utils.anyIsError(x, n, m, coefficients)) {\r\n            return error.value;\r\n        }\r\n        var result = coefficients[0] * Math.pow(x, n);\r\n        for (var i = 1; i < coefficients.length; i++) {\r\n            result += coefficients[i] * Math.pow(x, n + i * m);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SIGN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return -1;\r\n        } else if (number === 0) {\r\n            return 0;\r\n        } else {\r\n            return 1;\r\n        }\r\n    };\r\n\r\n    exports.SIN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sin(number);\r\n    };\r\n\r\n    exports.SINH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return (Math.exp(number) - Math.exp(-number)) / 2;\r\n    };\r\n\r\n    exports.SQRT = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        if (number < 0) {\r\n            return error.num;\r\n        }\r\n        return Math.sqrt(number);\r\n    };\r\n\r\n    exports.SQRTPI = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.sqrt(number * Math.PI);\r\n    };\r\n\r\n    exports.SUBTOTAL = null;\r\n\r\n    exports.ADD = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 + num2;\r\n    };\r\n\r\n    exports.MINUS = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return num1 - num2;\r\n    };\r\n\r\n    exports.DIVIDE = function (dividend, divisor) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        dividend = utils.parseNumber(dividend);\r\n        divisor = utils.parseNumber(divisor);\r\n        if (utils.anyIsError(dividend, divisor)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (divisor === 0) {\r\n            return error.div0;\r\n        }\r\n\r\n        return dividend / divisor;\r\n    };\r\n\r\n    exports.MULTIPLY = function (factor1, factor2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        factor1 = utils.parseNumber(factor1);\r\n        factor2 = utils.parseNumber(factor2);\r\n        if (utils.anyIsError(factor1, factor2)) {\r\n            return error.value;\r\n        }\r\n\r\n        return factor1 * factor2;\r\n    };\r\n\r\n    exports.GTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 >= num2;\r\n    };\r\n\r\n    exports.LT = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 < num2;\r\n    };\r\n\r\n    exports.LTE = function (num1, num2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        num1 = utils.parseNumber(num1);\r\n        num2 = utils.parseNumber(num2);\r\n        if (utils.anyIsError(num1, num2)) {\r\n            return error.error;\r\n        }\r\n\r\n        return num1 <= num2;\r\n    };\r\n\r\n    exports.EQ = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 === value2;\r\n    };\r\n\r\n    exports.NE = function (value1, value2) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        return value1 !== value2;\r\n    };\r\n\r\n    exports.POW = function (base, exponent) {\r\n        if (arguments.length !== 2) {\r\n            return error.na;\r\n        }\r\n\r\n        base = utils.parseNumber(base);\r\n        exponent = utils.parseNumber(exponent);\r\n        if (utils.anyIsError(base, exponent)) {\r\n            return error.error;\r\n        }\r\n\r\n        return exports.POWER(base, exponent);\r\n    };\r\n\r\n    exports.SUM = function() {\r\n        var result = 0;\r\n        var argsKeys = Object.keys(arguments);\r\n        for (var i = 0; i < argsKeys.length; ++i) {\r\n            var elt = arguments[argsKeys[i]];\r\n            if (typeof elt === 'number') {\r\n                result += elt;\r\n            } else if (typeof elt === 'string') {\r\n                var parsed = parseFloat(elt);\r\n                !isNaN(parsed) && (result += parsed);\r\n            } else if (Array.isArray(elt)) {\r\n                result += exports.SUM.apply(null, elt);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIF = function(range, criteria) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var range = utils.parseNumberArray(utils.flatten(args.shift()));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var criteria = args;\r\n\r\n        var n_range_elements = range.length;\r\n        var n_criterias = criteria.length;\r\n\r\n        var result = 0;\r\n        for (var i = 0; i < n_range_elements; i++) {\r\n            var el = range[i];\r\n            var condition = '';\r\n            for (var c = 0; c < n_criterias; c++) {\r\n                condition += el + criteria[c];\r\n                if (c !== n_criterias - 1) {\r\n                    condition += '&&';\r\n                }\r\n            }\r\n            if (eval(condition)) { // jshint ignore:line\r\n                result += el;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMPRODUCT = null;\r\n\r\n    exports.SUMSQ = function() {\r\n        var numbers = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (numbers instanceof Error) {\r\n            return numbers;\r\n        }\r\n        var result = 0;\r\n        var length = numbers.length;\r\n        for (var i = 0; i < length; i++) {\r\n            result += (ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2MY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMX2PY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.SUMXMY2 = function(array_x, array_y) {\r\n        array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n        array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n        if (utils.anyIsError(array_x, array_y)) {\r\n            return error.value;\r\n        }\r\n        var result = 0;\r\n        array_x = utils.flatten(array_x);\r\n        array_y = utils.flatten(array_y);\r\n        for (var i = 0; i < array_x.length; i++) {\r\n            result += Math.pow(array_x[i] - array_y[i], 2);\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.TAN = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return Math.tan(number);\r\n    };\r\n\r\n    exports.TANH = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        var e2 = Math.exp(2 * number);\r\n        return (e2 - 1) / (e2 + 1);\r\n    };\r\n\r\n    exports.TRUNC = function(number, digits) {\r\n        digits = (digits === undefined) ? 0 : digits;\r\n        number = utils.parseNumber(number);\r\n        digits = utils.parseNumber(digits);\r\n        if (utils.anyIsError(number, digits)) {\r\n            return error.value;\r\n        }\r\n        var sign = (number > 0) ? 1 : -1;\r\n        return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.misc = (function() {\r\n    var exports = {};\r\n\r\n    exports.UNIQUE = function () {\r\n        var result = [];\r\n        for (var i = 0; i < arguments.length; ++i) {\r\n            var hasElement = false;\r\n            var element = arguments[i];\r\n\r\n            // Check if we've already seen this element.\r\n            for (var j = 0; j < result.length; ++j) {\r\n                hasElement = result[j] === element;\r\n                if (hasElement) { break; }\r\n            }\r\n\r\n            // If we did not find it, add it to the result.\r\n            if (!hasElement) {\r\n                result.push(element);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.FLATTEN = utils.flatten;\r\n\r\n    exports.ARGS2ARRAY = function () {\r\n        return Array.prototype.slice.call(arguments, 0);\r\n    };\r\n\r\n    exports.REFERENCE = function (context, reference) {\r\n        try {\r\n            var path = reference.split('.');\r\n            var result = context;\r\n            for (var i = 0; i < path.length; ++i) {\r\n                var step = path[i];\r\n                if (step[step.length - 1] === ']') {\r\n                    var opening = step.indexOf('[');\r\n                    var index = step.substring(opening + 1, step.length - 1);\r\n                    result = result[step.substring(0, opening)][index];\r\n                } else {\r\n                    result = result[step];\r\n                }\r\n            }\r\n            return result;\r\n        } catch (error) {}\r\n    };\r\n\r\n    exports.JOIN = function (array, separator) {\r\n        return array.join(separator);\r\n    };\r\n\r\n    exports.NUMBERS = function () {\r\n        var possibleNumbers = utils.flatten(arguments);\r\n        return possibleNumbers.filter(function (el) {\r\n            return typeof el === 'number';\r\n        });\r\n    };\r\n\r\n    exports.NUMERAL = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.text = (function() {\r\n    var exports = {};\r\n\r\n    exports.ASC = null;\r\n\r\n    exports.BAHTTEXT = null;\r\n\r\n    exports.CHAR = function(number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return String.fromCharCode(number);\r\n    };\r\n\r\n    exports.CLEAN = function(text) {\r\n        text = text || '';\r\n        var re = /[\\0-\\x1F]/g;\r\n        return text.replace(re, \"\");\r\n    };\r\n\r\n    exports.CODE = function(text) {\r\n        text = text || '';\r\n        return text.charCodeAt(0);\r\n    };\r\n\r\n    exports.CONCATENATE = function() {\r\n        var args = utils.flatten(arguments);\r\n\r\n        var trueFound = 0;\r\n        while ((trueFound = args.indexOf(true)) > -1) {\r\n            args[trueFound] = 'TRUE';\r\n        }\r\n\r\n        var falseFound = 0;\r\n        while ((falseFound = args.indexOf(false)) > -1) {\r\n            args[falseFound] = 'FALSE';\r\n        }\r\n\r\n        return args.join('');\r\n    };\r\n\r\n    exports.DBCS = null;\r\n\r\n    exports.DOLLAR = null;\r\n\r\n    exports.EXACT = function(text1, text2) {\r\n        return text1 === text2;\r\n    };\r\n\r\n    exports.FIND = function(find_text, within_text, position) {\r\n        position = (position === undefined) ? 0 : position;\r\n        return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\r\n    };\r\n\r\n    exports.FIXED = null;\r\n\r\n    exports.HTML2TEXT = function (value) {\r\n        var result = '';\r\n\r\n        if (value) {\r\n            if (value instanceof Array) {\r\n                value.forEach(function (line) {\r\n                    if (result !== '') {\r\n                      result += '\\n';\r\n                    }\r\n                    result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\r\n                });\r\n            } else {\r\n                result = value.replace(/<(?:.|\\n)*?>/gm, '');\r\n            }\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    exports.LEFT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error || typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.substring(0, number) : null;\r\n    };\r\n\r\n    exports.LEN = function(text) {\r\n        if (arguments.length === 0) {\r\n            return error.error;\r\n        }\r\n\r\n        if (typeof text === 'string') {\r\n            return text ? text.length : 0;\r\n        }\r\n\r\n        if (text.length) {\r\n            return text.length;\r\n        }\r\n\r\n        return error.value;\r\n    };\r\n\r\n    exports.LOWER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text ? text.toLowerCase() : text;\r\n    };\r\n\r\n    exports.MID = function(text, start, number) {\r\n        start = utils.parseNumber(start);\r\n        number = utils.parseNumber(number);\r\n        if (utils.anyIsError(start, number) || typeof text !== 'string') {\r\n            return number;\r\n        }\r\n\r\n        var begin = start - 1;\r\n        var end = begin + number;\r\n\r\n        return text.substring(begin, end);\r\n    };\r\n\r\n    exports.NUMBERVALUE = null;\r\n\r\n    exports.PRONETIC = null;\r\n\r\n    exports.PROPER = function(text) {\r\n        if (text === undefined || text.length === 0) {\r\n            return error.value;\r\n        }\r\n        if (text === true) {\r\n            text = 'TRUE';\r\n        }\r\n        if (text === false) {\r\n            text = 'FALSE';\r\n        }\r\n        if (isNaN(text) && typeof text === 'number') {\r\n            return error.value;\r\n        }\r\n        if (typeof text === 'number') {\r\n            text = '' + text;\r\n        }\r\n\r\n        return text.replace(/\\w\\S*/g, function(txt) {\r\n            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n        });\r\n    };\r\n\r\n    exports.REGEXEXTRACT = function (text, regular_expression) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\r\n    };\r\n\r\n    exports.REGEXMATCH = function (text, regular_expression, full) {\r\n        var match = text.match(new RegExp(regular_expression));\r\n        return full ? match : !!match;\r\n    };\r\n\r\n    exports.REGEXREPLACE = function (text, regular_expression, replacement) {\r\n        return text.replace(new RegExp(regular_expression), replacement);\r\n    };\r\n\r\n    exports.REPLACE = function(text, position, length, new_text) {\r\n        position = utils.parseNumber(position);\r\n        length = utils.parseNumber(length);\r\n        if (utils.anyIsError(position, length) ||\r\n            typeof text !== 'string' ||\r\n            typeof new_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\r\n    };\r\n\r\n    exports.REPT = function(text, number) {\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return new Array(number + 1).join(text);\r\n    };\r\n\r\n    exports.RIGHT = function(text, number) {\r\n        number = (number === undefined) ? 1 : number;\r\n        number = utils.parseNumber(number);\r\n        if (number instanceof Error) {\r\n            return number;\r\n        }\r\n        return text ? text.substring(text.length - number) : null;\r\n    };\r\n\r\n    exports.SEARCH = function(find_text, within_text, position) {\r\n        var foundAt;\r\n        if (typeof find_text !== 'string' || typeof within_text !== 'string') {\r\n            return error.value;\r\n        }\r\n        position = (position === undefined) ? 0 : position;\r\n        foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\r\n        return (foundAt === 0)?error.value:foundAt;\r\n    };\r\n\r\n    exports.SPLIT = function (text, separator) {\r\n        return text.split(separator);\r\n    };\r\n\r\n    exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\r\n        if (!text || !old_text || !new_text) {\r\n            return text;\r\n        } else if (occurrence === undefined) {\r\n            return text.replace(new RegExp(old_text, 'g'), new_text);\r\n        } else {\r\n            var index = 0;\r\n            var i = 0;\r\n            while (text.indexOf(old_text, index) > 0) {\r\n                index = text.indexOf(old_text, index + 1);\r\n                i++;\r\n                if (i === occurrence) {\r\n                    return text.substring(0, index) + new_text + text.substring(index + old_text.length);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    exports.T = function(value) {\r\n        return (typeof value === \"string\") ? value : '';\r\n    };\r\n\r\n    exports.TEXT = null;\r\n\r\n    exports.TRIM = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.replace(/ +/g, ' ').trim();\r\n    };\r\n\r\n    exports.UNICHAR = exports.CHAR;\r\n\r\n    exports.UNICODE = exports.CODE;\r\n\r\n    exports.UPPER = function(text) {\r\n        if (typeof text !== 'string') {\r\n            return error.value;\r\n        }\r\n        return text.toUpperCase();\r\n    };\r\n\r\n    exports.VALUE = null;\r\n\r\n    return exports;\r\n})();\r\n\r\njexcel.methods.stats = (function() {\r\n    var exports = {};\r\n\r\n    var SQRT2PI = 2.5066282746310002;\r\n\r\n    exports.AVEDEV = null;\r\n\r\n    exports.AVERAGE = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            sum += range[i];\r\n            count += 1;\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sum = 0;\r\n        var count = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sum += el;\r\n            }\r\n            if (el === true) {\r\n                sum++;\r\n            }\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sum / count;\r\n    };\r\n\r\n    exports.AVERAGEIF = function(range, criteria, average_range) {\r\n        average_range = average_range || range;\r\n        range = utils.flatten(range);\r\n        average_range = utils.parseNumberArray(utils.flatten(average_range));\r\n        if (average_range instanceof Error) {\r\n            return average_range;\r\n        }\r\n        var average_count = 0;\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                result += average_range[i];\r\n                average_count++;\r\n            }\r\n        }\r\n        return result / average_count;\r\n    };\r\n\r\n    exports.AVERAGEIFS = null;\r\n\r\n    exports.COUNT = function() {\r\n        return utils.numbers(utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.COUNTA = function() {\r\n        var range = utils.flatten(arguments);\r\n        return range.length - exports.COUNTBLANK(range);\r\n    };\r\n\r\n    exports.COUNTIN = function (range, value) {\r\n        var result = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (range[i] === value) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTBLANK = function() {\r\n        var range = utils.flatten(arguments);\r\n        var blanks = 0;\r\n        var element;\r\n        for (var i = 0; i < range.length; i++) {\r\n            element = range[i];\r\n            if (element === null || element === '') {\r\n                blanks++;\r\n            }\r\n        }\r\n        return blanks;\r\n    };\r\n\r\n    exports.COUNTIF = function(range, criteria) {\r\n        range = utils.flatten(range);\r\n        if (!/[<>=!]/.test(criteria)) {\r\n            criteria = '==\"' + criteria + '\"';\r\n        }\r\n        var matches = 0;\r\n        for (var i = 0; i < range.length; i++) {\r\n            if (typeof range[i] !== 'string') {\r\n                if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            } else {\r\n                if (eval('\"' + range[i] + '\"' + criteria)) { // jshint ignore:line\r\n                    matches++;\r\n                }\r\n            }\r\n        }\r\n        return matches;\r\n    };\r\n\r\n    exports.COUNTIFS = function() {\r\n        var args = utils.argsToArray(arguments);\r\n        var results = new Array(utils.flatten(args[0]).length);\r\n        for (var i = 0; i < results.length; i++) {\r\n            results[i] = true;\r\n        }\r\n        for (i = 0; i < args.length; i += 2) {\r\n            var range = utils.flatten(args[i]);\r\n            var criteria = args[i + 1];\r\n            if (!/[<>=!]/.test(criteria)) {\r\n                criteria = '==\"' + criteria + '\"';\r\n            }\r\n            for (var j = 0; j < range.length; j++) {\r\n                if (typeof range[j] !== 'string') {\r\n                    results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\r\n                } else {\r\n                    results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\r\n                }\r\n            }\r\n        }\r\n        var result = 0;\r\n        for (i = 0; i < results.length; i++) {\r\n            if (results[i]) {\r\n                result++;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.COUNTUNIQUE = function () {\r\n        return UNIQUE.apply(null, utils.flatten(arguments)).length;\r\n    };\r\n\r\n    exports.FISHER = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return x;\r\n        }\r\n        return Math.log((1 + x) / (1 - x)) / 2;\r\n    };\r\n\r\n    exports.FISHERINV = function(y) {\r\n        y = utils.parseNumber(y);\r\n        if (y instanceof Error) {\r\n            return y;\r\n        }\r\n        var e2y = Math.exp(2 * y);\r\n        return (e2y - 1) / (e2y + 1);\r\n    };\r\n\r\n    exports.FREQUENCY = function(data, bins) {\r\n        data = utils.parseNumberArray(utils.flatten(data));\r\n        bins = utils.parseNumberArray(utils.flatten(bins));\r\n        if (utils.anyIsError(data, bins)) {\r\n            return error.value;\r\n        }\r\n        var n = data.length;\r\n        var b = bins.length;\r\n        var r = [];\r\n        for (var i = 0; i <= b; i++) {\r\n            r[i] = 0;\r\n            for (var j = 0; j < n; j++) {\r\n                if (i === 0) {\r\n                    if (data[j] <= bins[0]) {\r\n                        r[0] += 1;\r\n                    }\r\n                } else if (i < b) {\r\n                    if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\r\n                        r[i] += 1;\r\n                    }\r\n                } else if (i === b) {\r\n                    if (data[j] > bins[b - 1]) {\r\n                        r[b] += 1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n\r\n    exports.LARGE = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return b - a;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.MAX = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MAXA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n    };\r\n\r\n    exports.MIN = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MINA = function() {\r\n        var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n        return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n    };\r\n\r\n    exports.MODE = {};\r\n\r\n    exports.MODE.MULT = function() {\r\n        // Credits: Ronan\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        var n = range.length;\r\n        var count = {};\r\n        var maxItems = [];\r\n        var max = 0;\r\n        var currentItem;\r\n\r\n        for (var i = 0; i < n; i++) {\r\n            currentItem = range[i];\r\n            count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\r\n            if (count[currentItem] > max) {\r\n                max = count[currentItem];\r\n                maxItems = [];\r\n            }\r\n            if (count[currentItem] === max) {\r\n                maxItems[maxItems.length] = currentItem;\r\n            }\r\n        }\r\n        return maxItems;\r\n    };\r\n\r\n    exports.MODE.SNGL = function() {\r\n        var range = utils.parseNumberArray(utils.flatten(arguments));\r\n        if (range instanceof Error) {\r\n            return range;\r\n        }\r\n        return exports.MODE.MULT(range).sort(function(a, b) {\r\n            return a - b;\r\n        })[0];\r\n    };\r\n\r\n    exports.PERCENTILE = {};\r\n\r\n    exports.PERCENTILE.EXC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            {\r\n                return a - b;\r\n            }\r\n        });\r\n        var n = array.length;\r\n        if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\r\n            return error.num;\r\n        }\r\n        var l = k * (n + 1) - 1;\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTILE.INC = function(array, k) {\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(array, k)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = array.length;\r\n        var l = k * (n - 1);\r\n        var fl = Math.floor(l);\r\n        return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n    };\r\n\r\n    exports.PERCENTRANK = {};\r\n\r\n    exports.PERCENTRANK.EXC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = (array.indexOf(uniques[i]) + 1) / (n + 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERCENTRANK.INC = function(array, x, significance) {\r\n        significance = (significance === undefined) ? 3 : significance;\r\n        array = utils.parseNumberArray(utils.flatten(array));\r\n        x = utils.parseNumber(x);\r\n        significance = utils.parseNumber(significance);\r\n        if (utils.anyIsError(array, x, significance)) {\r\n            return error.value;\r\n        }\r\n        array = array.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var uniques = UNIQUE.apply(null, array);\r\n        var n = array.length;\r\n        var m = uniques.length;\r\n        var power = Math.pow(10, significance);\r\n        var result = 0;\r\n        var match = false;\r\n        var i = 0;\r\n        while (!match && i < m) {\r\n            if (x === uniques[i]) {\r\n                result = array.indexOf(uniques[i]) / (n - 1);\r\n                match = true;\r\n            } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\r\n                match = true;\r\n            }\r\n            i++;\r\n        }\r\n        return Math.floor(result * power) / power;\r\n    };\r\n\r\n    exports.PERMUT = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return FACT(number) / FACT(number - number_chosen);\r\n    };\r\n\r\n    exports.PERMUTATIONA = function(number, number_chosen) {\r\n        number = utils.parseNumber(number);\r\n        number_chosen = utils.parseNumber(number_chosen);\r\n        if (utils.anyIsError(number, number_chosen)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(number, number_chosen);\r\n    };\r\n\r\n    exports.PHI = function(x) {\r\n        x = utils.parseNumber(x);\r\n        if (x instanceof Error) {\r\n            return error.value;\r\n        }\r\n        return Math.exp(-0.5 * x * x) / SQRT2PI;\r\n    };\r\n\r\n    exports.PROB = function(range, probability, lower, upper) {\r\n        if (lower === undefined) {\r\n            return 0;\r\n        }\r\n        upper = (upper === undefined) ? lower : upper;\r\n\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        probability = utils.parseNumberArray(utils.flatten(probability));\r\n        lower = utils.parseNumber(lower);\r\n        upper = utils.parseNumber(upper);\r\n        if (utils.anyIsError(range, probability, lower, upper)) {\r\n            return error.value;\r\n        }\r\n\r\n        if (lower === upper) {\r\n            return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\r\n        }\r\n\r\n        var sorted = range.sort(function(a, b) {\r\n            return a - b;\r\n        });\r\n        var n = sorted.length;\r\n        var result = 0;\r\n        for (var i = 0; i < n; i++) {\r\n            if (sorted[i] >= lower && sorted[i] <= upper) {\r\n                result += probability[range.indexOf(sorted[i])];\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n\r\n    exports.QUARTILE = {};\r\n\r\n    exports.QUARTILE.EXC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.EXC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.EXC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.EXC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.QUARTILE.INC = function(range, quart) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        quart = utils.parseNumber(quart);\r\n        if (utils.anyIsError(range, quart)) {\r\n            return error.value;\r\n        }\r\n        switch (quart) {\r\n            case 1:\r\n                return exports.PERCENTILE.INC(range, 0.25);\r\n            case 2:\r\n                return exports.PERCENTILE.INC(range, 0.5);\r\n            case 3:\r\n                return exports.PERCENTILE.INC(range, 0.75);\r\n            default:\r\n                return error.num;\r\n        }\r\n    };\r\n\r\n    exports.RANK = {};\r\n\r\n    exports.RANK.AVG = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        range = utils.flatten(range);\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n\r\n        var length = range.length;\r\n        var count = 0;\r\n        for (var i = 0; i < length; i++) {\r\n            if (range[i] === number) {\r\n                count++;\r\n            }\r\n        }\r\n\r\n        return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RANK.EQ = function(number, range, order) {\r\n        number = utils.parseNumber(number);\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        if (utils.anyIsError(number, range)) {\r\n            return error.value;\r\n        }\r\n        order = order || false;\r\n        var sort = (order) ? function(a, b) {\r\n            return a - b;\r\n        } : function(a, b) {\r\n            return b - a;\r\n        };\r\n        range = range.sort(sort);\r\n        return range.indexOf(number) + 1;\r\n    };\r\n\r\n    exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\r\n        data_x = utils.parseNumberArray(utils.flatten(data_x));\r\n        data_y = utils.parseNumberArray(utils.flatten(data_y));\r\n        if (utils.anyIsError(data_x, data_y)) {\r\n            return error.value;\r\n        }\r\n        return Math.pow(exports.PEARSON(data_x, data_y), 2);\r\n    };\r\n\r\n    exports.SMALL = function(range, k) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        k = utils.parseNumber(k);\r\n        if (utils.anyIsError(range, k)) {\r\n            return range;\r\n        }\r\n        return range.sort(function(a, b) {\r\n            return a - b;\r\n        })[k - 1];\r\n    };\r\n\r\n    exports.STANDARDIZE = function(x, mean, sd) {\r\n        x = utils.parseNumber(x);\r\n        mean = utils.parseNumber(mean);\r\n        sd = utils.parseNumber(sd);\r\n        if (utils.anyIsError(x, mean, sd)) {\r\n            return error.value;\r\n        }\r\n        return (x - mean) / sd;\r\n    };\r\n\r\n    exports.STDEV = {};\r\n\r\n    exports.STDEV.P = function() {\r\n        var v = exports.VAR.P.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEV.S = function() {\r\n        var v = exports.VAR.S.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVA = function() {\r\n        var v = exports.VARA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.STDEVPA = function() {\r\n        var v = exports.VARPA.apply(this, arguments);\r\n        return Math.sqrt(v);\r\n    };\r\n\r\n    exports.VAR = {};\r\n\r\n    exports.VAR.P = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / n;\r\n    };\r\n\r\n    exports.VAR.S = function() {\r\n        var range = utils.numbers(utils.flatten(arguments));\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var mean = exports.AVERAGE(range);\r\n        for (var i = 0; i < n; i++) {\r\n            sigma += Math.pow(range[i] - mean, 2);\r\n        }\r\n        return sigma / (n - 1);\r\n    };\r\n\r\n    exports.VARA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / (count - 1);\r\n    };\r\n\r\n    exports.VARPA = function() {\r\n        var range = utils.flatten(arguments);\r\n        var n = range.length;\r\n        var sigma = 0;\r\n        var count = 0;\r\n        var mean = exports.AVERAGEA(range);\r\n        for (var i = 0; i < n; i++) {\r\n            var el = range[i];\r\n            if (typeof el === 'number') {\r\n                sigma += Math.pow(el - mean, 2);\r\n            } else if (el === true) {\r\n                sigma += Math.pow(1 - mean, 2);\r\n            } else {\r\n                sigma += Math.pow(0 - mean, 2);\r\n            }\r\n\r\n            if (el !== null) {\r\n                count++;\r\n            }\r\n        }\r\n        return sigma / count;\r\n    };\r\n\r\n    exports.WEIBULL = {};\r\n\r\n    exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\r\n        x = utils.parseNumber(x);\r\n        alpha = utils.parseNumber(alpha);\r\n        beta = utils.parseNumber(beta);\r\n        if (utils.anyIsError(x, alpha, beta)) {\r\n            return error.value;\r\n        }\r\n        return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\r\n    };\r\n\r\n    exports.Z = {};\r\n\r\n    exports.Z.TEST = function(range, x, sd) {\r\n        range = utils.parseNumberArray(utils.flatten(range));\r\n        x = utils.parseNumber(x);\r\n        if (utils.anyIsError(range, x)) {\r\n            return error.value;\r\n        }\r\n\r\n        sd = sd || exports.STDEV.S(range);\r\n        var n = range.length;\r\n        return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\r\n    };\r\n\r\n    return exports;\r\n})();\r\n\r\nfor (var i = 0; i < Object.keys(jexcel.methods).length; i++) {\r\n    var methods = jexcel.methods[Object.keys(jexcel.methods)[i]];\r\n    for (var j = 0; j < Object.keys(methods).length; j++) {\r\n        if (typeof(methods[Object.keys(methods)[j]]) == 'function') {\r\n            window[Object.keys(methods)[j]] = methods[Object.keys(methods)[j]];\r\n        } else {\r\n            window[Object.keys(methods)[j]] = function() {\r\n                return Object.keys(methods)[j] + 'Not implemented';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n    return jexcel;\r\n\r\n})));"],"names":["factory","jSuites","options","obj","app","document","querySelector","el","body","modules","querySelectorAll","i","length","m","getAttribute","window","guid","Math","floor","random","toString","w","d","e","documentElement","g","getElementsByTagName","innerWidth","clientWidth","innerHeight","clientHeight","changedTouches","x","pageX","y","pageY","clientX","scrollLeft","clientY","scrollTop","click","evt","MouseEvent","bubbles","cancelable","view","dispatchEvent","element","className","foundElement","path","classList","contains","parentNode","targetElement","tagName","formObject","ret","elements","name","value","url","__callback","http","XMLHttpRequest","open","send","status","console","error","files","data","file","src","remove","substr","content","indexOf","extension","lastIndexOf","size","date","cover","type","method","keys","Object","o","j","push","encodeURIComponent","prop","z","join","httpRequest","setRequestHeader","dataType","cache","withCredentials","beforeSend","onload","result","JSON","parse","responseText","success","err","ajax","requests","index","splice","complete","slideLeft","direction","done","add","setTimeout","slideRight","slideTop","slideBottom","fadeIn","fadeOut","keyDownControls","which","nodes","slider","close","dialog","onconfirm","mask","apply","actionUpControl","getLinkElement","target","link","history","back","panel","pages","addEventListener","getElement","scrollTo","left","behavior","calendar","current","prev","get","style","display","next","tooltip","hide","init","onpopstate","state","route","ignoreHistory","defaults","validRange","startingDay","format","readonly","today","time","resetButton","placeholder","months","weekdays","weekdays_short","onclose","onchange","fullscreen","mode","position","opened","property","hasOwnProperty","toUpperCase","split","parseInt","h","Date","getFullYear","getMonth","getDate","getHours","getMinutes","two","calendarReset","createElement","innerHTML","calendarConfirm","calendarControls","appendChild","calendarContainer","calendarContent","calendarTableContainer","calendarHeaderPrev","setAttribute","calendarLabelYear","calendarLabelMonth","calendarHeaderTitle","calendarHeaderNext","calendarHeaderRow","calendarHeader","calendarBody","calendarFooter","calendarTable","calendarSelectHour","this","calendarSelectMin","calendarControlsFooter","calendarControlsTime","maxWidth","calendarControlsUpdateButton","calendarControlsUpdate","flexGrow","calendarBackdrop","updateActions","currentDay","removeAttribute","getDays","getWindowWidth","rect","getBoundingClientRect","rectContent","bottom","height","top","ignoreEvents","update","getValue","setValue","getYears","val","newValue","oldValue","setLabel","innerText","reset","year","month","day","getDay","hour","min","isCurrentMonthAndYear","numberOfDays","firstDay","row","cell","emptyRow","fontWeight","now","test1","test2","getMonths","html","getDateString","fromFormatted","extractDateFromString","mouseUpControls","action","stopPropagation","preventDefault","test","insertBefore","nextSibling","toLowerCase","prettify","texts","justNow","xMinutesAgo","xHoursAgo","xDaysAgo","xWeeksAgo","xMonthsAgo","xYearsAgo","d1","d2","total","String","prototype","replace","text","round","prettifyAll","dateOnly","s","getSeconds","v1","v2","search","weekday","Array","substring","isOpen","color","closeOnChange","palette","colors","col","shade","container","backdrop","closeButton","onclick","table","tr","td","backgroundColor","values","focus","selected","contextmenu","items","create","width","itemContainer","itemText","title","disabled","shortcut","itemShortCut","foundId","id","dialogHeader","dialogTitle","dialogMessage","dialogFooter","dialogContainer","dialogConfirm","dialogConfirmButton","confirmLabel","dialogCancel","dialogCancelButton","cancelLabel","oncancel","message","opacity","confirm","alert","dropdown","extractFromDom","multiple","autocomplete","onopen","onblur","groups","minWidth","containerHeader","header","keyTimer","clearTimeout","find","setData","getUrl","setUrl","createItem","item","textLowerCase","image","node","removeChild","group","groupNames","groupName","groupArrow","groupContent","getText","asArray","isArray","updateLabel","selectIndex","oldLabel","currentIndex","indexToRemove","resetSelected","newLabel","selectItem","str","cursor","updateCursor","rectContainer","resetCursor","blur","offsetTop","clientTop","firstVisible","newIndex","first","last","hasEvents","mouseup","onkeydown","children","shiftKey","select","undefined","offsetWidth","a","b","c","div","editor","snippet","toolbar","maxHeight","remoteParser","youtubeKey","userSearch","parseURL","dropZone","dropAsAttachment","acceptImages","acceptFiles","maxFileSize","border","padding","onfocus","onenter","onkeyup","editorTimer","editorAction","overflowY","extractImageFromHtml","img","addImage","insertNodeAtCaret","newNode","sel","range","getSelection","rangeCount","getRangeAt","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","appendElement","description","host","verifyEditor","thumbsContainer","detectUrl","getDomain","location","hostname","importImage","youtubeParser","getYoutube","getWebsite","parseContent","p","thumbnails","medium","encodeURI","trim","log","getData","json","tagged","users","userId","key","stringify","addPdf","canvas","Image","getContext","drawImage","toBlob","blob","newImage","URL","createObjectURL","toDataURL","addFile","reader","FileReader","lastModified","readAsDataURL","destroy","removeEventListener","editorMouseUp","editorMouseDown","editorMouseMove","editorKeyUp","editorKeyDown","editorDragStart","editorDragEnter","editorDragOver","editorDrop","editorPaste","editorBlur","editorFocus","removeRange","newHeight","clipboardData","originalEvent","nodeName","execCommand","caretRangeFromPoint","rangeParent","createRange","setStart","rangeOffset","anchorNode","dataTransfer","getDefaultToolbar","icon","userSelect","itemIcon","setCursor","startContainer","endContainer","setEnd","links","match","queryCommandState","singleFile","extensionNotAllowed","imageTooSmall","lastmodified","small","addImages","addFromFile","imageFile","v","srcElement","extentionNotAllowed","addFromUrl","attachmentInput","loading","show","login","href","prepareRequest","accessToken","deviceToken","facebookUrl","facebookAuthentication","onsuccess","onerror","logo","newProfile","newProfileUrl","newProfileLogin","newPasswordValidation","messageElement","divLogo","labelCode","inputCode","divCode","inputHash","divHash","inputRecovery","divRecovery","labelLogin","inputLogin","divLogin","labelName","inputName","divName","labelUsername","inputUsername","divUsername","labelPassword","inputPassword","divPassword","keyCode","execute","labelRepeatPassword","inputRepeatPassword","divRepeatPassword","labelRemember","inputRemember","divRememberButton","actionButton","divActionButton","cancelButton","requestAccess","divCancelButton","labelCaptcha","inputCaptcha","imageCaptcha","divCaptcha","facebookButton","divFacebookButton","requestLoginViaFacebook","inputRequest","divRequestButton","requestNewPassword","inputNewProfile","divNewProfileButton","showMessage","call","captcha","codeConfirmation","changeMyPassword","hash","localStorage","getItem","FB","getLoginStatus","response","f","authResponse","scope","jDestroy","fbLogin","jStart","jError","jExit","event","u","pattern","RegExp","setItem","getFormElements","password","sha512","token","queryString","int64","msint_32","lsint_32","highOrder","lowOrder","T1","T2","H","K","W","safe_add_2","lsw","msw","safe_add_4","safe_add_5","maj","ch","rotr","n","sigma0","rotr28","rotr34","rotr39","sigma1","rotr14","rotr18","rotr41","gamma0","rotr1","rotr8","shr7","shr","rotr19","rotr61","shr6","strlen","unescape","utf8_encode","bin","len","charCodeAt","str2binb","binarray","srcByte","hex_tab","charAt","binb2hex","pieces","run","decimal","Number","number","valueDecimal","currentValue","prepare","process","selectionStart","selectionEnd","fromKeyCode","input","separator","t","reverse","_to_ascii","shiftUps","fromCharCode","mobile","createPage","callback","page","refresh","onpush","script","eval","setTitle","closed","showPage","onleave","pushState","mixed","routePath","getContainer","toolbarContent","setBadge","firstChild","toolbarItem","toolbarIcon","toolbarBadge","toolbarBadgeContent","badge","toolbarTitle","actionsheet","actionContent","actionGroup","actionItem","actionInput","modal","temp","resetPosition","mouseDownControls","mouseMoveControls","selection","empty","notification","timeout","autoHide","closeable","notificationContainer","notificationHeader","notificationImage","notificationIcon","notificationName","notificationClose","notificationDate","notificationContent","notificationTitle","notificationMessage","rating","previousSibling","currentImage","addFiles","getFiles","allowAttachment","attachmentIcon","longTouchTimer","mouseDown","mouseUp","offsetX","sorting","offsetY","borderTop","borderBottom","tabs","allowCreate","oncreate","animation","autoName","prefixName","hideHeaders","setBorder","headers","prompt","lastChild","headersItem","contentItem","tags","limit","limitMessage","validation","onbeforechange","searchContainer","searchTerms","searchIndex","searchTimer","getSelectionStart","caret","filter","extractTags","isValid","terms","nodeValue","tagsMouseUp","tagsKeyDown","tagsKeyUp","tagsPaste","tagsFocus","tagsBlur","collapse","nodeType","word","anchorOffset","tracker","ignore","currentHash","submitButton","onbeforesave","onsave","load","save","validate","getElements","validateElement","emailChecker","addError","delError","getError","setHash","getHash","isChanged","resetTracker","setIgnore","ignoreFlag","confirmationMessage","returnValue","module","exports","jexcel","Element","HTMLDocument","copyCompatibility","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","selectionCopy","mergeCells","pagination","paginationOptions","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","meta","parseFormulas","autoIncrement","autoCasting","onundo","onredo","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","onpaste","onbeforepaste","onmerge","onchangeheader","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","updateTable","detachForUpdates","noRecordsFound","showingPage","entries","columnName","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","textKey","corner","contextMenu","textarea","ads","thead","tbody","results","searchInput","pageNumber","headerContainer","colgroupContainer","records","formula","colgroup","highlighted","selectedCell","selectedContainer","historyIndex","edition","hashString","resizing","dragging","activate","prepareTable","source","allowEmpty","align","createTable","searchText","createTextNode","resetSelection","tempCol","paginationUpdateContainer","paginationDropdown","createNestedHeader","createCellHeader","tabIndex","sessionStorage","span","paginationInfo","paginationPages","createToolbar","setStyle","size_i","size_j","min_i","min_j","max_i","max_j","startNumber","finalNumber","createRow","updatePagination","num","setMerge","dataOnly","dataset","px","py","getJson","getRowData","rowNumber","setRowData","getColumnNameFromId","getColumnData","columnNumber","setColumnData","colNumber","createCell","checked","readOnly","formatted","getDropDownValue","render","executeFormula","colAlign","textAlign","whiteSpace","overflow","colWidth","getColumnName","nestedInformation","headerIndex","colspan","numberOfColumns","column","k","toolbarDropdownOption","cellName","rowspan","ignoreHistoryAndEvents","x1","y1","x2","y2","getIdFromColumnName","updateCell","updateSelection","setHistory","getMerge","removeMerge","keepOptions","info","destroyMerged","isColMerged","cols","isRowMerged","openEditor","createEditor","minHeight","closeEditor","getCell","getCellFromCoords","getLabel","getLabelFromCoords","processedValue","getValueFromCoords","force","columnId","updateFormulaChain","setValueFromCoords","setCheckRadioValue","record","copyData","breakControl","posx","posy","tokens","affectedTokens","updateFormula","setDate","doubleDigitFormat","refreshSelection","updateSelectionFromCoords","conditionalSelectionUpdate","previousStatus","ux","uy","el1","el2","origin","previousState","borderLeft","borderRight","updateCornerPosition","removeCopySelection","updateCopySelection","x3","y3","contentRect","lastRect","w2","h2","updateScroll","w1","h1","referenceRect","getWidth","$","setWidth","oldWidth","setHeight","oldHeight","getHeight","getHeader","setHeader","getHeaders","getMeta","setMeta","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","oneApplication","getComments","withAuthor","setComments","author","getConfig","orderBy","order","slice","sort","valueA","valueB","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","insertRow","numOfRows","lastRow","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowData","rowNode","deleteRow","getSelectedRows","mergeExists","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","letter","testLetter","testNumber","exec","expression","formulaResults","formulaLoopProtection","parentId","tokensUpdate","e1","e2","evalstring","parseNumber","res","up","ctrlKey","visible","loadValidation","loadUp","whichPage","down","loadDown","right","selectAll","quantityPerPage","ceil","startRow","finalRow","currentPage","selectedPage","totalPages","query","addToResult","oldPage","quantyOfPages","paginationItem","args","arguments","download","includeHeaders","Blob","navigator","msSaveOrOpenBlob","pom","changes","delimiter","returnData","colLabel","rowLabel","tmp","label","strLabel","parseCSV","newStyle","oldStyle","styleIndex","colIndex","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","arr","quote","cc","nc","build","newData","shift","comment","clipboard","readText","then","scrollControls","timeControlLoading","scrollHeight","timeControl","destroyEventHandlers","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","altKey","editorTextarea","editorValue","editorIndexOf","selectedRow","selectedHeader","metaKey","rowId","validLetter","cutControls","copyControls","isMouseAction","buttons","mouseButton","button","jexcelTable","selectedCorner","mousePosition","destination","c1","c2","getCellCoords","newWidth","tempWidth","tempHeight","enabled","tmpElement","createTabs","spreadsheet","sheetName","fromSpreadsheet","oReq","convert","workbook","spreadsheets","SheetNames","forEach","Sheets","wpx","hpx","r","max_x","max_y","fgColor","rgb","numColumns","Uint8Array","responseType","arraybuffer","wb","XLSX","read","cellFormula","cellStyles","onreadystatechange","readyState","ff","convertResponseBodyToText","responseBody","idx","concat","code","pow","jexcelSection","jexcelElement","fn","spreadsheetContainer","jQuery","nil","Error","div0","ref","na","utils","array","reduce","aIsArray","bIsArray","argsToArray","isFlat","flattenShallow","arrayEach","flatten","power","bool","isNaN","string","parseFloat","parsed","matrix","pnarr","parseNumberArray","d1900","UTC","parseDate","getTime","parseDateArray","anyIsError","arrayValuesToNumbers","rest","initial","iteratee","transpose","map","methods","datetime","WEEK_TYPES","serial","DATE","DATEVALUE","date_text","DAY","serial_number","DAYS","end_date","start_date","DAYS360","EDATE","setMonth","EOMONTH","HOUR","INTERVAL","second","sec","ISOWEEKNUM","setHours","yearStart","MINUTE","MONTH","NETWORKDAYS","holidays","INTL","weekend","NOW","SECOND","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","WORKDAY","days","YEAR","YEARFRAC","basis","database","compact","findResultIndex","criterias","matches","maxCriteriaLength","l","currentCriteriaResult","hasMatchingCriteria","criteria","criteriaField","FINDFIELD","DAVERAGE","field","resultIndexes","targetFields","sum","DCOUNT","DCOUNTA","DGET","DMAX","maxValue","DMIN","minValue","DPRODUCT","targetValues","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","MATCH","lookupValue","lookupArray","matchType","indexValue","engineering","isValidBinaryNumber","BESSELI","BESSELJ","BESSELK","BESSELY","BIN2DEC","stringified","BIN2HEX","places","REPT","BIN2OCT","BITAND","number1","number2","BITLSHIFT","abs","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki","unit_prefixes","Y","Z","E","P","T","G","M","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","PRECISE","ERFC","GESTEP","step","HEX2BIN","negative","HEX2DEC","HEX2OCT","IMABS","inumber","IMREAL","IMAGINARY","sqrt","plus","minus","unit","IMARGUMENT","PI","atan","IMCONJUGATE","IMCOS","cos","exp","sin","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","den","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","financial","validDate","ensureDate","ACCRINT","issue","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","AMORLINC","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","CUMIPMT","periods","start","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","cost","salvage","life","period","toFixed","ceiling","DDB","factor","DISC","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","IPMT","present","IRR","guess","irrResult","dates","irrResultDeriv","frac","positive","newRate","epsRate","resultValue","resultRate","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","PRICEDISC","PRICEMAT","PV","RATE","iter","t1","t2","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","maturity","discount","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","information","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISODD","ISREF","ISTEXT","N","NA","SHEET","SHEETS","logical","then_value","otherwise_value","valueIfError","value_if_na","targetValue","argc","switchCount","switchSatisfied","defaultClause","math","acos","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","asin","number_x","number_y","atan2","radix","min_length","max","significance","CEILING","MATH","COMBIN","number_chosen","FACT","COMBINA","COS","COSH","COT","tan","COTH","CSC","CSCH","DECIMAL","DEGREES","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","GCD","INT","LCM","pop","LN","LOG","base","LOG10","MDETERM","MINVERSE","MMULT","MOD","dividend","divisor","modulus","MROUND","MULTINOMIAL","MUNIT","ODD","POWER","PRODUCT","QUOTIENT","numerator","denominator","RADIANS","RAND","RANDBETWEEN","ROMAN","ROUND","digits","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","SUM","argsKeys","elt","SUMIF","SUMIFS","n_range_elements","n_criterias","condition","SUMPRODUCT","SUMSQ","numbers","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","misc","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","reference","opening","JOIN","NUMBERS","NUMERAL","trueFound","falseFound","text1","text2","find_text","within_text","line","begin","txt","regular_expression","full","replacement","new_text","foundAt","old_text","occurrence","UNICHAR","CHAR","UNICODE","CODE","UPPER","VALUE","stats","SQRT2PI","AVEDEV","AVERAGE","count","AVERAGEA","AVERAGEIF","average_range","average_count","AVERAGEIFS","COUNT","COUNTA","COUNTBLANK","COUNTIN","blanks","COUNTIF","COUNTIFS","COUNTUNIQUE","UNIQUE","FISHER","FISHERINV","e2y","FREQUENCY","bins","LARGE","MAX","MAXA","MIN","MINA","MODE","MULT","currentItem","maxItems","SNGL","PERCENTILE","EXC","fl","cleanFloat","INC","PERCENTRANK","uniques","PERMUT","PERMUTATIONA","PHI","PROB","probability","lower","upper","sorted","QUARTILE","quart","RANK","AVG","RSQ","data_x","data_y","PEARSON","SMALL","STANDARDIZE","mean","sd","STDEV","VAR","S","STDEVA","VARA","STDEVPA","VARPA","sigma","WEIBULL","DIST","alpha","beta","cumulative","TEST","NORM"],"sourceRoot":""}