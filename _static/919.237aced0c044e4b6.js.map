{"version":3,"file":"919.237aced0c044e4b6.js","mappings":"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","sources":["webpack://WebComponents/./runestone/mchoice/js/mchoice.js","webpack://WebComponents/./runestone/mchoice/js/timedmc.js"],"sourcesContent":["/*==========================================\n========      Master mchoice.js     =========\n============================================\n===  This file contains the JS for the   ===\n=== Runestone multiple choice component. ===\n============================================\n===              Created By              ===\n===           Isaiah Mayerchak           ===\n===                 and                  ===\n===             Kirby Olson              ===\n===                6/4/15                ===\n==========================================*/\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\n//import \"./../styles/runestone-custom-sphinx-bootstrap.css\";\nimport \"../css/mchoice.css\";\n\n// MC constructor\nexport default class MultipleChoice extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        opts = opts || {};\n        var orig = opts.orig; // entire <ul> element\n        this.origElem = orig;\n        this.useRunestoneServices = opts.useRunestoneServices;\n        this.multipleanswers = false;\n        this.divid = orig.id;\n        if (this.parseBooleanAttribute(this.origElem, \"data-multipleanswers\")) {\n            this.multipleanswers = true;\n        }\n        this.children = this.origElem.childNodes;\n        this.random = false;\n        if (this.parseBooleanAttribute(this.origElem, \"data-random\")) {\n            this.random = true;\n        }\n        this.correct = null;\n        this.didSubmit = false;\n        this.answerList = [];\n        this.correctList = [];\n        this.correctIndexList = [];\n        this.feedbackList = [];\n        this.question = null;\n        this.caption = \"Multiple Choice\";\n        this.findAnswers();\n        this.findQuestion();\n        this.findFeedbacks();\n        this.createCorrectList();\n        this.createMCForm();\n        this.addCaption(\"runestone\");\n        this.checkServer(\"mChoice\", true);\n        // https://docs.mathjax.org/en/latest/options/startup/startup.html\n        // https://docs.mathjax.org/en/latest/web/configuration.html#startup-action\n        // runestoneMathReady is defined in the preamble for all PTX authored books\n        this.queueMathJax(this.containerDiv);\n        if (typeof Prism !== \"undefined\") {\n            Prism.highlightAllUnder(this.containerDiv);\n        }\n    }\n\n    /*====================================\n    ==== Functions parsing variables  ====\n    ====  out of intermediate HTML    ====\n    ====================================*/\n    findQuestion() {\n        // Old HTML format had question inside ul\n        // Newer format has a div.exercise-statement that is a part of the ul's parent\n        // Check for newer format...\n        const exStatement = this.origElem.parentElement.querySelector('.exercise-statement');\n        if (exStatement) {\n            this.question = exStatement;\n        } else {\n            //Older format\n            var delimiter;\n            for (var i = 0; i < this.origElem.childNodes.length; i++) {\n                if (this.origElem.childNodes[i].nodeName === \"LI\") {\n                    delimiter = this.origElem.childNodes[i].outerHTML;\n                    break;\n                }\n            }\n            var fulltext = this.origElem.innerHTML;\n            var temp = fulltext.split(delimiter);\n            this.question = temp[0];\n        }\n    }\n\n    findAnswers() {\n        // Creates answer objects and pushes them to answerList\n        // format: ID, Correct bool, Content (text)\n        var ChildAnswerList = [];\n        for (var i = 0; i < this.children.length; i++) {\n            const child = this.children[i];\n            if (child.nodeType === Node.ELEMENT_NODE && child.matches(\"[data-component=answer]\")) {\n                ChildAnswerList.push(child);\n            }\n        }\n        for (var j = 0; j < ChildAnswerList.length; j++) {\n            var answer_id = ChildAnswerList[j].id;\n            var is_correct = false;\n            if (ChildAnswerList[j].hasAttribute(\"data-correct\")) {\n                // If data-correct attribute exists, answer is correct\n                is_correct = true;\n            }\n            var answer_text = ChildAnswerList[j].innerHTML;\n            var answer_object = {\n                id: answer_id,\n                correct: is_correct,\n                content: answer_text,\n            };\n            this.answerList.push(answer_object);\n        }\n    }\n\n    findFeedbacks() {\n        for (var i = 0; i < this.children.length; i++) {\n            const child = this.children[i];\n            if (child.nodeType === Node.ELEMENT_NODE && child.matches(\"[data-component=feedback]\")) {\n                this.feedbackList.push(child.innerHTML);\n            }\n        }\n    }\n\n    createCorrectList() {\n        // Creates array that holds the ID\"s of correct answers\n        // Also populates an array that holds the indeces of correct answers\n        for (var i = 0; i < this.answerList.length; i++) {\n            if (this.answerList[i].correct) {\n                this.correctList.push(this.answerList[i].id);\n                this.correctIndexList.push(i);\n            }\n        }\n    }\n\n    /*===========================================\n    ====   Functions generating final HTML   ====\n    ===========================================*/\n    createMCForm() {\n        this.renderMCContainer();\n        this.renderMCForm(); // renders the form with options and buttons\n        this.renderMCfeedbackDiv();\n        // replaces intermediate HTML with rendered HTML\n        this.origElem.replaceWith(this.containerDiv);\n    }\n\n    renderMCContainer() {\n        this.containerDiv = document.createElement(\"div\");\n        this.questionDiv = document.createElement(\"div\");\n        // this.question may be an element or text - need to handle both cases\n        if (typeof this.question === \"string\") {\n            this.questionDiv.innerHTML = this.question;\n        } else {\n            this.questionDiv.appendChild(this.question);\n        }\n        this.questionDiv.id = this.divid + \"_prompt\";\n        this.questionDiv.className = \"exercise-statement\";\n        this.containerDiv.appendChild(this.questionDiv);\n        const origClass = this.origElem.getAttribute(\"class\");\n        if (origClass) {\n            this.containerDiv.classList.add(...origClass.split(\" \").filter(Boolean));\n        }\n        this.containerDiv.classList.add(\"mchoice\");\n        this.containerDiv.id = this.divid;\n    }\n\n    renderMCForm() {\n        this.optsForm = document.createElement(\"form\");\n        this.optsForm.id = this.divid + \"_form\";\n        this.optsForm.method = \"get\";\n        this.optsForm.action = \"\";\n        this.optsForm.onsubmit = function () { return false; };\n        // Add fieldset and legend for accessibility\n        this.optsFieldSet = document.createElement(\"fieldset\");\n        this.optsFieldSet.setAttribute(\"role\", \"radiogroup\");\n        this.optsFieldSet.setAttribute(\"aria-labelledby\", this.divid + \"_prompt\");\n        this.optsForm.appendChild(this.optsFieldSet);\n        // generate form options\n        this.renderMCFormOpts();\n        this.renderMCFormButtons();\n        // Append the form to the container\n        let legend = document.createElement(\"legend\");\n        if (this.multipleanswers) {\n            legend.textContent = \"Choose all that apply\";\n        } else {\n            legend.textContent = \"Choose one\";\n        }\n        this.optsFieldSet.appendChild(legend);\n        this.containerDiv.appendChild(this.optsForm);\n    }\n\n    renderMCFormOpts() {\n        // creates input DOM elements\n        this.optionArray = []; // array with an object for each option containing the input and label for that option\n        var input_type = \"radio\";\n        if (this.multipleanswers) {\n            input_type = \"checkbox\";\n        }\n        // this.indexArray is used to index through the answers\n        // it is just 0-n normally, but the order is shuffled if the random option is present\n        this.indexArray = [];\n        for (var i = 0; i < this.answerList.length; i++) {\n            this.indexArray.push(i);\n        }\n        if (this.random) {\n            this.randomizeAnswers();\n        }\n        let self = this;\n        let answerFunc = function () {\n            self.isAnswered = true;\n        };\n        for (var j = 0; j < this.answerList.length; j++) {\n            var k = this.indexArray[j];\n            var optid = this.divid + \"_opt_\" + k;\n            // Create the label for the input\n            var label = document.createElement(\"label\");\n            label.className = \"mchoice-option\";\n            // If the content begins with a ``<p>``, put the label inside of it. (Sphinx 2.0 puts all content in a ``<p>``, while Sphinx 1.8 doesn't).\n            var content = this.answerList[k].content;\n            var prefix = \"\";\n            if (content.startsWith(\"<p>\")) {\n                prefix = \"<p>\";\n                content = content.slice(3);\n            }\n            label.innerHTML =\n                `${prefix}<input type=\"${input_type}\" name=\"group1\" value=\"${k}\" id=\"${optid}\" class=\"mchoice-input\">` +\n                `${String.fromCharCode(\"A\".charCodeAt(0) + j)}. ${content}`;\n            // create the object to store in optionArray\n            var inputEl = label.querySelector(\"input\");\n            var optObj = {\n                input: inputEl,\n                label: label,\n            };\n            optObj.input.onclick = answerFunc;\n\n            this.optionArray.push(optObj);\n            // add the option to the form\n            this.optsFieldSet.appendChild(label);\n        }\n    }\n\n    renderMCFormButtons() {\n        // submit and compare me buttons\n        // Create submit button\n        this.submitButton = document.createElement(\"button\");\n        this.submitButton.textContent = \"Check Me\";\n        this.submitButton.className = \"btn btn-success\";\n        this.submitButton.name = \"do answer\";\n        this.submitButton.type = \"button\";\n        if (this.multipleanswers) {\n            this.submitButton.addEventListener(\n                \"click\",\n                function () {\n                    this.processMCMASubmission(true);\n                }.bind(this),\n                false\n            );\n        } else {\n            this.submitButton.addEventListener(\n                \"click\",\n                function (ev) {\n                    ev.preventDefault();\n                    this.processMCMFSubmission(true);\n                }.bind(this),\n                false\n            );\n        } // end else\n        this.optsForm.appendChild(this.submitButton);\n        // Create compare button\n        if (this.useRunestoneServices && !eBookConfig.peer) {\n            this.compareButton = document.createElement(\"button\");\n            this.compareButton.className = \"btn btn-default\";\n            this.compareButton.id = this.divid + \"_bcomp\";\n            this.compareButton.disabled = true;\n            this.compareButton.name = \"compare\";\n            this.compareButton.textContent = \"Compare me\";\n            this.compareButton.addEventListener(\n                \"click\",\n                function () {\n                    this.compareAnswers(this.divid);\n                }.bind(this),\n                false\n            );\n            this.optsForm.appendChild(this.compareButton);\n        }\n    }\n\n    renderMCfeedbackDiv() {\n        this.feedBackDiv = document.createElement(\"div\");\n        this.feedBackDiv.id = this.divid + \"_feedback\";\n        this.feedBackDiv.setAttribute(\"aria-live\", \"polite\");\n        this.feedBackDiv.setAttribute(\"role\", \"status\");\n        this.containerDiv.appendChild(this.feedBackDiv);\n    }\n\n    randomizeAnswers() {\n        // Makes the ordering of the answer choices random\n        var currentIndex = this.indexArray.length,\n            temporaryValue,\n            randomIndex;\n        // While there remain elements to shuffle...\n        while (currentIndex !== 0) {\n            // Pick a remaining element...\n            randomIndex = Math.floor(Math.random() * currentIndex);\n            currentIndex -= 1;\n            // And swap it with the current element.\n            temporaryValue = this.indexArray[currentIndex];\n            this.indexArray[currentIndex] = this.indexArray[randomIndex];\n            this.indexArray[randomIndex] = temporaryValue;\n            var temporaryFeedback = this.feedbackList[currentIndex];\n            this.feedbackList[currentIndex] = this.feedbackList[randomIndex];\n            this.feedbackList[randomIndex] = temporaryFeedback;\n        }\n    }\n\n    /*===================================\n    === Checking/loading from storage ===\n    ===================================*/\n    restoreAnswers(data) {\n        // Restore answers from storage retrieval done in RunestoneBase\n        // sometimes data.answer can be null\n        if (!data.answer) {\n            data.answer = \"\";\n        }\n        var answers = data.answer.split(\",\");\n        for (var a = 0; a < answers.length; a++) {\n            var index = answers[a];\n            for (var b = 0; b < this.optionArray.length; b++) {\n                if (this.optionArray[b].input.value == index) {\n                    this.optionArray[b].input.checked = true;\n                }\n            }\n        }\n        if (this.multipleanswers) {\n            this.processMCMASubmission(false);\n        } else {\n            this.processMCMFSubmission(false);\n        }\n    }\n\n    checkLocalStorage() {\n        // Repopulates MCMA questions with a user's previous answers,\n        // which were stored into local storage.\n        var storedData;\n        var answers;\n        if (this.graderactive) {\n            return;\n        }\n        var len = localStorage.length;\n        if (len > 0) {\n            var ex = localStorage.getItem(this.localStorageKey());\n            if (ex !== null) {\n                try {\n                    storedData = JSON.parse(ex);\n                    answers = storedData.answer.split(\",\");\n                } catch (err) {\n                    // error while parsing; likely due to bad value stored in storage\n                    console.log(err.message);\n                    localStorage.removeItem(this.localStorageKey());\n                    return;\n                }\n                for (var a = 0; a < answers.length; a++) {\n                    var index = answers[a];\n                    for (var b = 0; b < this.optionArray.length; b++) {\n                        if (this.optionArray[b].input.value == index) {\n                            this.optionArray[b].input.checked = true;\n                        }\n                    }\n                }\n                if (this.useRunestoneServices) {\n                    this.enableMCComparison();\n                    this.getSubmittedOpts(); // to populate givenlog for logging\n                    if (this.multipleanswers) {\n                        this.logMCMAsubmission();\n                    } else {\n                        this.logMCMFsubmission();\n                    }\n                }\n            }\n        }\n    }\n\n    setLocalStorage(data) {\n        var timeStamp = new Date();\n        var storageObj = {\n            answer: data.answer,\n            timestamp: timeStamp,\n            correct: data.correct,\n        };\n        localStorage.setItem(\n            this.localStorageKey(),\n            JSON.stringify(storageObj)\n        );\n    }\n\n    /*===============================\n    === Processing MC Submissions ===\n    ===============================*/\n    processMCMASubmission(logFlag) {\n        // Called when the submit button is clicked\n        this.getSubmittedOpts(); // make sure this.givenArray is populated\n        this.scoreMCMASubmission();\n        this.setLocalStorage({\n            correct: this.correct ? \"T\" : \"F\",\n            answer: this.givenArray.join(\",\"),\n        });\n        if (logFlag) {\n            this.logMCMAsubmission();\n        }\n        if (!eBookConfig.peer || eBookConfig.isInstructor) {\n            this.renderMCMAFeedBack();\n            if (this.useRunestoneServices) {\n                this.enableMCComparison();\n            }\n        } else {\n            // acknowledge submission\n            if (eBookConfig.peer &&\n                eBookConfig.peerMode === \"async\" &&\n                typeof studentVoteCount !== \"undefined\" &&\n                studentVoteCount > 1) {\n                this.renderMCMAFeedBack();\n            } else {\n                this.feedBackDiv.innerHTML = \"<p>Your answer has been recorded</p>\";\n                this.feedBackDiv.className = \"alert alert-info\";\n            }\n        }\n        this.didSubmit = true;\n    }\n\n    getSubmittedOpts() {\n        var given;\n        this.singlefeedback = \"\"; // Used for MCMF questions\n        this.feedbackString = \"\"; // Used for MCMA questions\n        this.givenArray = [];\n        this.givenlog = \"\";\n        var buttonObjs = this.optsForm.elements.group1;\n        for (var i = 0; i < buttonObjs.length; i++) {\n            if (buttonObjs[i].checked) {\n                given = buttonObjs[i].value;\n                this.givenArray.push(given);\n                this.feedbackString += `<li value=\"${i + 1}\">${this.feedbackList[i]\n                    }</li>`;\n                this.givenlog += given + \",\";\n                this.singlefeedback = this.feedbackList[i];\n            }\n        }\n        this.givenArray.sort();\n    }\n\n    checkCurrentAnswer() {\n        this.getSubmittedOpts();\n        if (this.givenArray.length === 0) {\n            return;\n        }\n        if (this.multipleanswers) {\n            this.scoreMCMASubmission();\n        } else {\n            this.scoreMCMFSubmission();\n        }\n    }\n\n    async logCurrentAnswer(sid) {\n        if (this.multipleanswers) {\n            await this.logMCMAsubmission(sid);\n        } else {\n            await this.logMCMFsubmission(sid);\n        }\n    }\n\n    renderFeedback() {\n        if (this.multipleanswers) {\n            this.renderMCMAFeedBack();\n        } else {\n            this.renderMCMFFeedback();\n        }\n        this.queueMathJax(this.feedBackDiv);\n    }\n    scoreMCMASubmission() {\n        this.correctCount = 0;\n        var correctIndex = 0;\n        var givenIndex = 0;\n        while (\n            correctIndex < this.correctIndexList.length &&\n            givenIndex < this.givenArray.length\n        ) {\n            if (\n                this.givenArray[givenIndex] <\n                this.correctIndexList[correctIndex]\n            ) {\n                givenIndex++;\n            } else if (\n                this.givenArray[givenIndex] ==\n                this.correctIndexList[correctIndex]\n            ) {\n                this.correctCount++;\n                givenIndex++;\n                correctIndex++;\n            } else {\n                correctIndex++;\n            }\n        }\n        var numGiven = this.givenArray.length;\n        var numCorrect = this.correctCount;\n        var numNeeded = this.correctList.length;\n        this.answer = this.givenArray.join(\",\");\n        this.correct = numCorrect === numNeeded && numNeeded === numGiven;\n        if (numGiven === numNeeded) {\n            this.percent = numCorrect / numNeeded;\n        } else {\n            this.percent = numCorrect / Math.max(numGiven, numNeeded);\n        }\n    }\n\n    async logMCMAsubmission(sid) {\n        var answer = this.answer || \"\";\n        var correct = this.correct || false;\n        var logAnswer =\n            \"answer:\" + answer + \":\" + (correct == true ? \"correct\" : \"no\");\n        let data = {\n            event: \"mChoice\",\n            act: logAnswer,\n            answer: answer,\n            correct: correct,\n            div_id: this.divid,\n        };\n        if (eBookConfig.peer && typeof studentVoteCount !== \"undefined\") {\n            data.act = data.act + `:vote${studentVoteCount}`;\n        }\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n        }\n        await this.logBookEvent(data);\n    }\n\n    renderMCMAFeedBack() {\n        var answerStr = \"answers\";\n        var numGiven = this.givenArray.length;\n        if (numGiven === 1) {\n            answerStr = \"answer\";\n        }\n        var numCorrect = this.correctCount;\n        var numNeeded = this.correctList.length;\n        var feedbackText = this.feedbackString;\n        if (this.correct) {\n            this.feedBackDiv.innerHTML = `✔️ <ol type=\"A\">${feedbackText}</ul>`;\n            this.feedBackDiv.className = \"alert alert-info\";\n        } else {\n            this.feedBackDiv.innerHTML =\n                `✖️ You gave ${numGiven} ${answerStr} and got ${numCorrect} correct of ${numNeeded} needed.<ol type=\"A\">${feedbackText}</ul>`;\n            this.feedBackDiv.className = \"alert alert-danger\";\n        }\n    }\n\n    processMCMFSubmission(logFlag) {\n        // Called when the submit button is clicked\n        this.getSubmittedOpts(); // make sure this.givenArray is populated\n        this.scoreMCMFSubmission();\n        this.setLocalStorage({\n            correct: this.correct ? \"T\" : \"F\",\n            answer: this.givenArray.join(\",\"),\n        });\n        if (logFlag) {\n            this.logMCMFsubmission();\n        }\n        if (!eBookConfig.peer || eBookConfig.isInstructor) {\n            this.renderMCMFFeedback();\n            if (this.useRunestoneServices) {\n                this.enableMCComparison();\n            }\n        } else {\n            if (eBookConfig.peer &&\n                eBookConfig.peerMode === \"async\" &&\n                typeof studentVoteCount !== \"undefined\" &&\n                studentVoteCount > 1) {\n                this.renderMCMAFeedBack();\n            } else {\n                this.feedBackDiv.innerHTML = \"<p>Your answer has been recorded</p>\";\n                this.feedBackDiv.className = \"alert alert-info\";\n            }\n        }\n        this.didSubmit = true;\n    }\n\n    scoreMCMFSubmission() {\n        this.answer = this.givenArray[0];\n        if (this.givenArray[0] == this.correctIndexList[0]) {\n            this.correct = true;\n            this.percent = 1.0;\n        } else if (this.givenArray[0] != null) {\n            // if given is null then the question wasn\"t answered and should be counted as skipped\n            this.correct = false;\n            this.percent = 0.0;\n        }\n    }\n\n    async logMCMFsubmission(sid) {\n        // If there's no answer provided (the array is empty), use a blank for the answer.\n        var answer = this.givenArray[0] || \"\";\n        var correct =\n            this.givenArray[0] == this.correctIndexList[0] ? \"T\" : \"F\";\n        var logAnswer =\n            \"answer:\" + answer + \":\" + (correct == \"T\" ? \"correct\" : \"no\"); // backward compatible\n        let data = {\n            event: \"mChoice\",\n            act: logAnswer,\n            answer: answer,\n            correct: correct,\n            div_id: this.divid,\n        };\n        if (eBookConfig.peer && typeof studentVoteCount !== \"undefined\") {\n            data.act = data.act + `:vote${studentVoteCount}`;\n        }\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n        }\n        await this.logBookEvent(data);\n    }\n\n    renderMCMFFeedback() {\n        let correct = this.givenArray[0] == this.correctIndexList[0];\n        let feedbackText = this.singlefeedback;\n\n        if (correct) {\n            this.feedBackDiv.innerHTML = \"✔️ \" + feedbackText;\n            this.feedBackDiv.className = \"alert alert-info\"; // use blue for better red/green blue color blindness\n        } else {\n            if (feedbackText == null) {\n                feedbackText = \"\";\n            }\n            this.feedBackDiv.innerHTML = \"✖️ \" + feedbackText;\n            this.feedBackDiv.className = \"alert alert-danger\";\n        }\n    }\n    enableMCComparison() {\n        if (eBookConfig.enableCompareMe) {\n            this.compareButton.disabled = false;\n        }\n    }\n    instructorMchoiceModal(data) {\n        // data.reslist -- student and their answers\n        // data.answerDict    -- answers and count\n        // data.correct - correct answer\n        var res = \"<table><tr><th>Student</th><th>Answer(s)</th></tr>\";\n        for (var i in data) {\n            res +=\n                \"<tr><td>\" +\n                data[i][0] +\n                \"</td><td>\" +\n                data[i][1] +\n                \"</td></tr>\";\n        }\n        res += \"</table>\";\n        return res;\n    }\n    compareModal(data, status, whatever) {\n        var datadict = data.detail;\n        var answers = datadict.answerDict;\n        var misc = datadict.misc;\n        var kl = Object.keys(answers).sort();\n        var body = \"<table>\";\n        body += \"<tr><th>Answer</th><th>Percent</th></tr>\";\n        var theClass = \"\";\n        for (var k in kl) {\n            if (kl[k] === misc.correct) {\n                theClass = \"success\";\n            } else {\n                theClass = \"info\";\n            }\n            body +=\n                \"<tr><td>\" + kl[k] + \"</td><td class='compare-me-progress'>\";\n            var pct = answers[kl[k]] + \"%\";\n            body += \"<div class='progress'>\";\n            body +=\n                \"    <div class='progress-bar progress-bar-\" +\n                theClass +\n                \"' style='width:\" +\n                pct +\n                \";'>\" +\n                pct;\n            body += \"    </div>\";\n            body += \"</div></td></tr>\";\n        }\n        body += \"</table>\";\n        if (misc.yourpct !== \"unavailable\") {\n            body +=\n                \"<br /><p>You have \" +\n                misc.yourpct +\n                \"% correct for all questions</p>\";\n        }\n        if (datadict.reslist !== undefined) {\n            body += this.instructorMchoiceModal(datadict.reslist);\n        }\n        // Create a simple modal without jQuery/Bootstrap\n        const overlay = document.createElement(\"div\");\n        overlay.style.position = \"fixed\";\n        overlay.style.inset = \"0\";\n        overlay.style.background = \"rgba(0,0,0,0.5)\";\n        overlay.style.zIndex = \"9999\";\n\n        const dialog = document.createElement(\"div\");\n        dialog.style.maxWidth = \"720px\";\n        dialog.style.margin = \"10vh auto\";\n        dialog.style.background = \"#fff\";\n        dialog.style.borderRadius = \"6px\";\n        dialog.style.boxShadow = \"0 2px 12px rgba(0,0,0,0.3)\";\n        dialog.style.padding = \"16px\";\n\n        const header = document.createElement(\"div\");\n        const closeBtn = document.createElement(\"button\");\n        closeBtn.type = \"button\";\n        closeBtn.textContent = \"×\";\n        closeBtn.setAttribute(\"aria-label\", \"Close\");\n        closeBtn.style.float = \"right\";\n        closeBtn.className = \"btn btn-light\";\n        closeBtn.onclick = function () {\n            document.body.removeChild(overlay);\n        };\n        const title = document.createElement(\"h4\");\n        title.className = \"modal-title\";\n        title.textContent = \"Distribution of Answers\";\n        header.appendChild(closeBtn);\n        header.appendChild(title);\n\n        const modalBody = document.createElement(\"div\");\n        modalBody.innerHTML = body;\n\n        dialog.appendChild(header);\n        dialog.appendChild(modalBody);\n        overlay.appendChild(dialog);\n        document.body.appendChild(overlay);\n    }\n    // _`compareAnswers`\n    async compareAnswers() {\n        var data = {};\n        data.div_id = this.divid;\n        data.course_name = eBookConfig.course;\n        try {\n            const params = new URLSearchParams(data);\n            const resp = await fetch(`${eBookConfig.new_server_prefix}/assessment/getaggregateresults?${params.toString()}`);\n            const json = await resp.json();\n            this.compareModal(json);\n        } catch (e) {\n            console.error(\"Error fetching aggregate results:\", e);\n        }\n    }\n\n    disableInteraction() {\n        for (var i = 0; i < this.optionArray.length; i++) {\n            this.optionArray[i].input.disabled = true;\n        }\n    }\n\n    enableInteraction() {\n        for (var i = 0; i < this.optionArray.length; i++) {\n            this.optionArray[i].input.disabled = false;\n        }\n    }\n}\n\n/*=================================\n== Find the custom HTML tags and ==\n==   execute our code on them    ==\n=================================*/\ndocument.addEventListener(\"runestone:login-complete\", function () {\n    document.querySelectorAll(\"[data-component=multiplechoice]\").forEach(function (el, index) {\n        // MC\n        var opts = {\n            orig: el,\n            useRunestoneServices: eBookConfig.useRunestoneServices,\n        };\n        if (!el.closest(\"[data-component=timedAssessment]\")) {\n            // If this element exists within a timed component, don't render it here\n            window.componentMap[el.id] = new MultipleChoice(opts);\n        }\n    });\n});\n","import MultipleChoice from \"./mchoice.js\";\n\nexport default class TimedMC extends MultipleChoice {\n    constructor(opts) {\n        super(opts);\n        this.containerDiv.classList.add(\"runestone\");\n        this.needsReinitialization = true;\n        this.renderTimedIcon(this.MCContainer);\n        this.hideButtons(); // Don't show per-question buttons in a timed assessment\n    }\n\n    renderTimedIcon(component) {\n        // renders the clock icon on timed components.    The component parameter\n        // is the element that the icon should be appended to.\n        var timeIconDiv = document.createElement(\"div\");\n        var timeIcon = document.createElement(\"img\");\n        timeIcon.src = \"../_static/clock.png\";\n        timeIcon.style.width = \"15px\";\n        timeIcon.style.height = \"15px\";\n        timeIconDiv.className = \"timeTip\";\n        timeIconDiv.title = \"\";\n        timeIconDiv.appendChild(timeIcon);\n        if (component) {\n            if (component.firstChild) {\n                component.insertBefore(timeIconDiv, component.firstChild);\n            } else {\n                component.appendChild(timeIconDiv);\n            }\n        }\n    }\n    hideButtons() {\n        //Just hiding the buttons doesn't prevent submitting the form when entering is clicked\n        //We need to completely disable the buttons\n        if (this.submitButton) {\n            this.submitButton.setAttribute(\"disabled\", \"true\");\n            this.submitButton.style.display = \"none\";\n        }\n        if (this.compareButton) {\n            this.compareButton.style.display = \"none\";\n        }\n    }\n\n    // These methods override the methods in the base class. Called from renderFeedback()\n    //\n    renderMCMAFeedBack() {\n        this.feedbackTimedMC();\n    }\n    renderMCMFFeedback(whatever, whateverr) {\n        this.feedbackTimedMC();\n    }\n    feedbackTimedMC() {\n        for (var i = 0; i < this.indexArray.length; i++) {\n            var tmpindex = this.indexArray[i];\n            this.feedBackEachArray[i].innerHTML =\n                String.fromCharCode(65 + i) + \". \" + this.feedbackList[i];\n            var tmpid = this.answerList[tmpindex].id;\n            if (this.correctList.indexOf(tmpid) >= 0) {\n                this.feedBackEachArray[i].classList.add(\n                    \"alert\",\n                    \"alert-success\"\n                );\n            } else {\n                this.feedBackEachArray[i].classList.add(\n                    \"alert\",\n                    \"alert-danger\"\n                );\n            }\n        }\n    }\n    renderMCFormOpts() {\n        super.renderMCFormOpts();\n        this.feedBackEachArray = [];\n        for (var j = 0; j < this.answerList.length; j++) {\n            var k = this.indexArray[j];\n            var feedBackEach = document.createElement(\"div\");\n            feedBackEach.id = this.divid + \"_eachFeedback_\" + k;\n            feedBackEach.classList.add(\"eachFeedback\");\n            this.feedBackEachArray.push(feedBackEach);\n            this.optsForm.appendChild(feedBackEach);\n        }\n    }\n    checkCorrectTimedMCMA() {\n        if (\n            this.correctCount === this.correctList.length &&\n            this.correctList.length === this.givenArray.length\n        ) {\n            this.correct = true;\n        } else if (this.givenArray.length !== 0) {\n            this.correct = false;\n        } else {\n            // question was skipped\n            this.correct = null;\n        }\n        switch (this.correct) {\n            case true:\n                return \"T\";\n            case false:\n                return \"F\";\n            default:\n                return null;\n        }\n    }\n    checkCorrectTimedMCMF() {\n        // Returns if the question was correct, incorrect, or skipped (return null in the last case)\n        switch (this.correct) {\n            case true:\n                return \"T\";\n            case false:\n                return \"F\";\n            default:\n                return null;\n        }\n    }\n    checkCorrectTimed() {\n        if (this.multipleanswers) {\n            return this.checkCorrectTimedMCMA();\n        } else {\n            return this.checkCorrectTimedMCMF();\n        }\n    }\n    hideFeedback() {\n        for (var i = 0; i < this.feedBackEachArray.length; i++) {\n            this.feedBackEachArray[i].style.display = \"none\";\n        }\n    }\n\n    reinitializeListeners() {\n        let self = this;\n        let answerFunc = function () {\n            self.isAnswered = true;\n        };\n        for (let opt of this.optionArray) {\n            opt.input.onclick = answerFunc;\n        }\n    }\n}\n\nif (typeof window.component_factory === \"undefined\") {\n    window.component_factory = {};\n}\n\nwindow.component_factory.multiplechoice = function (opts) {\n    if (opts.timed) {\n        return new TimedMC(opts);\n    } else {\n        return new MultipleChoice(opts);\n    }\n};\n"],"names":["MultipleChoice","constructor","opts","super","orig","this","origElem","useRunestoneServices","multipleanswers","divid","id","parseBooleanAttribute","children","childNodes","random","correct","didSubmit","answerList","correctList","correctIndexList","feedbackList","question","caption","findAnswers","findQuestion","findFeedbacks","createCorrectList","createMCForm","addCaption","checkServer","queueMathJax","containerDiv","Prism","highlightAllUnder","exStatement","parentElement","querySelector","delimiter","i","length","nodeName","outerHTML","temp","innerHTML","split","ChildAnswerList","child","nodeType","Node","ELEMENT_NODE","matches","push","j","answer_id","is_correct","hasAttribute","answer_object","content","renderMCContainer","renderMCForm","renderMCfeedbackDiv","replaceWith","document","createElement","questionDiv","appendChild","className","origClass","getAttribute","classList","add","filter","Boolean","optsForm","method","action","onsubmit","optsFieldSet","setAttribute","renderMCFormOpts","renderMCFormButtons","legend","textContent","optionArray","input_type","indexArray","randomizeAnswers","self","answerFunc","isAnswered","k","optid","label","prefix","startsWith","slice","String","fromCharCode","charCodeAt","optObj","input","onclick","submitButton","name","type","addEventListener","processMCMASubmission","bind","ev","preventDefault","processMCMFSubmission","eBookConfig","peer","compareButton","disabled","compareAnswers","feedBackDiv","temporaryValue","randomIndex","currentIndex","Math","floor","temporaryFeedback","restoreAnswers","data","answer","answers","a","index","b","value","checked","checkLocalStorage","graderactive","localStorage","ex","getItem","localStorageKey","JSON","parse","err","console","log","message","removeItem","enableMCComparison","getSubmittedOpts","logMCMAsubmission","logMCMFsubmission","setLocalStorage","timeStamp","Date","storageObj","timestamp","setItem","stringify","logFlag","scoreMCMASubmission","givenArray","join","isInstructor","renderMCMAFeedBack","peerMode","studentVoteCount","given","singlefeedback","feedbackString","givenlog","buttonObjs","elements","group1","sort","checkCurrentAnswer","scoreMCMFSubmission","logCurrentAnswer","sid","renderFeedback","renderMCMFFeedback","correctCount","correctIndex","givenIndex","numGiven","numCorrect","numNeeded","percent","max","event","act","div_id","logBookEvent","answerStr","feedbackText","enableCompareMe","instructorMchoiceModal","res","compareModal","status","whatever","datadict","detail","answerDict","misc","kl","Object","keys","body","theClass","pct","yourpct","undefined","reslist","overlay","style","position","inset","background","zIndex","dialog","maxWidth","margin","borderRadius","boxShadow","padding","header","closeBtn","float","removeChild","title","modalBody","course_name","course","params","URLSearchParams","resp","fetch","new_server_prefix","toString","json","e","error","disableInteraction","enableInteraction","querySelectorAll","forEach","el","closest","window","componentMap","TimedMC","needsReinitialization","renderTimedIcon","MCContainer","hideButtons","component","timeIconDiv","timeIcon","src","width","height","firstChild","insertBefore","display","feedbackTimedMC","whateverr","tmpindex","feedBackEachArray","tmpid","indexOf","feedBackEach","checkCorrectTimedMCMA","checkCorrectTimedMCMF","checkCorrectTimed","hideFeedback","reinitializeListeners","opt","component_factory","multiplechoice","timed"],"sourceRoot":""}