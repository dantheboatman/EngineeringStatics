"use strict";(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[280],{45280:(e,t,o)=>{o.r(t);var s=o(2568);o(59298);class i extends s.Z{constructor(e){super(e);var t=e.orig;this.origElem=t,this.divid=t.id,self.group=[],this.limit=this.origElem.dataset.size_limit,this.isPretext=document.body.classList.contains("pretext");let o=document.createElement("button");o.type="button",o.classList.add("btn","btn-success"),o.innerHTML="Submit Group",o.onclick=this.submitAll.bind(this),(this.isPretext?e.orig.querySelector(".groupsub_button"):document.getElementById("groupsub_button")).appendChild(o)}async initialize(){if(eBookConfig.useRunestoneServices){let e=new Request("/runestone/admin/course_students",{method:"GET",headers:this.jsonHeaders});try{let t=await fetch(e);if(!t.ok)throw new Error("Failed to save the log entry");this.studentList=await t.json()}catch(e){this.isTimed&&alert(`Error: Your action was not saved! The error was ${e}`),console.log(`Error: ${e}`)}}else this.studentList={s1:"User 1",s2:"User 2",s3:"User 3",s4:"User 4",s5:"User 5"};var e;e=this.isPretext?this.origElem.querySelector(".assignment_partner_select"):document.getElementById("assignment_group"),this.picker=e;for(let[t,o]of Object.entries(this.studentList)){let o=document.createElement("option");o.value=t,o.innerHTML=this.studentList[t],e.appendChild(o)}$(".assignment_partner_select").select2({placeholder:"Select up to 4 team members",allowClear:!0,maximumSelectionLength:this.limit})}async submitAll(){let e=[];for(let t of this.picker.selectedOptions)e.push(t.value);let t=eBookConfig.username;if(t&&!e.includes(t)&&e.push(t),e.len>this.limit)alert(`You may not have more than ${this.limit} students in a group`);else{this.logBookEvent({event:"group_start",act:e.join(","),div_id:window.location.pathname});var o=[];if(this.isPretext){let e=this.origElem.closest("section.groupwork");for(let t of Object.keys(componentMap))e.querySelector(`#${t}`)&&o.push(componentMap[t])}else o=window.allComponents;for(let t of e)for(let e of o)try{console.log(`${t} ${e}`),await e.logCurrentAnswer(t)}catch(t){console.log(`failed to submit ${e} : ${t}`)}this.logBookEvent({event:"group_end",act:e.join(","),div_id:window.location.pathname})}}}$(document).on("runestone:login-complete",(async function(){let e=document.querySelectorAll("[data-component=groupsub]");if(e.length>1)return void alert("Only one Group Submit is allowed per page");let t=e[0];try{var o=new i({orig:t});await o.initialize()}catch(e){console.log(`Error rendering GroupSub ${t.id}`),console.log(`Details ${e}`)}}))}}]);
//# sourceMappingURL=280.js.map